!function(){function e(e){return function(){return this[e]}}function t(e){return function(){return e}}function n(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var n=Object.prototype.toString.call(e);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&"undefined"!=typeof e.splice&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof e.call&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&"undefined"==typeof e.call)return"object";return t}function r(e){return"string"==typeof e}function i(e,t,n){return e.call.apply(e.bind,arguments)}function o(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function s(e,t,n){return s=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?i:o,s.apply(null,arguments)}function a(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function u(e){function t(){}var n=ee;t.prototype=n.prototype,e.u=n.prototype,e.prototype=new t,e.t=function(e,t,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return n.prototype[t].apply(e,i)}}function h(e,t,n){this.a=e,this.b=t||1,this.d=n||1}function c(e,t){return-1!=e.indexOf(t)}function l(e,t){return t>e?-1:e>t?1:0}function d(e,t){var n;e:{n=e.length;for(var i=r(e)?e.split(""):e,o=0;n>o;o++)if(o in i&&t.call(void 0,i[o],o,e)){n=o;break e}n=-1}return 0>n?null:r(e)?e.charAt(n):e[n]}function f(e){return Ye.concat.apply(Ye,arguments)}function p(e,t,n){return 2>=arguments.length?Ye.slice.call(e,t):Ye.slice.call(e,t,n)}function g(e){var t=arguments.length;if(1==t&&"array"==n(arguments[0]))return g.apply(null,arguments[0]);for(var r={},i=0;t>i;i++)r[arguments[i]]=!0;return r}function m(){return c(Xe,"Edge")}function y(){var e=Xe;return ot?/rv\:([^\);]+)(\)|;)/.exec(e):it&&m()?/Edge\/([\d\.]+)/.exec(e):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):st?/WebKit\/(\S+)/.exec(e):void 0}function v(){var e=We.document;return e?e.documentMode:void 0}function E(e){if(!ut[e]){for(var t=0,n=Ze(String(at)).split("."),r=Ze(String(e)).split("."),i=Math.max(n.length,r.length),o=0;0==t&&i>o;o++){var s=n[o]||"",a=r[o]||"",u=RegExp("(\\d*)(\\D*)","g"),h=RegExp("(\\d*)(\\D*)","g");do{var c=u.exec(s)||["","",""],d=h.exec(a)||["","",""];if(0==c[0].length&&0==d[0].length)break;t=l(0==c[1].length?0:parseInt(c[1],10),0==d[1].length?0:parseInt(d[1],10))||l(0==c[2].length,0==d[2].length)||l(c[2],d[2])}while(0==t)}ut[e]=t>=0}}function b(e){return it&&(m()||lt>=e)}function w(e,t,n,r){this.a=e,this.nodeName=n,this.nodeValue=r,this.nodeType=2,this.parentNode=this.ownerElement=t}function _(e,t){var n=ft&&"href"==t.nodeName?e.getAttribute(t.nodeName,2):t.nodeValue;return new w(t,e,t.nodeName,n)}function S(e){this.b=e,this.a=0}function P(e){e=e.match(pt);for(var t=0;t<e.length;t++)gt.test(e[t])&&e.splice(t,1);return new S(e)}function x(e,t){return e.b[e.a+(t||0)]}function B(e){return e.b[e.a++]}function U(e){return e.b.length<=e.a}function k(e,t){if(e.contains&&1==t.nodeType)return e==t||e.contains(t);if("undefined"!=typeof e.compareDocumentPosition)return e==t||Boolean(16&e.compareDocumentPosition(t));for(;t&&e!=t;)t=t.parentNode;return t==e}function C(e,t){if(e==t)return 0;if(e.compareDocumentPosition)return 2&e.compareDocumentPosition(t)?1:-1;if(it&&!b(9)){if(9==e.nodeType)return-1;if(9==t.nodeType)return 1}if("sourceIndex"in e||e.parentNode&&"sourceIndex"in e.parentNode){var n=1==e.nodeType,r=1==t.nodeType;if(n&&r)return e.sourceIndex-t.sourceIndex;var i=e.parentNode,o=t.parentNode;return i==o?T(e,t):!n&&k(i,t)?-1*R(e,t):!r&&k(o,e)?R(t,e):(n?e.sourceIndex:i.sourceIndex)-(r?t.sourceIndex:o.sourceIndex)}return r=9==e.nodeType?e:e.ownerDocument||e.document,n=r.createRange(),n.selectNode(e),n.collapse(!0),r=r.createRange(),r.selectNode(t),r.collapse(!0),n.compareBoundaryPoints(We.Range.START_TO_END,r)}function R(e,t){var n=e.parentNode;if(n==t)return-1;for(var r=t;r.parentNode!=n;)r=r.parentNode;return T(r,e)}function T(e,t){for(var n=t;n=n.previousSibling;)if(n==e)return-1;return 1}function J(e){var t=null,n=e.nodeType;if(1==n&&(t=e.textContent,t=void 0==t||null==t?e.innerText:t,t=void 0==t||null==t?"":t),"string"!=typeof t)if(dt&&"title"==e.nodeName.toLowerCase()&&1==n)t=e.text;else if(9==n||1==n){e=9==n?e.documentElement:e.firstChild;for(var n=0,r=[],t="";e;){do 1!=e.nodeType&&(t+=e.nodeValue),dt&&"title"==e.nodeName.toLowerCase()&&(t+=e.text),r[n++]=e;while(e=e.firstChild);for(;n&&!(e=r[--n].nextSibling););}}else t=e.nodeValue;return""+t}function I(e,t,n){if(null===t)return!0;try{if(!e.getAttribute)return!1}catch(r){return!1}return ft&&"class"==t&&(t="className"),null==n?!!e.getAttribute(t):e.getAttribute(t,2)==n}function N(e,t,n,i,o){return(dt?A:L).call(null,e,t,r(n)?n:null,r(i)?i:null,o||new D)}function A(e,t,n,r,i){if(e instanceof ve||8==e.b||n&&null===e.b){var o=t.all;if(!o)return i;if(e=F(e),"*"!=e&&(o=t.getElementsByTagName(e),!o))return i;if(n){for(var s=[],a=0;t=o[a++];)I(t,n,r)&&s.push(t);o=s}for(a=0;t=o[a++];)"*"==e&&"!"==t.tagName||q(i,t);return i}return M(e,t,n,r,i),i}function L(e,t,n,r,i){return t.getElementsByName&&r&&"name"==n&&!it?(t=t.getElementsByName(r),Ke(t,function(t){e.a(t)&&q(i,t)})):t.getElementsByClassName&&r&&"class"==n?(t=t.getElementsByClassName(r),Ke(t,function(t){t.className==r&&e.a(t)&&q(i,t)})):e instanceof ge?M(e,t,n,r,i):t.getElementsByTagName&&(t=t.getElementsByTagName(e.d()),Ke(t,function(e){I(e,n,r)&&q(i,e)})),i}function O(e,t,n,r,i){var o;if((e instanceof ve||8==e.b||n&&null===e.b)&&(o=t.childNodes)){var s=F(e);return"*"==s||(o=Qe(o,function(e){return e.tagName&&e.tagName.toLowerCase()==s}))?(n&&(o=Qe(o,function(e){return I(e,n,r)})),Ke(o,function(e){"*"==s&&("!"==e.tagName||"*"==s&&1!=e.nodeType)||q(i,e)}),i):i}return z(e,t,n,r,i)}function z(e,t,n,r,i){for(t=t.firstChild;t;t=t.nextSibling)I(t,n,r)&&e.a(t)&&q(i,t);return i}function M(e,t,n,r,i){for(t=t.firstChild;t;t=t.nextSibling)I(t,n,r)&&e.a(t)&&q(i,t),M(e,t,n,r,i)}function F(e){if(e instanceof ge){if(8==e.b)return"!";if(null===e.b)return"*"}return e.d()}function D(){this.b=this.a=null,this.i=0}function j(e){this.d=e,this.a=this.b=null}function H(e,t){if(!e.a)return t;if(!t.a)return e;for(var n=e.a,r=t.a,i=null,o=null,s=0;n&&r;){var o=n.d,a=r.d;o==a||o instanceof w&&a instanceof w&&o.a==a.a?(o=n,n=n.a,r=r.a):0<C(n.d,r.d)?(o=r,r=r.a):(o=n,n=n.a),(o.b=i)?i.a=o:e.a=o,i=o,s++}for(o=n||r;o;)o.b=i,i=i.a=o,s++,o=o.a;return e.b=i,e.i=s,e}function V(e,t){var n=new j(t);n.a=e.a,e.b?e.a.b=n:e.a=e.b=n,e.a=n,e.i++}function q(e,t){var n=new j(t);n.b=e.b,e.a?e.b.a=n:e.a=e.b=n,e.b=n,e.i++}function W(e){return(e=e.a)?e.d:null}function X(e){return(e=W(e))?J(e):""}function Z(e,t){return new Y(e,!!t)}function Y(e,t){this.d=e,this.b=(this.c=t)?e.b:e.a,this.a=null}function G(e){var t=e.b;if(null==t)return null;var n=e.a=t;return e.b=e.c?t.b:t.a,n.d}function K(e){switch(e.nodeType){case 1:return a($,e);case 9:return K(e.documentElement);case 11:case 10:case 6:case 12:return Q;default:return e.parentNode?K(e.parentNode):Q}}function Q(){return null}function $(e,t){if(e.prefix==t)return e.namespaceURI||"http://www.w3.org/1999/xhtml";var n=e.getAttributeNode("xmlns:"+t);return n&&n.specified?n.value||null:e.parentNode&&9!=e.parentNode.nodeType?$(e.parentNode,t):null}function ee(e){this.g=e,this.b=this.e=!1,this.d=null}function te(e){return"\n  "+e.toString().split("\n").join("\n  ")}function ne(e,t){e.e=t}function re(e,t){e.b=t}function ie(e,t){var n=e.a(t);return n instanceof D?+X(n):+n}function oe(e,t){var n=e.a(t);return n instanceof D?X(n):""+n}function se(e,t){var n=e.a(t);return n instanceof D?!!n.i:!!n}function ae(e,t,n){ee.call(this,e.g),this.c=e,this.f=t,this.k=n,this.e=t.e||n.e,this.b=t.b||n.b,this.c==yt&&(n.b||n.e||4==n.g||0==n.g||!t.d?t.b||t.e||4==t.g||0==t.g||!n.d||(this.d={name:n.d.name,l:t}):this.d={name:t.d.name,l:n})}function ue(e,t,n,r,i){t=t.a(r),n=n.a(r);var o;if(t instanceof D&&n instanceof D){for(i=Z(t),r=G(i);r;r=G(i))for(t=Z(n),o=G(t);o;o=G(t))if(e(J(r),J(o)))return!0;return!1}if(t instanceof D||n instanceof D){for(t instanceof D?i=t:(i=n,n=t),i=Z(i),t=typeof n,r=G(i);r;r=G(i)){switch(t){case"number":r=+J(r);break;case"boolean":r=!!J(r);break;case"string":r=J(r);break;default:throw Error("Illegal primitive type for comparison.")}if(e(r,n))return!0}return!1}return i?"boolean"==typeof t||"boolean"==typeof n?e(!!t,!!n):"number"==typeof t||"number"==typeof n?e(+t,+n):e(t,n):e(+t,+n)}function he(e,t,n,r){this.a=e,this.p=t,this.g=n,this.j=r}function ce(e,t,n,r){if(mt.hasOwnProperty(e))throw Error("Binary operator already created: "+e);return e=new he(e,t,n,r),mt[e.toString()]=e}function le(e,t){if(t.a.length&&4!=e.g)throw Error("Primary expression must evaluate to nodeset if filter has predicate(s).");ee.call(this,e.g),this.c=e,this.f=t,this.e=e.e,this.b=e.b}function de(e,t){if(t.length<e.o)throw Error("Function "+e.h+" expects at least"+e.o+" arguments, "+t.length+" given");if(null!==e.n&&t.length>e.n)throw Error("Function "+e.h+" expects at most "+e.n+" arguments, "+t.length+" given");e.s&&Ke(t,function(t,n){if(4!=t.g)throw Error("Argument "+n+" to function "+e.h+" is not of type Nodeset: "+t)}),ee.call(this,e.g),this.f=e,this.c=t,ne(this,e.e||et(t,function(e){return e.e})),re(this,e.r&&!t.length||e.q&&!!t.length||et(t,function(e){return e.b}))}function fe(e,t,n,r,i,o,s,a,u){this.h=e,this.g=t,this.e=n,this.r=r,this.q=i,this.j=o,this.o=s,this.n=void 0!==a?a:s,this.s=!!u}function pe(e,t,n,r,i,o,s,a){if(vt.hasOwnProperty(e))throw Error("Function already created: "+e+".");vt[e]=new fe(e,t,n,r,!1,i,o,s,a)}function ge(e,t){switch(this.f=e,this.c=void 0!==t?t:null,this.b=null,e){case"comment":this.b=8;break;case"text":this.b=3;break;case"processing-instruction":this.b=7;break;case"node":break;default:throw Error("Unexpected argument")}}function me(e){return"comment"==e||"text"==e||"processing-instruction"==e||"node"==e}function ye(e){ee.call(this,3),this.c=e.substring(1,e.length-1)}function ve(e,t){this.h=e.toLowerCase(),this.c=t?t.toLowerCase():"http://www.w3.org/1999/xhtml"}function Ee(e){ee.call(this,1),this.c=e}function be(e,t){if(ee.call(this,e.g),this.f=e,this.c=t,this.e=e.e,this.b=e.b,1==this.c.length){var n=this.c[0];n.m||n.c!=bt||(n=n.k,"*"!=n.d()&&(this.d={name:n.d(),l:null}))}}function we(){ee.call(this,4)}function _e(){ee.call(this,4)}function Se(e){return"/"==e||"//"==e}function Pe(e,t){this.a=e,this.b=!!t}function xe(e,t,n){for(n=n||0;n<e.a.length;n++)for(var r,i=e.a[n],o=Z(t),s=t.i,a=0;r=G(o);a++){var u=e.b?s-a:a+1;if(r=i.a(new h(r,u,s)),"number"==typeof r)u=u==r;else if("string"==typeof r||"boolean"==typeof r)u=!!r;else{if(!(r instanceof D))throw Error("Predicate.evaluate returned an unexpected type.");u=0<r.i}if(!u){u=o,r=u.d;var c=u.a;if(!c)throw Error("Next must be called at least once before remove.");var l=c.b,c=c.a;l?l.a=c:r.a=c,c?c.b=l:r.b=l,r.i--,u.a=null}}return t}function Be(e,t,n,r){ee.call(this,4),this.c=e,this.k=t,this.f=n||new Pe([]),this.m=!!r,t=this.f,t=0<t.a.length?t.a[0].d:null,e.b&&t&&(e=t.name,e=dt?e.toLowerCase():e,this.d={name:e,l:t.l});e:{for(e=this.f,t=0;t<e.a.length;t++)if(n=e.a[t],n.e||1==n.g||0==n.g){e=!0;break e}e=!1}this.e=e}function Ue(e,t,n,r){this.h=e,this.d=t,this.a=n,this.b=r}function ke(e,t,n,r){if(Et.hasOwnProperty(e))throw Error("Axis already created: "+e);return t=new Ue(e,t,n,!!r),Et[e]=t}function Ce(e){ee.call(this,1),this.c=e,this.e=e.e,this.b=e.b}function Re(e){ee.call(this,4),this.c=e,ne(this,et(this.c,function(e){return e.e})),re(this,et(this.c,function(e){return e.b}))}function Te(e,t){this.a=e,this.b=t}function Je(e){for(var t,n=[];;){Ie(e,"Missing right hand side of binary expression."),t=De(e);var r=B(e.a);if(!r)break;var i=(r=mt[r]||null)&&r.p;if(!i){e.a.a--;break}for(;n.length&&i<=n[n.length-1].p;)t=new ae(n.pop(),n.pop(),t);n.push(t,r)}for(;n.length;)t=new ae(n.pop(),n.pop(),t);return t}function Ie(e,t){if(U(e.a))throw Error(t)}function Ne(e,t){var n=B(e.a);if(n!=t)throw Error("Bad token, expected: "+t+" got: "+n)}function Ae(e){if(e=B(e.a),")"!=e)throw Error("Bad token: "+e)}function Le(e){if(e=B(e.a),2>e.length)throw Error("Unclosed literal string");return new ye(e)}function Oe(e){var t=B(e.a),n=t.indexOf(":");if(-1==n)return new ve(t);var r=t.substring(0,n);if(e=e.b(r),!e)throw Error("Namespace prefix not declared: "+r);return t=t.substr(n+1),new ve(t,e)}function ze(e){var t,n,r=[];if(Se(x(e.a))){if(t=B(e.a),n=x(e.a),"/"==t&&(U(e.a)||"."!=n&&".."!=n&&"@"!=n&&"*"!=n&&!/(?![0-9])[\w]/.test(n)))return new we;n=new we,Ie(e,"Missing next location step."),t=Me(e,t),r.push(t)}else{e:{switch(t=x(e.a),n=t.charAt(0)){case"$":throw Error("Variable reference not allowed in HTML XPath");case"(":B(e.a),t=Je(e),Ie(e,'unclosed "("'),Ne(e,")");break;case'"':case"'":t=Le(e);break;default:if(isNaN(+t)){if(me(t)||!/(?![0-9])[\w]/.test(n)||"("!=x(e.a,1)){t=null;break e}for(t=B(e.a),t=vt[t]||null,B(e.a),n=[];")"!=x(e.a)&&(Ie(e,"Missing function argument list."),n.push(Je(e)),","==x(e.a));)B(e.a);Ie(e,"Unclosed function argument list."),Ae(e),t=new de(t,n)}else t=new Ee(+B(e.a))}"["==x(e.a)&&(n=new Pe(Fe(e)),t=new le(t,n))}if(t){if(!Se(x(e.a)))return t;n=t}else t=Me(e,"/"),n=new _e,r.push(t)}for(;Se(x(e.a));)t=B(e.a),Ie(e,"Missing next location step."),t=Me(e,t),r.push(t);return new be(n,r)}function Me(e,t){var n,r,i;if("/"!=t&&"//"!=t)throw Error('Step op should be "/" or "//"');if("."==x(e.a))return r=new Be(Bt,new ge("node")),B(e.a),r;if(".."==x(e.a))return r=new Be(Pt,new ge("node")),B(e.a),r;var o;if("@"==x(e.a))o=bt,B(e.a),Ie(e,"Missing attribute name");else if("::"==x(e.a,1)){if(!/(?![0-9])[\w]/.test(x(e.a).charAt(0)))throw Error("Bad token: "+B(e.a));if(n=B(e.a),o=Et[n]||null,!o)throw Error("No axis with name: "+n);B(e.a),Ie(e,"Missing node name")}else o=wt;if(n=x(e.a),/(?![0-9])[\w]/.test(n.charAt(0)))if("("==x(e.a,1)){if(!me(n))throw Error("Invalid node type: "+n);if(n=B(e.a),!me(n))throw Error("Invalid type name: "+n);Ne(e,"("),Ie(e,"Bad nodetype"),i=x(e.a).charAt(0);var s=null;('"'==i||"'"==i)&&(s=Le(e)),Ie(e,"Bad nodetype"),Ae(e),n=new ge(n,s)}else n=Oe(e);else{if("*"!=n)throw Error("Bad token: "+B(e.a));n=Oe(e)}return i=new Pe(Fe(e),o.a),r||new Be(o,n,i,"//"==t)}function Fe(e){for(var t=[];"["==x(e.a);){B(e.a),Ie(e,"Missing predicate expression.");var n=Je(e);t.push(n),Ie(e,"Unclosed predicate expression."),Ne(e,"]")}return t}function De(e){if("-"==x(e.a))return B(e.a),new Ce(De(e));var t=ze(e);if("|"!=x(e.a))e=t;else{for(t=[t];"|"==B(e.a);)Ie(e,"Missing next union location path."),t.push(ze(e));e.a.a--,e=new Re(t)}return e}function je(e,r){if(!e.length)throw Error("Empty XPath expression.");var i=P(e);if(U(i))throw Error("Invalid XPath expression.");r?"function"==n(r)||(r=s(r.lookupNamespaceURI,r)):r=t(null);var o=Je(new Te(i,r));if(!U(i))throw Error("Bad token: "+B(i));this.evaluate=function(e,t){var n=o.a(new h(e));return new He(n,t)}}function He(e,t){if(0==t)if(e instanceof D)t=4;else if("string"==typeof e)t=2;else if("number"==typeof e)t=1;else{if("boolean"!=typeof e)throw Error("Unexpected evaluation result.");t=3}if(2!=t&&1!=t&&3!=t&&!(e instanceof D))throw Error("value could not be converted to the specified type");this.resultType=t;var n;switch(t){case 2:this.stringValue=e instanceof D?X(e):""+e;break;case 1:this.numberValue=e instanceof D?+X(e):+e;break;case 3:this.booleanValue=e instanceof D?0<e.i:!!e;break;case 4:case 5:case 6:case 7:var r=Z(e);n=[];for(var i=G(r);i;i=G(r))n.push(i instanceof w?i.a:i);this.snapshotLength=e.i,this.invalidIteratorState=!1;break;case 8:case 9:r=W(e),this.singleNodeValue=r instanceof w?r.a:r;break;default:throw Error("Unknown XPathResult type.")}var o=0;this.iterateNext=function(){if(4!=t&&5!=t)throw Error("iterateNext called with wrong result type");return o>=n.length?null:n[o++]},this.snapshotItem=function(e){if(6!=t&&7!=t)throw Error("snapshotItem called with wrong result type");return e>=n.length||0>e?null:n[e]}}function Ve(e){this.lookupNamespaceURI=K(e)}function qe(e){e=e||We;var t=e.document;t.evaluate||(e.XPathResult=He,t.evaluate=function(e,t,n,r){return new je(e,n).evaluate(t,r)},t.createExpression=function(e,t){return new je(e,t)},t.createNSResolver=function(e){return new Ve(e)})}var We=this;Function.prototype.bind=Function.prototype.bind||function(e,t){if(1<arguments.length){var n=Array.prototype.slice.call(arguments,1);return n.unshift(this,e),s.apply(null,n)}return s(this,e)};var Xe,Ze=String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},Ye=Array.prototype,Ge=Ye.indexOf?function(e,t,n){return Ye.indexOf.call(e,t,n)}:function(e,t,n){if(n=null==n?0:0>n?Math.max(0,e.length+n):n,r(e))return r(t)&&1==t.length?e.indexOf(t,n):-1;for(;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},Ke=Ye.forEach?function(e,t,n){Ye.forEach.call(e,t,n)}:function(e,t,n){for(var i=e.length,o=r(e)?e.split(""):e,s=0;i>s;s++)s in o&&t.call(n,o[s],s,e)},Qe=Ye.filter?function(e,t,n){return Ye.filter.call(e,t,n)}:function(e,t,n){for(var i=e.length,o=[],s=0,a=r(e)?e.split(""):e,u=0;i>u;u++)if(u in a){var h=a[u];t.call(n,h,u,e)&&(o[s++]=h)}return o},$e=Ye.reduce?function(e,t,n,r){return r&&(t=s(t,r)),Ye.reduce.call(e,t,n)}:function(e,t,n,r){var i=n;return Ke(e,function(n,o){i=t.call(r,i,n,o,e)}),i},et=Ye.some?function(e,t,n){return Ye.some.call(e,t,n)}:function(e,t,n){for(var i=e.length,o=r(e)?e.split(""):e,s=0;i>s;s++)if(s in o&&t.call(n,o[s],s,e))return!0;return!1};e:{var tt=We.navigator;if(tt){var nt=tt.userAgent;if(nt){Xe=nt;break e}}Xe=""}var rt=c(Xe,"Opera")||c(Xe,"OPR"),it=c(Xe,"Edge")||c(Xe,"Trident")||c(Xe,"MSIE"),ot=c(Xe,"Gecko")&&!(c(Xe.toLowerCase(),"webkit")&&!m())&&!(c(Xe,"Trident")||c(Xe,"MSIE"))&&!m(),st=c(Xe.toLowerCase(),"webkit")&&!m(),at=function(){if(rt&&We.opera){var e=We.opera.version;return"function"==n(e)?e():e}var e="",t=y();return t&&(e=t?t[1]:""),it&&!m()&&(t=v(),t>parseFloat(e))?String(t):e}(),ut={},ht=We.document,ct=v(),lt=!ht||!it||!ct&&m()?void 0:ct||("CSS1Compat"==ht.compatMode?parseInt(at,10):5),dt=it&&!b(9),ft=it&&!b(8),pt=RegExp("\\$?(?:(?![0-9-])[\\w-]+:)?(?![0-9-])[\\w-]+|\\/\\/|\\.\\.|::|\\d+(?:\\.\\d*)?|\\.\\d+|\"[^\"]*\"|'[^']*'|[!<>]=|\\s+|.","g"),gt=/^\s/;g("area base br col command embed hr img input keygen link meta param source track wbr".split(" ")),!ot&&!it||it&&b(9)||ot&&E("1.9.1"),it&&E("9"),u(ae),ae.prototype.a=function(e){return this.c.j(this.f,this.k,e)},ae.prototype.toString=function(){var e="Binary Expression: "+this.c,e=e+te(this.f);return e+=te(this.k)},he.prototype.toString=e("a");var mt={};ce("div",6,1,function(e,t,n){return ie(e,n)/ie(t,n)}),ce("mod",6,1,function(e,t,n){return ie(e,n)%ie(t,n)}),ce("*",6,1,function(e,t,n){return ie(e,n)*ie(t,n)}),ce("+",5,1,function(e,t,n){return ie(e,n)+ie(t,n)}),ce("-",5,1,function(e,t,n){return ie(e,n)-ie(t,n)}),ce("<",4,2,function(e,t,n){return ue(function(e,t){return t>e},e,t,n)}),ce(">",4,2,function(e,t,n){return ue(function(e,t){return e>t},e,t,n)}),ce("<=",4,2,function(e,t,n){return ue(function(e,t){return t>=e},e,t,n)}),ce(">=",4,2,function(e,t,n){return ue(function(e,t){return e>=t},e,t,n)});var yt=ce("=",3,2,function(e,t,n){return ue(function(e,t){return e==t},e,t,n,!0)});ce("!=",3,2,function(e,t,n){return ue(function(e,t){return e!=t},e,t,n,!0)}),ce("and",2,2,function(e,t,n){return se(e,n)&&se(t,n)}),ce("or",1,2,function(e,t,n){return se(e,n)||se(t,n)}),u(le),le.prototype.a=function(e){return e=this.c.a(e),xe(this.f,e)},le.prototype.toString=function(){var e;return e="Filter:"+te(this.c),e+=te(this.f)},u(de),de.prototype.a=function(e){return this.f.j.apply(null,f(e,this.c))},de.prototype.toString=function(){var e="Function: "+this.f;if(this.c.length)var t=$e(this.c,function(e,t){return e+te(t)},"Arguments:"),e=e+te(t);return e},fe.prototype.toString=e("h");var vt={};pe("boolean",2,!1,!1,function(e,t){return se(t,e)},1),pe("ceiling",1,!1,!1,function(e,t){return Math.ceil(ie(t,e))},1),pe("concat",3,!1,!1,function(e,t){var n=p(arguments,1);return $e(n,function(t,n){return t+oe(n,e)},"")},2,null),pe("contains",2,!1,!1,function(e,t,n){return c(oe(t,e),oe(n,e))},2),pe("count",1,!1,!1,function(e,t){return t.a(e).i},1,1,!0),pe("false",2,!1,!1,t(!1),0),pe("floor",1,!1,!1,function(e,t){return Math.floor(ie(t,e))},1),pe("id",4,!1,!1,function(e,t){function n(e){if(dt){var t=i.all[e];if(t){if(t.nodeType&&e==t.id)return t;if(t.length)return d(t,function(t){return e==t.id})}return null}return i.getElementById(e)}var r=e.a,i=9==r.nodeType?r:r.ownerDocument,r=oe(t,e).split(/\s+/),o=[];Ke(r,function(e){e=n(e),!e||0<=Ge(o,e)||o.push(e)}),o.sort(C);var s=new D;return Ke(o,function(e){q(s,e)}),s},1),pe("lang",2,!1,!1,t(!1),1),pe("last",1,!0,!1,function(e){if(1!=arguments.length)throw Error("Function last expects ()");return e.d},0),pe("local-name",3,!1,!0,function(e,t){var n=t?W(t.a(e)):e.a;return n?n.localName||n.nodeName.toLowerCase():""},0,1,!0),pe("name",3,!1,!0,function(e,t){var n=t?W(t.a(e)):e.a;return n?n.nodeName.toLowerCase():""},0,1,!0),pe("namespace-uri",3,!0,!1,t(""),0,1,!0),pe("normalize-space",3,!1,!0,function(e,t){return(t?oe(t,e):J(e.a)).replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")},0,1),pe("not",2,!1,!1,function(e,t){return!se(t,e)},1),pe("number",1,!1,!0,function(e,t){return t?ie(t,e):+J(e.a)},0,1),pe("position",1,!0,!1,function(e){return e.b},0),pe("round",1,!1,!1,function(e,t){return Math.round(ie(t,e))},1),pe("starts-with",2,!1,!1,function(e,t,n){return t=oe(t,e),e=oe(n,e),0==t.lastIndexOf(e,0)},2),pe("string",3,!1,!0,function(e,t){return t?oe(t,e):J(e.a)},0,1),pe("string-length",1,!1,!0,function(e,t){return(t?oe(t,e):J(e.a)).length},0,1),pe("substring",3,!1,!1,function(e,t,n,r){if(n=ie(n,e),isNaN(n)||1/0==n||-(1/0)==n)return"";if(r=r?ie(r,e):1/0,isNaN(r)||-(1/0)===r)return"";n=Math.round(n)-1;var i=Math.max(n,0);return e=oe(t,e),1/0==r?e.substring(i):(t=Math.round(r),e.substring(i,n+t))},2,3),pe("substring-after",3,!1,!1,function(e,t,n){return t=oe(t,e),e=oe(n,e),n=t.indexOf(e),-1==n?"":t.substring(n+e.length)},2),pe("substring-before",3,!1,!1,function(e,t,n){return t=oe(t,e),e=oe(n,e),e=t.indexOf(e),-1==e?"":t.substring(0,e)},2),pe("sum",1,!1,!1,function(e,t){for(var n=Z(t.a(e)),r=0,i=G(n);i;i=G(n))r+=+J(i);return r},1,1,!0),pe("translate",3,!1,!1,function(e,t,n,r){t=oe(t,e),n=oe(n,e);var i=oe(r,e);for(e=[],r=0;r<n.length;r++){var o=n.charAt(r);o in e||(e[o]=i.charAt(r))}for(n="",r=0;r<t.length;r++)o=t.charAt(r),n+=o in e?e[o]:o;return n},3),pe("true",2,!1,!1,t(!0),0),ge.prototype.a=function(e){return null===this.b||this.b==e.nodeType},ge.prototype.d=e("f"),ge.prototype.toString=function(){var e="Kind Test: "+this.f;return null===this.c||(e+=te(this.c)),e},u(ye),ye.prototype.a=e("c"),ye.prototype.toString=function(){return"Literal: "+this.c},ve.prototype.a=function(e){var t=e.nodeType;return 1!=t&&2!=t?!1:"*"!=this.h&&this.h!=e.nodeName.toLowerCase()?!1:this.c==(e.namespaceURI?e.namespaceURI.toLowerCase():"http://www.w3.org/1999/xhtml")},ve.prototype.d=e("h"),ve.prototype.toString=function(){return"Name Test: "+("http://www.w3.org/1999/xhtml"==this.c?"":this.c+":")+this.h},u(Ee),Ee.prototype.a=e("c"),Ee.prototype.toString=function(){return"Number: "+this.c},u(be),u(we),we.prototype.a=function(e){var t=new D;return e=e.a,9==e.nodeType?q(t,e):q(t,e.ownerDocument),t},we.prototype.toString=t("Root Helper Expression"),u(_e),_e.prototype.a=function(e){var t=new D;return q(t,e.a),t},_e.prototype.toString=t("Context Helper Expression"),be.prototype.a=function(e){var t=this.f.a(e);if(!(t instanceof D))throw Error("Filter expression must evaluate to nodeset.");e=this.c;for(var n=0,r=e.length;r>n&&t.i;n++){var i,o=e[n],s=Z(t,o.c.a);if(o.e||o.c!=St)if(o.e||o.c!=xt)for(i=G(s),t=o.a(new h(i));null!=(i=G(s));)i=o.a(new h(i)),t=H(t,i);else i=G(s),t=o.a(new h(i));else{for(i=G(s);(t=G(s))&&(!i.contains||i.contains(t))&&8&t.compareDocumentPosition(i);i=t);t=o.a(new h(i))}}return t},be.prototype.toString=function(){var e;if(e="Path Expression:"+te(this.f),this.c.length){var t=$e(this.c,function(e,t){return e+te(t)},"Steps:");e+=te(t)}return e},Pe.prototype.toString=function(){return $e(this.a,function(e,t){return e+te(t)},"Predicates:")},u(Be),Be.prototype.a=function(e){var t=e.a,n=null,n=this.d,r=null,i=null,o=0;if(n&&(r=n.name,i=n.l?oe(n.l,e):null,o=1),this.m)if(this.e||this.c!=wt)if(e=Z(new Be(_t,new ge("node")).a(e)),t=G(e))for(n=this.j(t,r,i,o);null!=(t=G(e));)n=H(n,this.j(t,r,i,o));else n=new D;else n=N(this.k,t,r,i),n=xe(this.f,n,o);else n=this.j(e.a,r,i,o);return n},Be.prototype.j=function(e,t,n,r){return e=this.c.d(this.k,e,t,n),e=xe(this.f,e,r)},Be.prototype.toString=function(){var e;if(e="Step:"+te("Operator: "+(this.m?"//":"/")),this.c.h&&(e+=te("Axis: "+this.c)),e+=te(this.k),this.f.a.length){var t=$e(this.f.a,function(e,t){return e+te(t)},"Predicates:");e+=te(t)}return e},Ue.prototype.toString=e("h");var Et={};ke("ancestor",function(e,t){for(var n=new D,r=t;r=r.parentNode;)e.a(r)&&V(n,r);return n},!0),ke("ancestor-or-self",function(e,t){var n=new D,r=t;do e.a(r)&&V(n,r);while(r=r.parentNode);return n},!0);var bt=ke("attribute",function(e,t){var n=new D,r=e.d();if("style"==r&&t.style&&dt)return q(n,new w(t.style,t,"style",t.style.cssText)),n;var i=t.attributes;if(i)if(e instanceof ge&&null===e.b||"*"==r)for(var o,r=0;o=i[r];r++)dt?o.nodeValue&&q(n,_(t,o)):q(n,o);else(o=i.getNamedItem(r))&&(dt?o.nodeValue&&q(n,_(t,o)):q(n,o));return n},!1),wt=ke("child",function(e,t,n,i,o){return(dt?O:z).call(null,e,t,r(n)?n:null,r(i)?i:null,o||new D)},!1,!0);ke("descendant",N,!1,!0);var _t=ke("descendant-or-self",function(e,t,n,r){var i=new D;return I(t,n,r)&&e.a(t)&&q(i,t),N(e,t,n,r,i)},!1,!0),St=ke("following",function(e,t,n,r){var i=new D;do for(var o=t;o=o.nextSibling;)I(o,n,r)&&e.a(o)&&q(i,o),i=N(e,o,n,r,i);while(t=t.parentNode);return i},!1,!0);ke("following-sibling",function(e,t){for(var n=new D,r=t;r=r.nextSibling;)e.a(r)&&q(n,r);return n},!1),ke("namespace",function(){return new D},!1);var Pt=ke("parent",function(e,t){var n=new D;if(9==t.nodeType)return n;if(2==t.nodeType)return q(n,t.ownerElement),n;var r=t.parentNode;return e.a(r)&&q(n,r),n},!1),xt=ke("preceding",function(e,t,n,r){var i=new D,o=[];do o.unshift(t);while(t=t.parentNode);for(var s=1,a=o.length;a>s;s++){var u=[];for(t=o[s];t=t.previousSibling;)u.unshift(t);for(var h=0,c=u.length;c>h;h++)t=u[h],I(t,n,r)&&e.a(t)&&q(i,t),i=N(e,t,n,r,i)}return i},!0,!0);ke("preceding-sibling",function(e,t){for(var n=new D,r=t;r=r.previousSibling;)e.a(r)&&V(n,r);return n},!0);var Bt=ke("self",function(e,t){var n=new D;return e.a(t)&&q(n,t),n},!1);u(Ce),Ce.prototype.a=function(e){return-ie(this.c,e)},Ce.prototype.toString=function(){return"Unary Expression: -"+te(this.c)},u(Re),Re.prototype.a=function(e){var t=new D;return Ke(this.c,function(n){if(n=n.a(e),!(n instanceof D))throw Error("Path expression must evaluate to NodeSet.");t=H(t,n)}),t},Re.prototype.toString=function(){return $e(this.c,function(e,t){return e+te(t)},"Union Expression:")},He.ANY_TYPE=0,He.NUMBER_TYPE=1,He.STRING_TYPE=2,He.BOOLEAN_TYPE=3,He.UNORDERED_NODE_ITERATOR_TYPE=4,He.ORDERED_NODE_ITERATOR_TYPE=5,He.UNORDERED_NODE_SNAPSHOT_TYPE=6,He.ORDERED_NODE_SNAPSHOT_TYPE=7,He.ANY_UNORDERED_NODE_TYPE=8,He.FIRST_ORDERED_NODE_TYPE=9;var Ut=["wgxpath","install"],kt=We;Ut[0]in kt||!kt.execScript||kt.execScript("var "+Ut[0]);for(var Ct;Ut.length&&(Ct=Ut.shift());)Ut.length||void 0===qe?kt=kt[Ct]?kt[Ct]:kt[Ct]={}:kt[Ct]=qe}(),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.JSZip=e()}}(function(){return function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var h=n[s]={exports:{}};t[s][0].call(h.exports,function(e){var n=t[s][1][e];return i(n?n:e)},h,h.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){"use strict";var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e,t){for(var n,i,o,s,a,u,h,c="",l=0;l<e.length;)n=e.charCodeAt(l++),i=e.charCodeAt(l++),o=e.charCodeAt(l++),s=n>>2,a=(3&n)<<4|i>>4,u=(15&i)<<2|o>>6,h=63&o,isNaN(i)?u=h=64:isNaN(o)&&(h=64),c=c+r.charAt(s)+r.charAt(a)+r.charAt(u)+r.charAt(h);return c},n.decode=function(e,t){var n,i,o,s,a,u,h,c="",l=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<e.length;)s=r.indexOf(e.charAt(l++)),a=r.indexOf(e.charAt(l++)),u=r.indexOf(e.charAt(l++)),h=r.indexOf(e.charAt(l++)),n=s<<2|a>>4,i=(15&a)<<4|u>>2,o=(3&u)<<6|h,c+=String.fromCharCode(n),64!=u&&(c+=String.fromCharCode(i)),64!=h&&(c+=String.fromCharCode(o));return c}},{}],2:[function(e,t,n){"use strict";function r(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}r.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},t.exports=r},{}],3:[function(e,t,n){"use strict";n.STORE={magic:"\x00\x00",compress:function(e,t){return e},uncompress:function(e){return e},compressInputType:null,uncompressInputType:null},n.DEFLATE=e("./flate")},{"./flate":8}],4:[function(e,t,n){"use strict";var r=e("./utils"),i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];
t.exports=function(e,t){if("undefined"==typeof e||!e.length)return 0;var n="string"!==r.getTypeOf(e);"undefined"==typeof t&&(t=0);var o=0,s=0,a=0;t=-1^t;for(var u=0,h=e.length;h>u;u++)a=n?e[u]:e.charCodeAt(u),s=255&(t^a),o=i[s],t=t>>>8^o;return-1^t}},{"./utils":21}],5:[function(e,t,n){"use strict";function r(e){this.data=null,this.length=0,this.index=0}var i=e("./utils");r.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<e||0>e)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return i.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date((e>>25&127)+1980,(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1)}},t.exports=r},{"./utils":21}],6:[function(e,t,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!1,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],7:[function(e,t,n){"use strict";var r=e("./utils");n.string2binary=function(e){return r.string2binary(e)},n.string2Uint8Array=function(e){return r.transformTo("uint8array",e)},n.uint8Array2String=function(e){return r.transformTo("string",e)},n.string2Blob=function(e){var t=r.transformTo("arraybuffer",e);return r.arrayBuffer2Blob(t)},n.arrayBuffer2Blob=function(e){return r.arrayBuffer2Blob(e)},n.transformTo=function(e,t){return r.transformTo(e,t)},n.getTypeOf=function(e){return r.getTypeOf(e)},n.checkSupport=function(e){return r.checkSupport(e)},n.MAX_VALUE_16BITS=r.MAX_VALUE_16BITS,n.MAX_VALUE_32BITS=r.MAX_VALUE_32BITS,n.pretty=function(e){return r.pretty(e)},n.findCompression=function(e){return r.findCompression(e)},n.isRegExp=function(e){return r.isRegExp(e)}},{"./utils":21}],8:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("pako");n.uncompressInputType=r?"uint8array":"array",n.compressInputType=r?"uint8array":"array",n.magic="\b\x00",n.compress=function(e,t){return i.deflateRaw(e,{level:t.level||-1})},n.uncompress=function(e){return i.inflateRaw(e)}},{pako:24}],9:[function(e,t,n){"use strict";function r(e,t){return this instanceof r?(this.files={},this.comment=null,this.root="",e&&this.load(e,t),void(this.clone=function(){var e=new r;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e})):new r(e,t)}var i=e("./base64");r.prototype=e("./object"),r.prototype.load=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.utils=e("./deprecatedPublicUtils"),r.base64={encode:function(e){return i.encode(e)},decode:function(e){return i.decode(e)}},r.compressions=e("./compressions"),t.exports=r},{"./base64":1,"./compressions":3,"./defaults":6,"./deprecatedPublicUtils":7,"./load":10,"./object":13,"./support":17}],10:[function(e,t,n){"use strict";var r=e("./base64"),i=e("./zipEntries");t.exports=function(e,t){var n,o,s,a;for(t=t||{},t.base64&&(e=r.decode(e)),o=new i(e,t),n=o.files,s=0;s<n.length;s++)a=n[s],this.file(a.fileName,a.decompressed,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir,comment:a.fileComment.length?a.fileComment:null,unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions,createFolders:t.createFolders});return o.zipComment.length&&(this.comment=o.zipComment),this}},{"./base64":1,"./zipEntries":22}],11:[function(e,t,n){(function(e){"use strict";t.exports=function(t,n){return new e(t,n)},t.exports.test=function(t){return e.isBuffer(t)}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],12:[function(e,t,n){"use strict";function r(e){this.data=e,this.length=this.data.length,this.index=0}var i=e("./uint8ArrayReader");r.prototype=new i,r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.index,this.index+e);return this.index+=e,t},t.exports=r},{"./uint8ArrayReader":18}],13:[function(e,t,n){"use strict";var r=e("./support"),i=e("./utils"),o=e("./crc32"),s=e("./signature"),a=e("./defaults"),u=e("./base64"),h=e("./compressions"),c=e("./compressedObject"),l=e("./nodeBuffer"),d=e("./utf8"),f=e("./stringWriter"),p=e("./uint8ArrayWriter"),g=function(e){if(e._data instanceof c&&(e._data=e._data.getContent(),e.options.binary=!0,e.options.base64=!1,"uint8array"===i.getTypeOf(e._data))){var t=e._data;e._data=new Uint8Array(t.length),0!==t.length&&e._data.set(t,0)}return e._data},m=function(e){var t=g(e),n=i.getTypeOf(t);return"string"===n?!e.options.binary&&r.nodebuffer?l(t,"utf-8"):e.asBinary():t},y=function(e){var t=g(this);return null===t||"undefined"==typeof t?"":(this.options.base64&&(t=u.decode(t)),t=e&&this.options.binary?R.utf8decode(t):i.transformTo("string",t),e||this.options.binary||(t=i.transformTo("string",R.utf8encode(t))),t)},v=function(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this.options=n,this._initialMetadata={dir:n.dir,date:n.date}};v.prototype={asText:function(){return y.call(this,!0)},asBinary:function(){return y.call(this,!1)},asNodeBuffer:function(){var e=m(this);return i.transformTo("nodebuffer",e)},asUint8Array:function(){var e=m(this);return i.transformTo("uint8array",e)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var E=function(e,t){var n,r="";for(n=0;t>n;n++)r+=String.fromCharCode(255&e),e>>>=8;return r},b=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&"undefined"==typeof n[t]&&(n[t]=arguments[e][t]);return n},w=function(e){return e=e||{},e.base64!==!0||null!==e.binary&&void 0!==e.binary||(e.binary=!0),e=b(e,a),e.date=e.date||new Date,null!==e.compression&&(e.compression=e.compression.toUpperCase()),e},_=function(e,t,n){var r,o=i.getTypeOf(t);if(n=w(n),"string"==typeof n.unixPermissions&&(n.unixPermissions=parseInt(n.unixPermissions,8)),n.unixPermissions&&16384&n.unixPermissions&&(n.dir=!0),n.dosPermissions&&16&n.dosPermissions&&(n.dir=!0),n.dir&&(e=P(e)),n.createFolders&&(r=S(e))&&x.call(this,r,!0),n.dir||null===t||"undefined"==typeof t)n.base64=!1,n.binary=!1,t=null,o=null;else if("string"===o)n.binary&&!n.base64&&n.optimizedBinaryString!==!0&&(t=i.string2binary(t));else{if(n.base64=!1,n.binary=!0,!(o||t instanceof c))throw new Error("The data of '"+e+"' is in an unsupported format !");"arraybuffer"===o&&(t=i.transformTo("uint8array",t))}var s=new v(e,t,n);return this.files[e]=s,s},S=function(e){"/"==e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},P=function(e){return"/"!=e.slice(-1)&&(e+="/"),e},x=function(e,t){return t="undefined"!=typeof t?t:!1,e=P(e),this.files[e]||_.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]},B=function(e,t,n){var r,s=new c;return e._data instanceof c?(s.uncompressedSize=e._data.uncompressedSize,s.crc32=e._data.crc32,0===s.uncompressedSize||e.dir?(t=h.STORE,s.compressedContent="",s.crc32=0):e._data.compressionMethod===t.magic?s.compressedContent=e._data.getCompressedContent():(r=e._data.getContent(),s.compressedContent=t.compress(i.transformTo(t.compressInputType,r),n))):(r=m(e),(!r||0===r.length||e.dir)&&(t=h.STORE,r=""),s.uncompressedSize=r.length,s.crc32=o(r),s.compressedContent=t.compress(i.transformTo(t.compressInputType,r),n)),s.compressedSize=s.compressedContent.length,s.compressionMethod=t.magic,s},U=function(e,t){var n=e;return e||(n=t?16893:33204),(65535&n)<<16},k=function(e,t){return 63&(e||0)},C=function(e,t,n,r,a){var u,h,c,l,f=(n.compressedContent,i.transformTo("string",d.utf8encode(t.name))),p=t.comment||"",g=i.transformTo("string",d.utf8encode(p)),m=f.length!==t.name.length,y=g.length!==p.length,v=t.options,b="",w="",_="";c=t._initialMetadata.dir!==t.dir?t.dir:v.dir,l=t._initialMetadata.date!==t.date?t.date:v.date;var S=0,P=0;c&&(S|=16),"UNIX"===a?(P=798,S|=U(t.unixPermissions,c)):(P=20,S|=k(t.dosPermissions,c)),u=l.getHours(),u<<=6,u|=l.getMinutes(),u<<=5,u|=l.getSeconds()/2,h=l.getFullYear()-1980,h<<=4,h|=l.getMonth()+1,h<<=5,h|=l.getDate(),m&&(w=E(1,1)+E(o(f),4)+f,b+="up"+E(w.length,2)+w),y&&(_=E(1,1)+E(this.crc32(g),4)+g,b+="uc"+E(_.length,2)+_);var x="";x+="\n\x00",x+=m||y?"\x00\b":"\x00\x00",x+=n.compressionMethod,x+=E(u,2),x+=E(h,2),x+=E(n.crc32,4),x+=E(n.compressedSize,4),x+=E(n.uncompressedSize,4),x+=E(f.length,2),x+=E(b.length,2);var B=s.LOCAL_FILE_HEADER+x+f+b,C=s.CENTRAL_FILE_HEADER+E(P,2)+x+E(g.length,2)+"\x00\x00\x00\x00"+E(S,4)+E(r,4)+f+b+g;return{fileRecord:B,dirRecord:C,compressedObject:n}},R={load:function(e,t){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(e){var t,n,r,i,o=[];for(t in this.files)this.files.hasOwnProperty(t)&&(r=this.files[t],i=new v(r.name,r._data,b(r.options)),n=t.slice(this.root.length,t.length),t.slice(0,this.root.length)===this.root&&e(n,i)&&o.push(i));return o},file:function(e,t,n){if(1===arguments.length){if(i.isRegExp(e)){var r=e;return this.filter(function(e,t){return!t.dir&&r.test(e)})}return this.filter(function(t,n){return!n.dir&&t===e})[0]||null}return e=this.root+e,_.call(this,e,t,n),this},folder:function(e){if(!e)return this;if(i.isRegExp(e))return this.filter(function(t,n){return n.dir&&e.test(t)});var t=this.root+e,n=x.call(this,t),r=this.clone();return r.root=n.name,r},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!=e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter(function(t,n){return n.name.slice(0,e.length)===e}),r=0;r<n.length;r++)delete this.files[n[r].name];return this},generate:function(e){e=b(e||{},{base64:!0,compression:"STORE",compressionOptions:null,type:"base64",platform:"DOS",comment:null,mimeType:"application/zip"}),i.checkSupport(e.type),("darwin"===e.platform||"freebsd"===e.platform||"linux"===e.platform||"sunos"===e.platform)&&(e.platform="UNIX"),"win32"===e.platform&&(e.platform="DOS");var t,n,r=[],o=0,a=0,c=i.transformTo("string",this.utf8encode(e.comment||this.comment||""));for(var l in this.files)if(this.files.hasOwnProperty(l)){var d=this.files[l],g=d.options.compression||e.compression.toUpperCase(),m=h[g];if(!m)throw new Error(g+" is not a valid compression method !");var y=d.options.compressionOptions||e.compressionOptions||{},v=B.call(this,d,m,y),w=C.call(this,l,d,v,o,e.platform);o+=w.fileRecord.length+v.compressedSize,a+=w.dirRecord.length,r.push(w)}var _="";_=s.CENTRAL_DIRECTORY_END+"\x00\x00\x00\x00"+E(r.length,2)+E(r.length,2)+E(a,4)+E(o,4)+E(c.length,2)+c;var S=e.type.toLowerCase();for(t="uint8array"===S||"arraybuffer"===S||"blob"===S||"nodebuffer"===S?new p(o+a+_.length):new f(o+a+_.length),n=0;n<r.length;n++)t.append(r[n].fileRecord),t.append(r[n].compressedObject.compressedContent);for(n=0;n<r.length;n++)t.append(r[n].dirRecord);t.append(_);var P=t.finalize();switch(e.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return i.transformTo(e.type.toLowerCase(),P);case"blob":return i.arrayBuffer2Blob(i.transformTo("arraybuffer",P),e.mimeType);case"base64":return e.base64?u.encode(P):P;default:return P}},crc32:function(e,t){return o(e,t)},utf8encode:function(e){return i.transformTo("string",d.utf8encode(e))},utf8decode:function(e){return d.utf8decode(e)}};t.exports=R},{"./base64":1,"./compressedObject":2,"./compressions":3,"./crc32":4,"./defaults":6,"./nodeBuffer":11,"./signature":14,"./stringWriter":16,"./support":17,"./uint8ArrayWriter":19,"./utf8":20,"./utils":21}],14:[function(e,t,n){"use strict";n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],15:[function(e,t,n){"use strict";function r(e,t){this.data=e,t||(this.data=o.string2binary(this.data)),this.length=this.data.length,this.index=0}var i=e("./dataReader"),o=e("./utils");r.prototype=new i,r.prototype.byteAt=function(e){return this.data.charCodeAt(e)},r.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)},r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.index,this.index+e);return this.index+=e,t},t.exports=r},{"./dataReader":5,"./utils":21}],16:[function(e,t,n){"use strict";var r=e("./utils"),i=function(){this.data=[]};i.prototype={append:function(e){e=r.transformTo("string",e),this.data.push(e)},finalize:function(){return this.data.join("")}},t.exports=i},{"./utils":21}],17:[function(e,t,n){(function(e){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof e,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var t=new ArrayBuffer(0);try{n.blob=0===new Blob([t],{type:"application/zip"}).size}catch(r){try{var i=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,o=new i;o.append(t),n.blob=0===o.getBlob("application/zip").size}catch(r){n.blob=!1}}}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],18:[function(e,t,n){"use strict";function r(e){e&&(this.data=e,this.length=this.data.length,this.index=0)}var i=e("./dataReader");r.prototype=new i,r.prototype.byteAt=function(e){return this.data[e]},r.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),o=this.length-4;o>=0;--o)if(this.data[o]===t&&this.data[o+1]===n&&this.data[o+2]===r&&this.data[o+3]===i)return o;return-1},r.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.index,this.index+e);return this.index+=e,t},t.exports=r},{"./dataReader":5}],19:[function(e,t,n){"use strict";var r=e("./utils"),i=function(e){this.data=new Uint8Array(e),this.index=0};i.prototype={append:function(e){0!==e.length&&(e=r.transformTo("uint8array",e),this.data.set(e,this.index),this.index+=e.length)},finalize:function(){return this.data}},t.exports=i},{"./utils":21}],20:[function(e,t,n){"use strict";for(var r=e("./utils"),i=e("./support"),o=e("./nodeBuffer"),s=new Array(256),a=0;256>a;a++)s[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;s[254]=s[254]=1;var u=function(e){var t,n,r,o,s,a=e.length,u=0;for(o=0;a>o;o++)n=e.charCodeAt(o),55296===(64512&n)&&a>o+1&&(r=e.charCodeAt(o+1),56320===(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),o++)),u+=128>n?1:2048>n?2:65536>n?3:4;for(t=i.uint8array?new Uint8Array(u):new Array(u),s=0,o=0;u>s;o++)n=e.charCodeAt(o),55296===(64512&n)&&a>o+1&&(r=e.charCodeAt(o+1),56320===(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),o++)),128>n?t[s++]=n:2048>n?(t[s++]=192|n>>>6,t[s++]=128|63&n):65536>n?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|63&n):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|63&n);return t},h=function(e,t){var n;for(t=t||e.length,t>e.length&&(t=e.length),n=t-1;n>=0&&128===(192&e[n]);)n--;return 0>n?t:0===n?t:n+s[e[n]]>t?n:t},c=function(e){var t,n,i,o,a=e.length,u=new Array(2*a);for(n=0,t=0;a>t;)if(i=e[t++],128>i)u[n++]=i;else if(o=s[i],o>4)u[n++]=65533,t+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&a>t;)i=i<<6|63&e[t++],o--;o>1?u[n++]=65533:65536>i?u[n++]=i:(i-=65536,u[n++]=55296|i>>10&1023,u[n++]=56320|1023&i)}return u.length!==n&&(u.subarray?u=u.subarray(0,n):u.length=n),r.applyFromCharCode(u)};n.utf8encode=function(e){return i.nodebuffer?o(e,"utf-8"):u(e)},n.utf8decode=function(e){if(i.nodebuffer)return r.transformTo("nodebuffer",e).toString("utf-8");e=r.transformTo(i.uint8array?"uint8array":"array",e);for(var t=[],n=0,o=e.length,s=65536;o>n;){var a=h(e,Math.min(n+s,o));i.uint8array?t.push(c(e.subarray(n,a))):t.push(c(e.slice(n,a))),n=a}return t.join("")}},{"./nodeBuffer":11,"./support":17,"./utils":21}],21:[function(e,t,n){"use strict";function r(e){return e}function i(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}function o(e){var t=65536,r=[],i=e.length,o=n.getTypeOf(e),s=0,a=!0;try{switch(o){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,h(0))}}catch(u){a=!1}if(!a){for(var c="",l=0;l<e.length;l++)c+=String.fromCharCode(e[l]);return c}for(;i>s&&t>1;)try{"array"===o||"nodebuffer"===o?r.push(String.fromCharCode.apply(null,e.slice(s,Math.min(s+t,i)))):r.push(String.fromCharCode.apply(null,e.subarray(s,Math.min(s+t,i)))),s+=t}catch(u){t=Math.floor(t/2)}return r.join("")}function s(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}var a=e("./support"),u=e("./compressions"),h=e("./nodeBuffer");n.string2binary=function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(255&e.charCodeAt(n));return t},n.arrayBuffer2Blob=function(e,t){n.checkSupport("blob"),t=t||"application/zip";try{return new Blob([e],{type:t})}catch(r){try{var i=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,o=new i;return o.append(e),o.getBlob(t)}catch(r){throw new Error("Bug : can't construct the Blob.")}}},n.applyFromCharCode=o;var c={};c.string={string:r,array:function(e){return i(e,new Array(e.length))},arraybuffer:function(e){return c.string.uint8array(e).buffer},uint8array:function(e){return i(e,new Uint8Array(e.length))},nodebuffer:function(e){return i(e,h(e.length))}},c.array={string:o,array:r,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return h(e)}},c.arraybuffer={string:function(e){return o(new Uint8Array(e))},array:function(e){return s(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:r,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return h(new Uint8Array(e))}},c.uint8array={string:o,array:function(e){return s(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:r,nodebuffer:function(e){return h(e)}},c.nodebuffer={string:o,array:function(e){return s(e,new Array(e.length))},arraybuffer:function(e){return c.nodebuffer.uint8array(e).buffer},uint8array:function(e){return s(e,new Uint8Array(e.length))},nodebuffer:r},n.transformTo=function(e,t){if(t||(t=""),!e)return t;n.checkSupport(e);var r=n.getTypeOf(t),i=c[r][e](t);return i},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":a.nodebuffer&&h.test(e)?"nodebuffer":a.uint8array&&e instanceof Uint8Array?"uint8array":a.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){var t=a[e.toLowerCase()];if(!t)throw new Error(e+" is not supported by this browser")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,r="";for(n=0;n<(e||"").length;n++)t=e.charCodeAt(n),r+="\\x"+(16>t?"0":"")+t.toString(16).toUpperCase();return r},n.findCompression=function(e){for(var t in u)if(u.hasOwnProperty(t)&&u[t].magic===e)return u[t];return null},n.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)}},{"./compressions":3,"./nodeBuffer":11,"./support":17}],22:[function(e,t,n){"use strict";function r(e,t){this.files=[],this.loadOptions=t,e&&this.load(e)}var i=e("./stringReader"),o=e("./nodeBufferReader"),s=e("./uint8ArrayReader"),a=e("./utils"),u=e("./signature"),h=e("./zipEntry"),c=e("./support"),l=e("./object");r.prototype={checkSignature:function(e){var t=this.reader.readString(4);if(t!==e)throw new Error("Corrupted zip or bug : unexpected signature ("+a.pretty(t)+", expected "+a.pretty(e)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength),this.zipComment=l.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,r=this.zip64EndOfCentralSize-44,i=0;r>i;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readString(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(u.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===u.CENTRAL_FILE_HEADER;)e=new h({zip64:this.zip64},this.loadOptions),e.readCentralPart(this.reader),this.files.push(e)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(u.CENTRAL_DIRECTORY_END);if(-1===e){var t=!0;try{this.reader.setIndex(0),this.checkSignature(u.LOCAL_FILE_HEADER),t=!1}catch(n){}throw t?new Error("Can't find end of central directory : is this a zip file ? If it is, see http://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip : can't find end of central directory")}if(this.reader.setIndex(e),this.checkSignature(u.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,e=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR),-1===e)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(e),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(e){var t=a.getTypeOf(e);"string"!==t||c.uint8array?"nodebuffer"===t?this.reader=new o(e):this.reader=new s(a.transformTo("uint8array",e)):this.reader=new i(e,this.loadOptions.optimizedBinaryString)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=r},{"./nodeBufferReader":12,"./object":13,"./signature":14,"./stringReader":15,"./support":17,"./uint8ArrayReader":18,"./utils":21,"./zipEntry":23}],23:[function(e,t,n){"use strict";function r(e,t){this.options=e,this.loadOptions=t}var i=e("./stringReader"),o=e("./utils"),s=e("./compressedObject"),a=e("./object"),u=0,h=3;r.prototype={isEncrypted:function(){return 1===(1&this.bitFlag)},useUTF8:function(){return 2048===(2048&this.bitFlag)},prepareCompressedContent:function(e,t,n){return function(){var r=e.index;e.setIndex(t);var i=e.readData(n);return e.setIndex(r),i}},prepareContent:function(e,t,n,r,i){return function(){var e=o.transformTo(r.uncompressInputType,this.getCompressedContent()),t=r.uncompress(e);if(t.length!==i)throw new Error("Bug : uncompressed data size mismatch");return t}},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readString(this.fileNameLength),e.skip(n),-1==this.compressedSize||-1==this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(t=o.findCompression(this.compressionMethod),null===t)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");if(this.decompressed=new s,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(e,e.index,this.compressedSize,t),this.decompressed.getContent=this.prepareContent(e,e.index,this.compressedSize,t,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=o.transformTo("string",this.decompressed.getContent()),a.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(e){if(this.versionMadeBy=e.readInt(2),this.versionNeeded=e.readInt(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4),this.fileNameLength=e.readInt(2),this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=e.readString(this.fileNameLength),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readString(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=16&this.externalFileAttributes?!0:!1,e===u&&(this.dosPermissions=63&this.externalFileAttributes),e===h&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileName.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var t=new i(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(e){var t,n,r,i=e.index;for(this.extraFields=this.extraFields||{};e.index<i+this.extraFieldsLength;)t=e.readInt(2),n=e.readInt(2),r=e.readString(n),this.extraFields[t]={id:t,length:n,value:r}},handleUTF8:function(){if(this.useUTF8())this.fileName=a.utf8decode(this.fileName),this.fileComment=a.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();null!==e&&(this.fileName=e);var t=this.findExtraFieldUnicodeComment();null!==t&&(this.fileComment=t)}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=new i(e.value);return 1!==t.readInt(1)?null:a.crc32(this.fileName)!==t.readInt(4)?null:a.utf8decode(t.readString(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=new i(e.value);return 1!==t.readInt(1)?null:a.crc32(this.fileComment)!==t.readInt(4)?null:a.utf8decode(t.readString(e.length-5))}return null}},t.exports=r},{"./compressedObject":2,"./object":13,"./stringReader":15,"./utils":21}],24:[function(e,t,n){"use strict";var r=e("./lib/utils/common").assign,i=e("./lib/deflate"),o=e("./lib/inflate"),s=e("./lib/zlib/constants"),a={};r(a,i,o,s),t.exports=a},{"./lib/deflate":25,"./lib/inflate":26,"./lib/utils/common":27,"./lib/zlib/constants":30}],25:[function(e,t,n){"use strict";function r(e,t){var n=new v(t);if(n.push(e,!0),n.err)throw n.msg;return n.result}function i(e,t){return t=t||{},t.raw=!0,r(e,t)}function o(e,t){return t=t||{},t.gzip=!0,r(e,t)}var s=e("./zlib/deflate.js"),a=e("./utils/common"),u=e("./utils/strings"),h=e("./zlib/messages"),c=e("./zlib/zstream"),l=0,d=4,f=0,p=1,g=-1,m=0,y=8,v=function(e){this.options=a.assign({level:g,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var n=s.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==f)throw new Error(h[n]);t.header&&s.deflateSetHeader(this.strm,t.header)};v.prototype.push=function(e,t){var n,r,i=this.strm,o=this.options.chunkSize;if(this.ended)return!1;r=t===~~t?t:t===!0?d:l,"string"==typeof e?i.input=u.string2buf(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new a.Buf8(o),i.next_out=0,i.avail_out=o),n=s.deflate(i,r),n!==p&&n!==f)return this.onEnd(n),this.ended=!0,!1;(0===i.avail_out||0===i.avail_in&&r===d)&&("string"===this.options.to?this.onData(u.buf2binstring(a.shrinkBuf(i.output,i.next_out))):this.onData(a.shrinkBuf(i.output,i.next_out)))}while((i.avail_in>0||0===i.avail_out)&&n!==p);return r===d?(n=s.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===f):!0},v.prototype.onData=function(e){this.chunks.push(e)},v.prototype.onEnd=function(e){e===f&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=v,n.deflate=r,n.deflateRaw=i,n.gzip=o},{"./utils/common":27,"./utils/strings":28,"./zlib/deflate.js":32,"./zlib/messages":37,"./zlib/zstream":39}],26:[function(e,t,n){"use strict";function r(e,t){var n=new d(t);if(n.push(e,!0),n.err)throw n.msg;return n.result}function i(e,t){return t=t||{},t.raw=!0,r(e,t)}var o=e("./zlib/inflate.js"),s=e("./utils/common"),a=e("./utils/strings"),u=e("./zlib/constants"),h=e("./zlib/messages"),c=e("./zlib/zstream"),l=e("./zlib/gzheader"),d=function(e){this.options=s.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0===(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var n=o.inflateInit2(this.strm,t.windowBits);if(n!==u.Z_OK)throw new Error(h[n]);this.header=new l,o.inflateGetHeader(this.strm,this.header)};d.prototype.push=function(e,t){var n,r,i,h,c,l=this.strm,d=this.options.chunkSize;if(this.ended)return!1;r=t===~~t?t:t===!0?u.Z_FINISH:u.Z_NO_FLUSH,"string"==typeof e?l.input=a.binstring2buf(e):l.input=e,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new s.Buf8(d),l.next_out=0,l.avail_out=d),n=o.inflate(l,u.Z_NO_FLUSH),n!==u.Z_STREAM_END&&n!==u.Z_OK)return this.onEnd(n),this.ended=!0,!1;l.next_out&&(0===l.avail_out||n===u.Z_STREAM_END||0===l.avail_in&&r===u.Z_FINISH)&&("string"===this.options.to?(i=a.utf8border(l.output,l.next_out),h=l.next_out-i,c=a.buf2string(l.output,i),l.next_out=h,l.avail_out=d-h,h&&s.arraySet(l.output,l.output,i,h,0),this.onData(c)):this.onData(s.shrinkBuf(l.output,l.next_out)))}while(l.avail_in>0&&n!==u.Z_STREAM_END);return n===u.Z_STREAM_END&&(r=u.Z_FINISH),r===u.Z_FINISH?(n=o.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===u.Z_OK):!0},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===u.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg;
},n.Inflate=d,n.inflate=r,n.inflateRaw=i,n.ungzip=r},{"./utils/common":27,"./utils/strings":28,"./zlib/constants":30,"./zlib/gzheader":33,"./zlib/inflate.js":35,"./zlib/messages":37,"./zlib/zstream":39}],27:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)return void e.set(t.subarray(n,n+r),i);for(var o=0;r>o;o++)e[i+o]=t[n+o]},flattenChunks:function(e){var t,n,r,i,o,s;for(r=0,t=0,n=e.length;n>t;t++)r+=e[t].length;for(s=new Uint8Array(r),i=0,t=0,n=e.length;n>t;t++)o=e[t],s.set(o,i),i+=o.length;return s}},o={arraySet:function(e,t,n,r,i){for(var o=0;r>o;o++)e[i+o]=t[n+o]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(r)},{}],28:[function(e,t,n){"use strict";function r(e,t){if(65537>t&&(e.subarray&&s||!e.subarray&&o))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var n="",r=0;t>r;r++)n+=String.fromCharCode(e[r]);return n}var i=e("./common"),o=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(a){o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(a){s=!1}for(var u=new i.Buf8(256),h=0;256>h;h++)u[h]=h>=252?6:h>=248?5:h>=240?4:h>=224?3:h>=192?2:1;u[254]=u[254]=1,n.string2buf=function(e){var t,n,r,o,s,a=e.length,u=0;for(o=0;a>o;o++)n=e.charCodeAt(o),55296===(64512&n)&&a>o+1&&(r=e.charCodeAt(o+1),56320===(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),o++)),u+=128>n?1:2048>n?2:65536>n?3:4;for(t=new i.Buf8(u),s=0,o=0;u>s;o++)n=e.charCodeAt(o),55296===(64512&n)&&a>o+1&&(r=e.charCodeAt(o+1),56320===(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),o++)),128>n?t[s++]=n:2048>n?(t[s++]=192|n>>>6,t[s++]=128|63&n):65536>n?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|63&n):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|63&n);return t},n.buf2binstring=function(e){return r(e,e.length)},n.binstring2buf=function(e){for(var t=new i.Buf8(e.length),n=0,r=t.length;r>n;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,i,o,s,a=t||e.length,h=new Array(2*a);for(i=0,n=0;a>n;)if(o=e[n++],128>o)h[i++]=o;else if(s=u[o],s>4)h[i++]=65533,n+=s-1;else{for(o&=2===s?31:3===s?15:7;s>1&&a>n;)o=o<<6|63&e[n++],s--;s>1?h[i++]=65533:65536>o?h[i++]=o:(o-=65536,h[i++]=55296|o>>10&1023,h[i++]=56320|1023&o)}return r(h,i)},n.utf8border=function(e,t){var n;for(t=t||e.length,t>e.length&&(t=e.length),n=t-1;n>=0&&128===(192&e[n]);)n--;return 0>n?t:0===n?t:n+u[e[n]]>t?n:t}},{"./common":27}],29:[function(e,t,n){"use strict";function r(e,t,n,r){for(var i=65535&e|0,o=e>>>16&65535|0,s=0;0!==n;){s=n>2e3?2e3:n,n-=s;do i=i+t[r++]|0,o=o+i|0;while(--s);i%=65521,o%=65521}return i|o<<16|0}t.exports=r},{}],30:[function(e,t,n){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(e,t,n){"use strict";function r(){for(var e,t=[],n=0;256>n;n++){e=n;for(var r=0;8>r;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}function i(e,t,n,r){var i=o,s=r+n;e=-1^e;for(var a=r;s>a;a++)e=e>>>8^i[255&(e^t[a])];return-1^e}var o=r();t.exports=i},{}],32:[function(e,t,n){"use strict";function r(e,t){return e.msg=J[t],t}function i(e){return(e<<1)-(e>4?9:0)}function o(e){for(var t=e.length;--t>=0;)e[t]=0}function s(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(k.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function a(e,t){C._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,s(e.strm)}function u(e,t){e.pending_buf[e.pending++]=t}function h(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function c(e,t,n,r){var i=e.avail_in;return i>r&&(i=r),0===i?0:(e.avail_in-=i,k.arraySet(t,e.input,e.next_in,i,n),1===e.state.wrap?e.adler=R(e.adler,t,i,n):2===e.state.wrap&&(e.adler=T(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)}function l(e,t){var n,r,i=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match,u=e.strstart>e.w_size-he?e.strstart-(e.w_size-he):0,h=e.window,c=e.w_mask,l=e.prev,d=e.strstart+ue,f=h[o+s-1],p=h[o+s];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do if(n=t,h[n+s]===p&&h[n+s-1]===f&&h[n]===h[o]&&h[++n]===h[o+1]){o+=2,n++;do;while(h[++o]===h[++n]&&h[++o]===h[++n]&&h[++o]===h[++n]&&h[++o]===h[++n]&&h[++o]===h[++n]&&h[++o]===h[++n]&&h[++o]===h[++n]&&h[++o]===h[++n]&&d>o);if(r=ue-(d-o),o=d-ue,r>s){if(e.match_start=t,s=r,r>=a)break;f=h[o+s-1],p=h[o+s]}}while((t=l[t&c])>u&&0!==--i);return s<=e.lookahead?s:e.lookahead}function d(e){var t,n,r,i,o,s=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=s+(s-he)){k.arraySet(e.window,e.window,s,s,0),e.match_start-=s,e.strstart-=s,e.block_start-=s,n=e.hash_size,t=n;do r=e.head[--t],e.head[t]=r>=s?r-s:0;while(--n);n=s,t=n;do r=e.prev[--t],e.prev[t]=r>=s?r-s:0;while(--n);i+=s}if(0===e.strm.avail_in)break;if(n=c(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=n,e.lookahead+e.insert>=ae)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+ae-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<ae)););}while(e.lookahead<he&&0!==e.strm.avail_in)}function f(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(d(e),0===e.lookahead&&t===I)return ve;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,a(e,!1),0===e.strm.avail_out))return ve;if(e.strstart-e.block_start>=e.w_size-he&&(a(e,!1),0===e.strm.avail_out))return ve}return e.insert=0,t===L?(a(e,!0),0===e.strm.avail_out?be:we):e.strstart>e.block_start&&(a(e,!1),0===e.strm.avail_out)?ve:ve}function p(e,t){for(var n,r;;){if(e.lookahead<he){if(d(e),e.lookahead<he&&t===I)return ve;if(0===e.lookahead)break}if(n=0,e.lookahead>=ae&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+ae-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-he&&(e.match_length=l(e,n)),e.match_length>=ae)if(r=C._tr_tally(e,e.strstart-e.match_start,e.match_length-ae),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=ae){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+ae-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(0!==--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=C._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(a(e,!1),0===e.strm.avail_out))return ve}return e.insert=e.strstart<ae-1?e.strstart:ae-1,t===L?(a(e,!0),0===e.strm.avail_out?be:we):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?ve:Ee}function g(e,t){for(var n,r,i;;){if(e.lookahead<he){if(d(e),e.lookahead<he&&t===I)return ve;if(0===e.lookahead)break}if(n=0,e.lookahead>=ae&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+ae-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=ae-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-he&&(e.match_length=l(e,n),e.match_length<=5&&(e.strategy===V||e.match_length===ae&&e.strstart-e.match_start>4096)&&(e.match_length=ae-1)),e.prev_length>=ae&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-ae,r=C._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-ae),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+ae-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(0!==--e.prev_length);if(e.match_available=0,e.match_length=ae-1,e.strstart++,r&&(a(e,!1),0===e.strm.avail_out))return ve}else if(e.match_available){if(r=C._tr_tally(e,0,e.window[e.strstart-1]),r&&a(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return ve}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=C._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<ae-1?e.strstart:ae-1,t===L?(a(e,!0),0===e.strm.avail_out?be:we):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?ve:Ee}function m(e,t){for(var n,r,i,o,s=e.window;;){if(e.lookahead<=ue){if(d(e),e.lookahead<=ue&&t===I)return ve;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=ae&&e.strstart>0&&(i=e.strstart-1,r=s[i],r===s[++i]&&r===s[++i]&&r===s[++i])){o=e.strstart+ue;do;while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&o>i);e.match_length=ue-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=ae?(n=C._tr_tally(e,1,e.match_length-ae),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=C._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(a(e,!1),0===e.strm.avail_out))return ve}return e.insert=0,t===L?(a(e,!0),0===e.strm.avail_out?be:we):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?ve:Ee}function y(e,t){for(var n;;){if(0===e.lookahead&&(d(e),0===e.lookahead)){if(t===I)return ve;break}if(e.match_length=0,n=C._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(a(e,!1),0===e.strm.avail_out))return ve}return e.insert=0,t===L?(a(e,!0),0===e.strm.avail_out?be:we):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?ve:Ee}function v(e){e.window_size=2*e.w_size,o(e.head),e.max_lazy_match=U[e.level].max_lazy,e.good_match=U[e.level].good_length,e.nice_match=U[e.level].nice_length,e.max_chain_length=U[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=ae-1,e.match_available=0,e.ins_h=0}function E(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=G,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new k.Buf16(2*oe),this.dyn_dtree=new k.Buf16(2*(2*re+1)),this.bl_tree=new k.Buf16(2*(2*ie+1)),o(this.dyn_ltree),o(this.dyn_dtree),o(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new k.Buf16(se+1),this.heap=new k.Buf16(2*ne+1),o(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new k.Buf16(2*ne+1),o(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function b(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=Y,t=e.state,t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?le:me,e.adler=2===t.wrap?0:1,t.last_flush=I,C._tr_init(t),z):r(e,F)}function w(e){var t=b(e);return t===z&&v(e.state),t}function _(e,t){return e&&e.state?2!==e.state.wrap?F:(e.state.gzhead=t,z):F}function S(e,t,n,i,o,s){if(!e)return F;var a=1;if(t===H&&(t=6),0>i?(a=0,i=-i):i>15&&(a=2,i-=16),1>o||o>K||n!==G||8>i||i>15||0>t||t>9||0>s||s>X)return r(e,F);8===i&&(i=9);var u=new E;return e.state=u,u.strm=e,u.wrap=a,u.gzhead=null,u.w_bits=i,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=o+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+ae-1)/ae),u.window=new k.Buf8(2*u.w_size),u.head=new k.Buf16(u.hash_size),u.prev=new k.Buf16(u.w_size),u.lit_bufsize=1<<o+6,u.pending_buf_size=4*u.lit_bufsize,u.pending_buf=new k.Buf8(u.pending_buf_size),u.d_buf=u.lit_bufsize>>1,u.l_buf=3*u.lit_bufsize,u.level=t,u.strategy=s,u.method=n,w(e)}function P(e,t){return S(e,t,G,Q,$,Z)}function x(e,t){var n,a,c,l;if(!e||!e.state||t>O||0>t)return e?r(e,F):F;if(a=e.state,!e.output||!e.input&&0!==e.avail_in||a.status===ye&&t!==L)return r(e,0===e.avail_out?j:F);if(a.strm=e,n=a.last_flush,a.last_flush=t,a.status===le)if(2===a.wrap)e.adler=0,u(a,31),u(a,139),u(a,8),a.gzhead?(u(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),u(a,255&a.gzhead.time),u(a,a.gzhead.time>>8&255),u(a,a.gzhead.time>>16&255),u(a,a.gzhead.time>>24&255),u(a,9===a.level?2:a.strategy>=q||a.level<2?4:0),u(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(u(a,255&a.gzhead.extra.length),u(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=T(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=de):(u(a,0),u(a,0),u(a,0),u(a,0),u(a,0),u(a,9===a.level?2:a.strategy>=q||a.level<2?4:0),u(a,_e),a.status=me);else{var d=G+(a.w_bits-8<<4)<<8,f=-1;f=a.strategy>=q||a.level<2?0:a.level<6?1:6===a.level?2:3,d|=f<<6,0!==a.strstart&&(d|=ce),d+=31-d%31,a.status=me,h(a,d),0!==a.strstart&&(h(a,e.adler>>>16),h(a,65535&e.adler)),e.adler=1}if(a.status===de)if(a.gzhead.extra){for(c=a.pending;a.gzindex<(65535&a.gzhead.extra.length)&&(a.pending!==a.pending_buf_size||(a.gzhead.hcrc&&a.pending>c&&(e.adler=T(e.adler,a.pending_buf,a.pending-c,c)),s(e),c=a.pending,a.pending!==a.pending_buf_size));)u(a,255&a.gzhead.extra[a.gzindex]),a.gzindex++;a.gzhead.hcrc&&a.pending>c&&(e.adler=T(e.adler,a.pending_buf,a.pending-c,c)),a.gzindex===a.gzhead.extra.length&&(a.gzindex=0,a.status=fe)}else a.status=fe;if(a.status===fe)if(a.gzhead.name){c=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>c&&(e.adler=T(e.adler,a.pending_buf,a.pending-c,c)),s(e),c=a.pending,a.pending===a.pending_buf_size)){l=1;break}l=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,u(a,l)}while(0!==l);a.gzhead.hcrc&&a.pending>c&&(e.adler=T(e.adler,a.pending_buf,a.pending-c,c)),0===l&&(a.gzindex=0,a.status=pe)}else a.status=pe;if(a.status===pe)if(a.gzhead.comment){c=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>c&&(e.adler=T(e.adler,a.pending_buf,a.pending-c,c)),s(e),c=a.pending,a.pending===a.pending_buf_size)){l=1;break}l=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,u(a,l)}while(0!==l);a.gzhead.hcrc&&a.pending>c&&(e.adler=T(e.adler,a.pending_buf,a.pending-c,c)),0===l&&(a.status=ge)}else a.status=ge;if(a.status===ge&&(a.gzhead.hcrc?(a.pending+2>a.pending_buf_size&&s(e),a.pending+2<=a.pending_buf_size&&(u(a,255&e.adler),u(a,e.adler>>8&255),e.adler=0,a.status=me)):a.status=me),0!==a.pending){if(s(e),0===e.avail_out)return a.last_flush=-1,z}else if(0===e.avail_in&&i(t)<=i(n)&&t!==L)return r(e,j);if(a.status===ye&&0!==e.avail_in)return r(e,j);if(0!==e.avail_in||0!==a.lookahead||t!==I&&a.status!==ye){var p=a.strategy===q?y(a,t):a.strategy===W?m(a,t):U[a.level].func(a,t);if((p===be||p===we)&&(a.status=ye),p===ve||p===be)return 0===e.avail_out&&(a.last_flush=-1),z;if(p===Ee&&(t===N?C._tr_align(a):t!==O&&(C._tr_stored_block(a,0,0,!1),t===A&&(o(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),s(e),0===e.avail_out))return a.last_flush=-1,z}return t!==L?z:a.wrap<=0?M:(2===a.wrap?(u(a,255&e.adler),u(a,e.adler>>8&255),u(a,e.adler>>16&255),u(a,e.adler>>24&255),u(a,255&e.total_in),u(a,e.total_in>>8&255),u(a,e.total_in>>16&255),u(a,e.total_in>>24&255)):(h(a,e.adler>>>16),h(a,65535&e.adler)),s(e),a.wrap>0&&(a.wrap=-a.wrap),0!==a.pending?z:M)}function B(e){var t;return e&&e.state?(t=e.state.status,t!==le&&t!==de&&t!==fe&&t!==pe&&t!==ge&&t!==me&&t!==ye?r(e,F):(e.state=null,t===me?r(e,D):z)):F}var U,k=e("../utils/common"),C=e("./trees"),R=e("./adler32"),T=e("./crc32"),J=e("./messages"),I=0,N=1,A=3,L=4,O=5,z=0,M=1,F=-2,D=-3,j=-5,H=-1,V=1,q=2,W=3,X=4,Z=0,Y=2,G=8,K=9,Q=15,$=8,ee=29,te=256,ne=te+1+ee,re=30,ie=19,oe=2*ne+1,se=15,ae=3,ue=258,he=ue+ae+1,ce=32,le=42,de=69,fe=73,pe=91,ge=103,me=113,ye=666,ve=1,Ee=2,be=3,we=4,_e=3,Se=function(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i};U=[new Se(0,0,0,0,f),new Se(4,4,8,4,p),new Se(4,5,16,8,p),new Se(4,6,32,32,p),new Se(4,4,16,16,g),new Se(8,16,32,32,g),new Se(8,16,128,128,g),new Se(8,32,128,256,g),new Se(32,128,258,1024,g),new Se(32,258,258,4096,g)],n.deflateInit=P,n.deflateInit2=S,n.deflateReset=w,n.deflateResetKeep=b,n.deflateSetHeader=_,n.deflate=x,n.deflateEnd=B,n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./messages":37,"./trees":38}],33:[function(e,t,n){"use strict";function r(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}t.exports=r},{}],34:[function(e,t,n){"use strict";var r=30,i=12;t.exports=function(e,t){var n,o,s,a,u,h,c,l,d,f,p,g,m,y,v,E,b,w,_,S,P,x,B,U,k;n=e.state,o=e.next_in,U=e.input,s=o+(e.avail_in-5),a=e.next_out,k=e.output,u=a-(t-e.avail_out),h=a+(e.avail_out-257),c=n.dmax,l=n.wsize,d=n.whave,f=n.wnext,p=n.window,g=n.hold,m=n.bits,y=n.lencode,v=n.distcode,E=(1<<n.lenbits)-1,b=(1<<n.distbits)-1;e:do{15>m&&(g+=U[o++]<<m,m+=8,g+=U[o++]<<m,m+=8),w=y[g&E];t:for(;;){if(_=w>>>24,g>>>=_,m-=_,_=w>>>16&255,0===_)k[a++]=65535&w;else{if(!(16&_)){if(0===(64&_)){w=y[(65535&w)+(g&(1<<_)-1)];continue t}if(32&_){n.mode=i;break e}e.msg="invalid literal/length code",n.mode=r;break e}S=65535&w,_&=15,_&&(_>m&&(g+=U[o++]<<m,m+=8),S+=g&(1<<_)-1,g>>>=_,m-=_),15>m&&(g+=U[o++]<<m,m+=8,g+=U[o++]<<m,m+=8),w=v[g&b];n:for(;;){if(_=w>>>24,g>>>=_,m-=_,_=w>>>16&255,!(16&_)){if(0===(64&_)){w=v[(65535&w)+(g&(1<<_)-1)];continue n}e.msg="invalid distance code",n.mode=r;break e}if(P=65535&w,_&=15,_>m&&(g+=U[o++]<<m,m+=8,_>m&&(g+=U[o++]<<m,m+=8)),P+=g&(1<<_)-1,P>c){e.msg="invalid distance too far back",n.mode=r;break e}if(g>>>=_,m-=_,_=a-u,P>_){if(_=P-_,_>d&&n.sane){e.msg="invalid distance too far back",n.mode=r;break e}if(x=0,B=p,0===f){if(x+=l-_,S>_){S-=_;do k[a++]=p[x++];while(--_);x=a-P,B=k}}else if(_>f){if(x+=l+f-_,_-=f,S>_){S-=_;do k[a++]=p[x++];while(--_);if(x=0,S>f){_=f,S-=_;do k[a++]=p[x++];while(--_);x=a-P,B=k}}}else if(x+=f-_,S>_){S-=_;do k[a++]=p[x++];while(--_);x=a-P,B=k}for(;S>2;)k[a++]=B[x++],k[a++]=B[x++],k[a++]=B[x++],S-=3;S&&(k[a++]=B[x++],S>1&&(k[a++]=B[x++]))}else{x=a-P;do k[a++]=k[x++],k[a++]=k[x++],k[a++]=k[x++],S-=3;while(S>2);S&&(k[a++]=k[x++],S>1&&(k[a++]=k[x++]))}break}}break}}while(s>o&&h>a);S=m>>3,o-=S,m-=S<<3,g&=(1<<m)-1,e.next_in=o,e.next_out=a,e.avail_in=s>o?5+(s-o):5-(o-s),e.avail_out=h>a?257+(h-a):257-(a-h),n.hold=g,n.bits=m}},{}],35:[function(e,t,n){"use strict";function r(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function i(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new y.Buf16(320),this.work=new y.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function o(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=L,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new y.Buf32(pe),t.distcode=t.distdyn=new y.Buf32(ge),t.sane=1,t.back=-1,k):T}function s(e){var t;return e&&e.state?(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,o(e)):T}function a(e,t){var n,r;return e&&e.state?(r=e.state,0>t?(n=0,t=-t):(n=(t>>4)+1,48>t&&(t&=15)),t&&(8>t||t>15)?T:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,s(e))):T}function u(e,t){var n,r;return e?(r=new i,e.state=r,r.window=null,n=a(e,t),n!==k&&(e.state=null),n):T}function h(e){return u(e,ye)}function c(e){if(ve){var t;for(g=new y.Buf32(512),m=new y.Buf32(32),t=0;144>t;)e.lens[t++]=8;for(;256>t;)e.lens[t++]=9;for(;280>t;)e.lens[t++]=7;for(;288>t;)e.lens[t++]=8;for(w(S,e.lens,0,288,g,0,e.work,{bits:9}),t=0;32>t;)e.lens[t++]=5;w(P,e.lens,0,32,m,0,e.work,{bits:5}),ve=!1}e.lencode=g,e.lenbits=9,e.distcode=m,e.distbits=5}function l(e,t,n,r){var i,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new y.Buf8(o.wsize)),r>=o.wsize?(y.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>r&&(i=r),y.arraySet(o.window,t,n-r,i,o.wnext),r-=i,r?(y.arraySet(o.window,t,n-r,r,0),o.wnext=r,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0}function d(e,t){var n,i,o,s,a,u,h,d,f,p,g,m,pe,ge,me,ye,ve,Ee,be,we,_e,Se,Pe,xe,Be=0,Ue=new y.Buf8(4),ke=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return T;n=e.state,n.mode===X&&(n.mode=Z),a=e.next_out,o=e.output,h=e.avail_out,s=e.next_in,i=e.input,u=e.avail_in,d=n.hold,f=n.bits,p=u,g=h,Se=k;e:for(;;)switch(n.mode){case L:if(0===n.wrap){n.mode=Z;break}for(;16>f;){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}if(2&n.wrap&&35615===d){n.check=0,Ue[0]=255&d,Ue[1]=d>>>8&255,n.check=E(n.check,Ue,2,0),d=0,f=0,n.mode=O;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&d)<<8)+(d>>8))%31){e.msg="incorrect header check",n.mode=le;break}if((15&d)!==A){e.msg="unknown compression method",n.mode=le;break}if(d>>>=4,f-=4,_e=(15&d)+8,0===n.wbits)n.wbits=_e;else if(_e>n.wbits){e.msg="invalid window size",n.mode=le;break}n.dmax=1<<_e,e.adler=n.check=1,n.mode=512&d?q:X,d=0,f=0;break;case O:for(;16>f;){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}if(n.flags=d,(255&n.flags)!==A){e.msg="unknown compression method",n.mode=le;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=le;break}n.head&&(n.head.text=d>>8&1),512&n.flags&&(Ue[0]=255&d,Ue[1]=d>>>8&255,n.check=E(n.check,Ue,2,0)),d=0,f=0,n.mode=z;case z:for(;32>f;){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}n.head&&(n.head.time=d),512&n.flags&&(Ue[0]=255&d,Ue[1]=d>>>8&255,Ue[2]=d>>>16&255,Ue[3]=d>>>24&255,n.check=E(n.check,Ue,4,0)),d=0,f=0,n.mode=M;case M:for(;16>f;){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}n.head&&(n.head.xflags=255&d,n.head.os=d>>8),512&n.flags&&(Ue[0]=255&d,Ue[1]=d>>>8&255,n.check=E(n.check,Ue,2,0)),d=0,f=0,n.mode=F;case F:if(1024&n.flags){for(;16>f;){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}n.length=d,n.head&&(n.head.extra_len=d),512&n.flags&&(Ue[0]=255&d,Ue[1]=d>>>8&255,n.check=E(n.check,Ue,2,0)),d=0,f=0}else n.head&&(n.head.extra=null);n.mode=D;case D:if(1024&n.flags&&(m=n.length,m>u&&(m=u),m&&(n.head&&(_e=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),y.arraySet(n.head.extra,i,s,m,_e)),512&n.flags&&(n.check=E(n.check,i,m,s)),u-=m,s+=m,n.length-=m),n.length))break e;n.length=0,n.mode=j;case j:if(2048&n.flags){if(0===u)break e;m=0;do _e=i[s+m++],n.head&&_e&&n.length<65536&&(n.head.name+=String.fromCharCode(_e));while(_e&&u>m);if(512&n.flags&&(n.check=E(n.check,i,m,s)),u-=m,s+=m,_e)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=H;case H:if(4096&n.flags){if(0===u)break e;m=0;do _e=i[s+m++],n.head&&_e&&n.length<65536&&(n.head.comment+=String.fromCharCode(_e));while(_e&&u>m);if(512&n.flags&&(n.check=E(n.check,i,m,s)),u-=m,s+=m,_e)break e}else n.head&&(n.head.comment=null);n.mode=V;case V:if(512&n.flags){for(;16>f;){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}if(d!==(65535&n.check)){e.msg="header crc mismatch",n.mode=le;break}d=0,f=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=X;break;case q:for(;32>f;){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}e.adler=n.check=r(d),d=0,f=0,n.mode=W;case W:if(0===n.havedict)return e.next_out=a,e.avail_out=h,e.next_in=s,e.avail_in=u,n.hold=d,n.bits=f,R;e.adler=n.check=1,n.mode=X;case X:if(t===B||t===U)break e;case Z:if(n.last){d>>>=7&f,f-=7&f,n.mode=ue;break}for(;3>f;){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}switch(n.last=1&d,d>>>=1,f-=1,3&d){case 0:n.mode=Y;break;case 1:if(c(n),n.mode=te,t===U){d>>>=2,f-=2;break e}break;case 2:n.mode=Q;break;case 3:e.msg="invalid block type",n.mode=le}d>>>=2,f-=2;break;case Y:for(d>>>=7&f,f-=7&f;32>f;){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}if((65535&d)!==(d>>>16^65535)){e.msg="invalid stored block lengths",n.mode=le;break}if(n.length=65535&d,d=0,f=0,n.mode=G,t===U)break e;case G:n.mode=K;case K:if(m=n.length){if(m>u&&(m=u),m>h&&(m=h),0===m)break e;y.arraySet(o,i,s,m,a),u-=m,s+=m,h-=m,a+=m,n.length-=m;break}n.mode=X;break;case Q:for(;14>f;){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}if(n.nlen=(31&d)+257,d>>>=5,f-=5,n.ndist=(31&d)+1,d>>>=5,f-=5,n.ncode=(15&d)+4,d>>>=4,f-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=le;break}n.have=0,n.mode=$;case $:for(;n.have<n.ncode;){for(;3>f;){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}n.lens[ke[n.have++]]=7&d,d>>>=3,f-=3}for(;n.have<19;)n.lens[ke[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,Pe={bits:n.lenbits},Se=w(_,n.lens,0,19,n.lencode,0,n.work,Pe),n.lenbits=Pe.bits,Se){e.msg="invalid code lengths set",n.mode=le;break}n.have=0,n.mode=ee;case ee:for(;n.have<n.nlen+n.ndist;){for(;Be=n.lencode[d&(1<<n.lenbits)-1],me=Be>>>24,ye=Be>>>16&255,ve=65535&Be,!(f>=me);){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}if(16>ve)d>>>=me,f-=me,n.lens[n.have++]=ve;else{if(16===ve){for(xe=me+2;xe>f;){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}if(d>>>=me,f-=me,0===n.have){e.msg="invalid bit length repeat",n.mode=le;break}_e=n.lens[n.have-1],m=3+(3&d),d>>>=2,f-=2}else if(17===ve){for(xe=me+3;xe>f;){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}d>>>=me,f-=me,_e=0,m=3+(7&d),d>>>=3,f-=3}else{for(xe=me+7;xe>f;){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}d>>>=me,f-=me,_e=0,m=11+(127&d),d>>>=7,f-=7}if(n.have+m>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=le;break}for(;m--;)n.lens[n.have++]=_e}}if(n.mode===le)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=le;break}if(n.lenbits=9,Pe={bits:n.lenbits},Se=w(S,n.lens,0,n.nlen,n.lencode,0,n.work,Pe),n.lenbits=Pe.bits,Se){e.msg="invalid literal/lengths set",n.mode=le;break}if(n.distbits=6,n.distcode=n.distdyn,Pe={bits:n.distbits},Se=w(P,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,Pe),n.distbits=Pe.bits,Se){e.msg="invalid distances set",n.mode=le;break}if(n.mode=te,t===U)break e;case te:n.mode=ne;case ne:if(u>=6&&h>=258){e.next_out=a,e.avail_out=h,e.next_in=s,e.avail_in=u,n.hold=d,n.bits=f,b(e,g),a=e.next_out,o=e.output,h=e.avail_out,s=e.next_in,i=e.input,u=e.avail_in,d=n.hold,f=n.bits,n.mode===X&&(n.back=-1);break}for(n.back=0;Be=n.lencode[d&(1<<n.lenbits)-1],me=Be>>>24,ye=Be>>>16&255,ve=65535&Be,!(f>=me);){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}if(ye&&0===(240&ye)){for(Ee=me,be=ye,we=ve;Be=n.lencode[we+((d&(1<<Ee+be)-1)>>Ee)],me=Be>>>24,ye=Be>>>16&255,ve=65535&Be,!(f>=Ee+me);){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}d>>>=Ee,f-=Ee,n.back+=Ee}if(d>>>=me,f-=me,n.back+=me,n.length=ve,0===ye){n.mode=ae;break}if(32&ye){n.back=-1,n.mode=X;break}if(64&ye){e.msg="invalid literal/length code",n.mode=le;break}n.extra=15&ye,n.mode=re;case re:if(n.extra){for(xe=n.extra;xe>f;){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}n.length+=d&(1<<n.extra)-1,d>>>=n.extra,f-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=ie;case ie:for(;Be=n.distcode[d&(1<<n.distbits)-1],me=Be>>>24,ye=Be>>>16&255,ve=65535&Be,!(f>=me);){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}if(0===(240&ye)){for(Ee=me,be=ye,we=ve;Be=n.distcode[we+((d&(1<<Ee+be)-1)>>Ee)],me=Be>>>24,ye=Be>>>16&255,ve=65535&Be,!(f>=Ee+me);){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}d>>>=Ee,f-=Ee,n.back+=Ee}if(d>>>=me,f-=me,n.back+=me,64&ye){e.msg="invalid distance code",n.mode=le;break}n.offset=ve,n.extra=15&ye,n.mode=oe;case oe:if(n.extra){for(xe=n.extra;xe>f;){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}n.offset+=d&(1<<n.extra)-1,d>>>=n.extra,f-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=le;break}n.mode=se;case se:if(0===h)break e;if(m=g-h,n.offset>m){if(m=n.offset-m,m>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=le;break}m>n.wnext?(m-=n.wnext,pe=n.wsize-m):pe=n.wnext-m,m>n.length&&(m=n.length),ge=n.window}else ge=o,pe=a-n.offset,m=n.length;m>h&&(m=h),h-=m,n.length-=m;do o[a++]=ge[pe++];while(--m);0===n.length&&(n.mode=ne);break;case ae:if(0===h)break e;o[a++]=n.length,h--,n.mode=ne;break;case ue:if(n.wrap){for(;32>f;){if(0===u)break e;u--,d|=i[s++]<<f,f+=8}if(g-=h,e.total_out+=g,n.total+=g,g&&(e.adler=n.check=n.flags?E(n.check,o,g,a-g):v(n.check,o,g,a-g)),g=h,(n.flags?d:r(d))!==n.check){e.msg="incorrect data check",n.mode=le;break}d=0,f=0}n.mode=he;case he:if(n.wrap&&n.flags){for(;32>f;){if(0===u)break e;u--,d+=i[s++]<<f,f+=8}if(d!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=le;break}d=0,f=0}n.mode=ce;case ce:Se=C;break e;case le:Se=J;break e;case de:return I;case fe:default:return T}return e.next_out=a,e.avail_out=h,e.next_in=s,e.avail_in=u,n.hold=d,n.bits=f,(n.wsize||g!==e.avail_out&&n.mode<le&&(n.mode<ue||t!==x))&&l(e,e.output,e.next_out,g-e.avail_out)?(n.mode=de,I):(p-=e.avail_in,g-=e.avail_out,e.total_in+=p,e.total_out+=g,n.total+=g,n.wrap&&g&&(e.adler=n.check=n.flags?E(n.check,o,g,e.next_out-g):v(n.check,o,g,e.next_out-g)),e.data_type=n.bits+(n.last?64:0)+(n.mode===X?128:0)+(n.mode===te||n.mode===G?256:0),(0===p&&0===g||t===x)&&Se===k&&(Se=N),Se)}function f(e){if(!e||!e.state)return T;var t=e.state;return t.window&&(t.window=null),e.state=null,k}function p(e,t){var n;return e&&e.state?(n=e.state,0===(2&n.wrap)?T:(n.head=t,t.done=!1,k)):T}var g,m,y=e("../utils/common"),v=e("./adler32"),E=e("./crc32"),b=e("./inffast"),w=e("./inftrees"),_=0,S=1,P=2,x=4,B=5,U=6,k=0,C=1,R=2,T=-2,J=-3,I=-4,N=-5,A=8,L=1,O=2,z=3,M=4,F=5,D=6,j=7,H=8,V=9,q=10,W=11,X=12,Z=13,Y=14,G=15,K=16,Q=17,$=18,ee=19,te=20,ne=21,re=22,ie=23,oe=24,se=25,ae=26,ue=27,he=28,ce=29,le=30,de=31,fe=32,pe=852,ge=592,me=15,ye=me,ve=!0;n.inflateReset=s,n.inflateReset2=a,n.inflateResetKeep=o,n.inflateInit=h,n.inflateInit2=u,n.inflate=d,n.inflateEnd=f,n.inflateGetHeader=p,n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./inffast":34,"./inftrees":36}],36:[function(e,t,n){"use strict";var r=e("../utils/common"),i=15,o=852,s=592,a=0,u=1,h=2,c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,p,g,m,y,v){var E,b,w,_,S,P,x,B,U,k=v.bits,C=0,R=0,T=0,J=0,I=0,N=0,A=0,L=0,O=0,z=0,M=null,F=0,D=new r.Buf16(i+1),j=new r.Buf16(i+1),H=null,V=0;for(C=0;i>=C;C++)D[C]=0;for(R=0;p>R;R++)D[t[n+R]]++;for(I=k,J=i;J>=1&&0===D[J];J--);if(I>J&&(I=J),0===J)return g[m++]=20971520,g[m++]=20971520,v.bits=1,0;for(T=1;J>T&&0===D[T];T++);for(T>I&&(I=T),
L=1,C=1;i>=C;C++)if(L<<=1,L-=D[C],0>L)return-1;if(L>0&&(e===a||1!==J))return-1;for(j[1]=0,C=1;i>C;C++)j[C+1]=j[C]+D[C];for(R=0;p>R;R++)0!==t[n+R]&&(y[j[t[n+R]]++]=R);if(e===a?(M=H=y,P=19):e===u?(M=c,F-=257,H=l,V-=257,P=256):(M=d,H=f,P=-1),z=0,R=0,C=T,S=m,N=I,A=0,w=-1,O=1<<I,_=O-1,e===u&&O>o||e===h&&O>s)return 1;for(var q=0;;){q++,x=C-A,y[R]<P?(B=0,U=y[R]):y[R]>P?(B=H[V+y[R]],U=M[F+y[R]]):(B=96,U=0),E=1<<C-A,b=1<<N,T=b;do b-=E,g[S+(z>>A)+b]=x<<24|B<<16|U|0;while(0!==b);for(E=1<<C-1;z&E;)E>>=1;if(0!==E?(z&=E-1,z+=E):z=0,R++,0===--D[C]){if(C===J)break;C=t[n+y[R]]}if(C>I&&(z&_)!==w){for(0===A&&(A=I),S+=T,N=C-A,L=1<<N;J>N+A&&(L-=D[N+A],!(0>=L));)N++,L<<=1;if(O+=1<<N,e===u&&O>o||e===h&&O>s)return 1;w=z&_,g[w]=I<<24|N<<16|S-m|0}}return 0!==z&&(g[S+z]=C-A<<24|64<<16|0),v.bits=I,0}},{"../utils/common":27}],37:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],38:[function(e,t,n){"use strict";function r(e){for(var t=e.length;--t>=0;)e[t]=0}function i(e){return 256>e?se[e]:se[256+(e>>>7)]}function o(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function s(e,t,n){e.bi_valid>X-n?(e.bi_buf|=t<<e.bi_valid&65535,o(e,e.bi_buf),e.bi_buf=t>>X-e.bi_valid,e.bi_valid+=n-X):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function a(e,t,n){s(e,n[2*t],n[2*t+1])}function u(e,t){var n=0;do n|=1&e,e>>>=1,n<<=1;while(--t>0);return n>>>1}function h(e){16===e.bi_valid?(o(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}function c(e,t){var n,r,i,o,s,a,u=t.dyn_tree,h=t.max_code,c=t.stat_desc.static_tree,l=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,g=0;for(o=0;W>=o;o++)e.bl_count[o]=0;for(u[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;q>n;n++)r=e.heap[n],o=u[2*u[2*r+1]+1]+1,o>p&&(o=p,g++),u[2*r+1]=o,r>h||(e.bl_count[o]++,s=0,r>=f&&(s=d[r-f]),a=u[2*r],e.opt_len+=a*(o+s),l&&(e.static_len+=a*(c[2*r+1]+s)));if(0!==g){do{for(o=p-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[p]--,g-=2}while(g>0);for(o=p;0!==o;o--)for(r=e.bl_count[o];0!==r;)i=e.heap[--n],i>h||(u[2*i+1]!==o&&(e.opt_len+=(o-u[2*i+1])*u[2*i],u[2*i+1]=o),r--)}}function l(e,t,n){var r,i,o=new Array(W+1),s=0;for(r=1;W>=r;r++)o[r]=s=s+n[r-1]<<1;for(i=0;t>=i;i++){var a=e[2*i+1];0!==a&&(e[2*i]=u(o[a]++,a))}}function d(){var e,t,n,r,i,o=new Array(W+1);for(n=0,r=0;F-1>r;r++)for(ue[r]=n,e=0;e<1<<$[r];e++)ae[n++]=r;for(ae[n-1]=r,i=0,r=0;16>r;r++)for(he[r]=i,e=0;e<1<<ee[r];e++)se[i++]=r;for(i>>=7;H>r;r++)for(he[r]=i<<7,e=0;e<1<<ee[r]-7;e++)se[256+i++]=r;for(t=0;W>=t;t++)o[t]=0;for(e=0;143>=e;)ie[2*e+1]=8,e++,o[8]++;for(;255>=e;)ie[2*e+1]=9,e++,o[9]++;for(;279>=e;)ie[2*e+1]=7,e++,o[7]++;for(;287>=e;)ie[2*e+1]=8,e++,o[8]++;for(l(ie,j+1,o),e=0;H>e;e++)oe[2*e+1]=5,oe[2*e]=u(e,5);ce=new fe(ie,$,D+1,j,W),le=new fe(oe,ee,0,H,W),de=new fe(new Array(0),te,0,V,Z)}function f(e){var t;for(t=0;j>t;t++)e.dyn_ltree[2*t]=0;for(t=0;H>t;t++)e.dyn_dtree[2*t]=0;for(t=0;V>t;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*Y]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function p(e){e.bi_valid>8?o(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function g(e,t,n,r){p(e),r&&(o(e,n),o(e,~n)),R.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}function m(e,t,n,r){var i=2*t,o=2*n;return e[i]<e[o]||e[i]===e[o]&&r[t]<=r[n]}function y(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&m(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!m(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function v(e,t,n){var r,o,u,h,c=0;if(0!==e.last_lit)do r=e.pending_buf[e.d_buf+2*c]<<8|e.pending_buf[e.d_buf+2*c+1],o=e.pending_buf[e.l_buf+c],c++,0===r?a(e,o,t):(u=ae[o],a(e,u+D+1,t),h=$[u],0!==h&&(o-=ue[u],s(e,o,h)),r--,u=i(r),a(e,u,n),h=ee[u],0!==h&&(r-=he[u],s(e,r,h)));while(c<e.last_lit);a(e,Y,t)}function E(e,t){var n,r,i,o=t.dyn_tree,s=t.stat_desc.static_tree,a=t.stat_desc.has_stree,u=t.stat_desc.elems,h=-1;for(e.heap_len=0,e.heap_max=q,n=0;u>n;n++)0!==o[2*n]?(e.heap[++e.heap_len]=h=n,e.depth[n]=0):o[2*n+1]=0;for(;e.heap_len<2;)i=e.heap[++e.heap_len]=2>h?++h:0,o[2*i]=1,e.depth[i]=0,e.opt_len--,a&&(e.static_len-=s[2*i+1]);for(t.max_code=h,n=e.heap_len>>1;n>=1;n--)y(e,o,n);i=u;do n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],y(e,o,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,o[2*i]=o[2*n]+o[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,o[2*n+1]=o[2*r+1]=i,e.heap[1]=i++,y(e,o,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],c(e,t),l(o,h,e.bl_count)}function b(e,t,n){var r,i,o=-1,s=t[1],a=0,u=7,h=4;for(0===s&&(u=138,h=3),t[2*(n+1)+1]=65535,r=0;n>=r;r++)i=s,s=t[2*(r+1)+1],++a<u&&i===s||(h>a?e.bl_tree[2*i]+=a:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[2*G]++):10>=a?e.bl_tree[2*K]++:e.bl_tree[2*Q]++,a=0,o=i,0===s?(u=138,h=3):i===s?(u=6,h=3):(u=7,h=4))}function w(e,t,n){var r,i,o=-1,u=t[1],h=0,c=7,l=4;for(0===u&&(c=138,l=3),r=0;n>=r;r++)if(i=u,u=t[2*(r+1)+1],!(++h<c&&i===u)){if(l>h){do a(e,i,e.bl_tree);while(0!==--h)}else 0!==i?(i!==o&&(a(e,i,e.bl_tree),h--),a(e,G,e.bl_tree),s(e,h-3,2)):10>=h?(a(e,K,e.bl_tree),s(e,h-3,3)):(a(e,Q,e.bl_tree),s(e,h-11,7));h=0,o=i,0===u?(c=138,l=3):i===u?(c=6,l=3):(c=7,l=4)}}function _(e){var t;for(b(e,e.dyn_ltree,e.l_desc.max_code),b(e,e.dyn_dtree,e.d_desc.max_code),E(e,e.bl_desc),t=V-1;t>=3&&0===e.bl_tree[2*ne[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}function S(e,t,n,r){var i;for(s(e,t-257,5),s(e,n-1,5),s(e,r-4,4),i=0;r>i;i++)s(e,e.bl_tree[2*ne[i]+1],3);w(e,e.dyn_ltree,t-1),w(e,e.dyn_dtree,n-1)}function P(e){var t,n=4093624447;for(t=0;31>=t;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return J;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return I;for(t=32;D>t;t++)if(0!==e.dyn_ltree[2*t])return I;return J}function x(e){ge||(d(),ge=!0),e.l_desc=new pe(e.dyn_ltree,ce),e.d_desc=new pe(e.dyn_dtree,le),e.bl_desc=new pe(e.bl_tree,de),e.bi_buf=0,e.bi_valid=0,f(e)}function B(e,t,n,r){s(e,(A<<1)+(r?1:0),3),g(e,t,n,!0)}function U(e){s(e,L<<1,3),a(e,Y,ie),h(e)}function k(e,t,n,r){var i,o,a=0;e.level>0?(e.strm.data_type===N&&(e.strm.data_type=P(e)),E(e,e.l_desc),E(e,e.d_desc),a=_(e),i=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,i>=o&&(i=o)):i=o=n+5,i>=n+4&&-1!==t?B(e,t,n,r):e.strategy===T||o===i?(s(e,(L<<1)+(r?1:0),3),v(e,ie,oe)):(s(e,(O<<1)+(r?1:0),3),S(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),v(e,e.dyn_ltree,e.dyn_dtree)),f(e),r&&p(e)}function C(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(ae[n]+D+1)]++,e.dyn_dtree[2*i(t)]++),e.last_lit===e.lit_bufsize-1}var R=e("../utils/common"),T=4,J=0,I=1,N=2,A=0,L=1,O=2,z=3,M=258,F=29,D=256,j=D+1+F,H=30,V=19,q=2*j+1,W=15,X=16,Z=7,Y=256,G=16,K=17,Q=18,$=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ee=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ne=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re=512,ie=new Array(2*(j+2));r(ie);var oe=new Array(2*H);r(oe);var se=new Array(re);r(se);var ae=new Array(M-z+1);r(ae);var ue=new Array(F);r(ue);var he=new Array(H);r(he);var ce,le,de,fe=function(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length},pe=function(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t},ge=!1;n._tr_init=x,n._tr_stored_block=B,n._tr_flush_block=k,n._tr_tally=C,n._tr_align=U},{"../utils/common":27}],39:[function(e,t,n){"use strict";function r(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}t.exports=r},{}]},{},[9])(9)}),function(){"use strict";function e(e){return"function"==typeof e||"object"==typeof e&&null!==e}function t(e){return"function"==typeof e}function n(e){return"object"==typeof e&&null!==e}function r(){}function i(e,t){for(var n=0,r=e.length;r>n;n++)if(e[n]===t)return n;return-1}function o(e){var t=e._promiseCallbacks;return t||(t=e._promiseCallbacks={}),t}function s(e,t){return"onerror"===e?void we.on("error",t):2!==arguments.length?we[e]:void(we[e]=t)}function a(){setTimeout(function(){for(var e,t=0;t<_e.length;t++){e=_e[t];var n=e.payload;n.guid=n.key+n.id,n.childGuid=n.key+n.childId,n.error&&(n.stack=n.error.stack),we.trigger(e.name,e.payload)}_e.length=0},50)}function u(e,t,n){1===_e.push({name:e,payload:{key:t._guidKey,id:t._id,eventName:e,detail:t._result,childId:n&&n._id,label:t._label,timeStamp:ve(),error:we["instrument-with-stack"]?new Error(t._label):null}})&&a()}function h(){return new TypeError("A promises callback cannot return that same promise.")}function c(){}function l(e){try{return e.then}catch(t){return Ue.error=t,Ue}}function d(e,t,n,r){try{e.call(t,n,r)}catch(i){return i}}function f(e,t,n){we.async(function(e){var r=!1,i=d(n,t,function(n){r||(r=!0,t!==n?m(e,n):v(e,n))},function(t){r||(r=!0,E(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&i&&(r=!0,E(e,i))},e)}function p(e,t){t._state===xe?v(e,t._result):t._state===Be?(t._onError=null,E(e,t._result)):b(t,void 0,function(n){t!==n?m(e,n):v(e,n)},function(t){E(e,t)})}function g(e,n){if(n.constructor===e.constructor)p(e,n);else{var r=l(n);r===Ue?E(e,Ue.error):void 0===r?v(e,n):t(r)?f(e,n,r):v(e,n)}}function m(t,n){t===n?v(t,n):e(n)?g(t,n):v(t,n)}function y(e){e._onError&&e._onError(e._result),w(e)}function v(e,t){e._state===Pe&&(e._result=t,e._state=xe,0===e._subscribers.length?we.instrument&&Se("fulfilled",e):we.async(w,e))}function E(e,t){e._state===Pe&&(e._state=Be,e._result=t,we.async(y,e))}function b(e,t,n,r){var i=e._subscribers,o=i.length;e._onError=null,i[o]=t,i[o+xe]=n,i[o+Be]=r,0===o&&e._state&&we.async(w,e)}function w(e){var t=e._subscribers,n=e._state;if(we.instrument&&Se(n===xe?"fulfilled":"rejected",e),0!==t.length){for(var r,i,o=e._result,s=0;s<t.length;s+=3)r=t[s],i=t[s+n],r?P(n,r,i,o):i(o);e._subscribers.length=0}}function _(){this.error=null}function S(e,t){try{return e(t)}catch(n){return ke.error=n,ke}}function P(e,n,r,i){var o,s,a,u,c=t(r);if(c){if(o=S(r,i),o===ke?(u=!0,s=o.error,o=null):a=!0,n===o)return void E(n,h())}else o=i,a=!0;n._state!==Pe||(c&&a?m(n,o):u?E(n,s):e===xe?v(n,o):e===Be&&E(n,o))}function x(e,t){var n=!1;try{t(function(t){n||(n=!0,m(e,t))},function(t){n||(n=!0,E(e,t))})}catch(r){E(e,r)}}function B(e,t,n){return e===xe?{state:"fulfilled",value:n}:{state:"rejected",reason:n}}function U(e,t,n,r){var i=this;i._instanceConstructor=e,i.promise=new e(c,r),i._abortOnReject=n,i._validateInput(t)?(i._input=t,i.length=t.length,i._remaining=t.length,i._init(),0===i.length?v(i.promise,i._result):(i.length=i.length||0,i._enumerate(),0===i._remaining&&v(i.promise,i._result))):E(i.promise,i._validationError())}function k(e,t){return new Ce(this,e,!0,t).promise}function C(e,t){function n(e){m(o,e)}function r(e){E(o,e)}var i=this,o=new i(c,t);if(!ye(e))return E(o,new TypeError("You must pass an array to race.")),o;for(var s=e.length,a=0;o._state===Pe&&s>a;a++)b(i.resolve(e[a]),void 0,n,r);return o}function R(e,t){var n=this;if(e&&"object"==typeof e&&e.constructor===n)return e;var r=new n(c,t);return m(r,e),r}function T(e,t){var n=this,r=new n(c,t);return E(r,e),r}function J(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function I(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function N(e,n){var r=this;r._id=Ae++,r._label=n,r._state=void 0,r._result=void 0,r._subscribers=[],we.instrument&&Se("created",r),c!==e&&(t(e)||J(),r instanceof N||I(),x(r,e))}function A(e,t,n){this._superConstructor(e,t,!1,n)}function L(e,t){return new A(Le,e,t).promise}function O(e,t){return Le.all(e,t)}function z(e,t){Ze[De]=e,Ze[De+1]=t,De+=2,2===De&&ze()}function M(){var e=process.nextTick,t=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(t)&&"0"===t[1]&&"10"===t[2]&&(e=setImmediate),function(){e(V)}}function F(){return function(){Oe(V)}}function D(){var e=0,t=new qe(V),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function j(){var e=new MessageChannel;return e.port1.onmessage=V,function(){e.port2.postMessage(0)}}function H(){return function(){setTimeout(V,1)}}function V(){for(var e=0;De>e;e+=2){var t=Ze[e],n=Ze[e+1];t(n),Ze[e]=void 0,Ze[e+1]=void 0}De=0}function q(){try{var e=require,t=e("vertx");return Oe=t.runOnLoop||t.runOnContext,F()}catch(n){return H()}}function W(e){var t={};return t.promise=new Le(function(e,n){t.resolve=e,t.reject=n},e),t}function X(e,n,r){return Le.all(e,r).then(function(e){if(!t(n))throw new TypeError("You must pass a function as filter's second argument.");for(var i=e.length,o=new Array(i),s=0;i>s;s++)o[s]=n(e[s]);return Le.all(o,r).then(function(t){for(var n=new Array(i),r=0,o=0;i>o;o++)t[o]&&(n[r]=e[o],r++);return n.length=r,n})})}function Z(e,t,n){this._superConstructor(e,t,!0,n)}function Y(e,t,n){this._superConstructor(e,t,!1,n)}function G(e,t){return new Y(Le,e,t).promise}function K(e,t){return new Ke(Le,e,t).promise}function Q(e,n,r){return Le.all(e,r).then(function(e){if(!t(n))throw new TypeError("You must pass a function as map's second argument.");for(var i=e.length,o=new Array(i),s=0;i>s;s++)o[s]=n(e[s]);return Le.all(o,r)})}function $(){this.value=void 0}function ee(e){try{return e.then}catch(t){return nt.value=t,nt}}function te(e,t,n){try{e.apply(t,n)}catch(r){return nt.value=r,nt}}function ne(e,t){for(var n,r,i={},o=e.length,s=new Array(o),a=0;o>a;a++)s[a]=e[a];for(r=0;r<t.length;r++)n=t[r],i[n]=s[r+1];return i}function re(e){for(var t=e.length,n=new Array(t-1),r=1;t>r;r++)n[r-1]=e[r];return n}function ie(e,t){return{then:function(n,r){return e.call(t,n,r)}}}function oe(e,t){var n=function(){for(var n,r=this,i=arguments.length,o=new Array(i+1),s=!1,a=0;i>a;++a){if(n=arguments[a],!s){if(s=ue(n),s===rt){var u=new Le(c);return E(u,rt.value),u}s&&s!==!0&&(n=ie(s,n))}o[a]=n}var h=new Le(c);return o[i]=function(e,n){e?E(h,e):void 0===t?m(h,n):t===!0?m(h,re(arguments)):ye(t)?m(h,ne(arguments,t)):m(h,n)},s?ae(h,o,e,r):se(h,o,e,r)};return n.__proto__=e,n}function se(e,t,n,r){var i=te(n,r,t);return i===nt&&E(e,i.value),e}function ae(e,t,n,r){return Le.all(t).then(function(t){var i=te(n,r,t);return i===nt&&E(e,i.value),e})}function ue(e){return e&&"object"==typeof e?e.constructor===Le?!0:ee(e):!1}function he(e,t){return Le.race(e,t)}function ce(e,t){return Le.reject(e,t)}function le(e,t){return Le.resolve(e,t)}function de(e){throw setTimeout(function(){throw e}),e}function fe(e,t){we.async(e,t)}function pe(){we.on.apply(we,arguments)}function ge(){we.off.apply(we,arguments)}var me;me=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var ye=me,ve=Date.now||function(){return(new Date).getTime()},Ee=Object.create||function(e){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof e)throw new TypeError("Argument must be an object");return r.prototype=e,new r},be={mixin:function(e){return e.on=this.on,e.off=this.off,e.trigger=this.trigger,e._promiseCallbacks=void 0,e},on:function(e,t){if("function"!=typeof t)throw new TypeError("Callback must be a function");var n,r=o(this);n=r[e],n||(n=r[e]=[]),-1===i(n,t)&&n.push(t)},off:function(e,t){var n,r,s=o(this);return t?(n=s[e],r=i(n,t),void(-1!==r&&n.splice(r,1))):void(s[e]=[])},trigger:function(e,t,n){var r,i,s=o(this);if(r=s[e])for(var a=0;a<r.length;a++)(i=r[a])(t,n)}},we={instrument:!1};be.mixin(we);var _e=[],Se=u,Pe=void 0,xe=1,Be=2,Ue=new _,ke=new _,Ce=U;U.prototype._validateInput=function(e){return ye(e)},U.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},U.prototype._init=function(){this._result=new Array(this.length)},U.prototype._enumerate=function(){for(var e=this,t=e.length,n=e.promise,r=e._input,i=0;n._state===Pe&&t>i;i++)e._eachEntry(r[i],i)},U.prototype._eachEntry=function(e,t){var r=this,i=r._instanceConstructor;n(e)?e.constructor===i&&e._state!==Pe?(e._onError=null,r._settledAt(e._state,t,e._result)):r._willSettleAt(i.resolve(e),t):(r._remaining--,r._result[t]=r._makeResult(xe,t,e))},U.prototype._settledAt=function(e,t,n){var r=this,i=r.promise;i._state===Pe&&(r._remaining--,r._abortOnReject&&e===Be?E(i,n):r._result[t]=r._makeResult(e,t,n)),0===r._remaining&&v(i,r._result)},U.prototype._makeResult=function(e,t,n){return n},U.prototype._willSettleAt=function(e,t){var n=this;b(e,void 0,function(e){n._settledAt(xe,t,e)},function(e){n._settledAt(Be,t,e)})};var Re=k,Te=C,Je=R,Ie=T,Ne="rsvp_"+ve()+"-",Ae=0,Le=N;N.cast=Je,N.all=Re,N.race=Te,N.resolve=Je,N.reject=Ie,N.prototype={constructor:N,_guidKey:Ne,_onError:function(e){var t=this;we.after(function(){t._onError&&we.trigger("error",e,t._label)})},then:function(e,t,n){var r=this,i=r._state;if(i===xe&&!e||i===Be&&!t)return we.instrument&&Se("chained",r,r),r;r._onError=null;var o=new r.constructor(c,n),s=r._result;if(we.instrument&&Se("chained",r,o),i){var a=arguments[i-1];we.async(function(){P(i,o,a,s)})}else b(r,o,e,t);return o},"catch":function(e,t){return this.then(void 0,e,t)},"finally":function(e,t){var n=this,r=n.constructor;return n.then(function(t){return r.resolve(e()).then(function(){return t})},function(t){return r.resolve(e()).then(function(){throw t})},t)}},A.prototype=Ee(Ce.prototype),A.prototype._superConstructor=Ce,A.prototype._makeResult=B,A.prototype._validationError=function(){return new Error("allSettled must be called with an array")};var Oe,ze,Me=L,Fe=O,De=0,je=({}.toString,z),He="undefined"!=typeof window?window:void 0,Ve=He||{},qe=Ve.MutationObserver||Ve.WebKitMutationObserver,We="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),Xe="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Ze=new Array(1e3);ze=We?M():qe?D():Xe?j():void 0===He&&"function"==typeof require?q():H();var Ye=W,Ge=X,Ke=Z;Z.prototype=Ee(Ce.prototype),Z.prototype._superConstructor=Ce,Z.prototype._init=function(){this._result={}},Z.prototype._validateInput=function(e){return e&&"object"==typeof e},Z.prototype._validationError=function(){return new Error("Promise.hash must be called with an object")},Z.prototype._enumerate=function(){var e=this,t=e.promise,n=e._input,r=[];for(var i in n)t._state===Pe&&Object.prototype.hasOwnProperty.call(n,i)&&r.push({position:i,entry:n[i]});var o=r.length;e._remaining=o;for(var s,a=0;t._state===Pe&&o>a;a++)s=r[a],e._eachEntry(s.entry,s.position)},Y.prototype=Ee(Ke.prototype),Y.prototype._superConstructor=Ce,Y.prototype._makeResult=B,Y.prototype._validationError=function(){return new Error("hashSettled must be called with an object")};var Qe,$e=G,et=K,tt=Q,nt=new $,rt=new $,it=oe;if("object"==typeof self)Qe=self;else{if("object"!=typeof global)throw new Error("no global: `self` or `global` found");Qe=global}var ot=Qe,st=he,at=ce,ut=le,ht=de;we.async=je,we.after=function(e){setTimeout(e,0)};if("undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var ct=window.__PROMISE_INSTRUMENTATION__;s("instrument",!0);for(var lt in ct)ct.hasOwnProperty(lt)&&pe(lt,ct[lt])}var dt={race:st,Promise:Le,allSettled:Me,hash:et,hashSettled:$e,denodeify:it,on:pe,off:ge,map:tt,filter:Ge,resolve:ut,reject:at,all:Fe,rethrow:ht,defer:Ye,EventTarget:be,configure:s,async:fe};"function"==typeof define&&define.amd?define(function(){return dt}):"undefined"!=typeof module&&module.exports?module.exports=dt:"undefined"!=typeof ot&&(ot.RSVP=dt)}.call(this);var EPUBJS=EPUBJS||{};EPUBJS.VERSION="0.2.12",EPUBJS.plugins=EPUBJS.plugins||{},EPUBJS.filePath=EPUBJS.filePath||"/epubjs/",EPUBJS.Render={},function(e){var t=(e.ePub||{},e.ePub=function(){var e,t;return"undefined"!=typeof arguments[0]&&("string"==typeof arguments[0]||arguments[0]instanceof ArrayBuffer)&&(e=arguments[0],arguments[1]&&"object"==typeof arguments[1]?(t=arguments[1],t.bookPath=e):t={bookPath:e}),!arguments[0]||"object"!=typeof arguments[0]||arguments[0]instanceof ArrayBuffer||(t=arguments[0]),new EPUBJS.Book(t)});"function"==typeof define&&define.amd?define(["rsvp"],function(){return t}):"undefined"!=typeof module&&module.exports&&(module.exports=t)}(window),EPUBJS.Book=function(e){this.settings=EPUBJS.core.defaults(e||{},{bookPath:void 0,bookKey:void 0,packageUrl:void 0,storage:!1,fromStorage:!1,saved:!1,online:!0,contained:!1,width:void 0,height:void 0,layoutOveride:void 0,orientation:void 0,minSpreadWidth:768,gap:"auto",version:1,restore:!1,reload:!1,"goto":!1,styles:{},headTags:{},withCredentials:!1,render_method:"Iframe"}),this.settings.EPUBJSVERSION=EPUBJS.VERSION,this.spinePos=0,this.stored=!1,this.online=this.settings.online||navigator.onLine,this.networkListeners(),this.ready={manifest:new RSVP.defer,spine:new RSVP.defer,metadata:new RSVP.defer,cover:new RSVP.defer,toc:new RSVP.defer,pageList:new RSVP.defer},this.readyPromises=[this.ready.manifest.promise,this.ready.spine.promise,this.ready.metadata.promise,this.ready.cover.promise,this.ready.toc.promise],this.pageList=[],this.pagination=new EPUBJS.Pagination,this.pageListReady=this.ready.pageList.promise,this.ready.all=RSVP.all(this.readyPromises),this.ready.all.then(this._ready.bind(this)),this.isRendered=!1,this._q=EPUBJS.core.queue(this),this._rendering=!1,this._displayQ=EPUBJS.core.queue(this),this._moving=!1,this._gotoQ=EPUBJS.core.queue(this),this.renderer=new EPUBJS.Renderer(this.settings.render_method),this.renderer.setMinSpreadWidth(this.settings.minSpreadWidth),this.renderer.setGap(this.settings.gap),this.listenToRenderer(this.renderer),this.defer_opened=new RSVP.defer,this.opened=this.defer_opened.promise,this.store=!1,this.settings.storage!==!1&&this.fromStorage(!0),("string"==typeof this.settings.bookPath||this.settings.bookPath instanceof ArrayBuffer)&&this.open(this.settings.bookPath,this.settings.reload),window.addEventListener("beforeunload",this.unload.bind(this),!1)},EPUBJS.Book.prototype.open=function(e,t){var n,r=this,i=new RSVP.defer;return this.settings.bookPath=e,this.settings.contained||this.isContained(e)?(this.settings.contained=this.contained=!0,this.bookUrl="",n=this.unarchive(e).then(function(){return r.loadPackage()})):(this.bookUrl=this.urlFrom(e),n=this.loadPackage()),this.settings.restore&&!t&&localStorage?n.then(function(e){var t=r.packageIdentifier(e),n=r.restore(t);n||r.unpack(e),i.resolve(),r.defer_opened.resolve()}):n.then(function(e){r.unpack(e),i.resolve(),r.defer_opened.resolve()}),this._registerReplacements(this.renderer),i.promise},EPUBJS.Book.prototype.loadPackage=function(e){var t,n=this,r=new EPUBJS.Parser,i=e||"META-INF/container.xml";return t=this.settings.packageUrl?n.loadXml(n.settings.packageUrl):n.loadXml(n.bookUrl+i).then(function(e){return r.container(e)}).then(function(e){return n.settings.contentsPath=n.bookUrl+e.basePath,n.settings.packageUrl=n.bookUrl+e.packagePath,n.settings.encoding=e.encoding,n.loadXml(n.settings.packageUrl)}),t["catch"](function(e){console.error("Could not load book at: "+i),n.trigger("book:loadFailed",i)}),t},EPUBJS.Book.prototype.packageIdentifier=function(e){var t=new EPUBJS.Parser;return t.identifier(e)},EPUBJS.Book.prototype.unpack=function(e){var t=this,n=new EPUBJS.Parser;t.contents=n.packageContents(e,t.settings.contentsPath),t.manifest=t.contents.manifest,t.spine=t.contents.spine,t.spineIndexByURL=t.contents.spineIndexByURL,t.metadata=t.contents.metadata,t.settings.bookKey||(t.settings.bookKey=t.generateBookKey(t.metadata.identifier)),t.globalLayoutProperties=t.parseLayoutProperties(t.metadata),t.contents.coverPath&&(t.cover=t.contents.cover=t.settings.contentsPath+t.contents.coverPath),t.spineNodeIndex=t.contents.spineNodeIndex,t.ready.manifest.resolve(t.contents.manifest),t.ready.spine.resolve(t.contents.spine),t.ready.metadata.resolve(t.contents.metadata),t.ready.cover.resolve(t.contents.cover),t.locations=new EPUBJS.Locations(t.spine,t.store,t.settings.withCredentials),t.contents.navPath?(t.settings.navUrl=t.settings.contentsPath+t.contents.navPath,t.loadXml(t.settings.navUrl).then(function(e){return n.nav(e,t.spineIndexByURL,t.spine)}).then(function(e){t.toc=t.contents.toc=e,t.ready.toc.resolve(t.contents.toc)},function(e){t.ready.toc.resolve(!1)}),t.loadXml(t.settings.navUrl).then(function(e){return n.pageList(e,t.spineIndexByURL,t.spine)}).then(function(e){var n=new EPUBJS.EpubCFI,r=0;0!==e.length&&(t.pageList=t.contents.pageList=e,t.pageList.forEach(function(e){e.cfi||(r+=1,n.generateCfiFromHref(e.href,t).then(function(n){e.cfi=n,e.packageUrl=t.settings.packageUrl,r-=1,0===r&&(t.pagination.process(t.pageList),t.ready.pageList.resolve(t.pageList))}))}),r||(t.pagination.process(t.pageList),t.ready.pageList.resolve(t.pageList)))},function(e){t.ready.pageList.resolve([])})):t.contents.tocPath?(t.settings.tocUrl=t.settings.contentsPath+t.contents.tocPath,t.loadXml(t.settings.tocUrl).then(function(e){return n.toc(e,t.spineIndexByURL,t.spine)}).then(function(e){t.toc=t.contents.toc=e,t.ready.toc.resolve(t.contents.toc)},function(e){t.ready.toc.resolve(!1)})):t.ready.toc.resolve(!1)},EPUBJS.Book.prototype.createHiddenRender=function(e,t,n){var r,i,o=this.element.getBoundingClientRect(),s=t||this.settings.width||o.width,a=n||this.settings.height||o.height;return e.setMinSpreadWidth(this.settings.minSpreadWidth),e.setGap(this.settings.gap),this._registerReplacements(e),this.settings.forceSingle&&e.forceSingle(!0),r=document.createElement("div"),r.style.visibility="hidden",r.style.overflow="hidden",r.style.width="0",r.style.height="0",this.element.appendChild(r),i=document.createElement("div"),i.style.visibility="hidden",i.style.overflow="hidden",i.style.width=s+"px",i.style.height=a+"px",r.appendChild(i),e.initialize(i),r},EPUBJS.Book.prototype.generatePageList=function(e,t){var n=[],r=new EPUBJS.Renderer(this.settings.render_method,!1),i=this.createHiddenRender(r,e,t),o=new RSVP.defer,s=-1,a=this.spine.length,u=0,h=function(e){var t,i=s+1,o=e||new RSVP.defer;return i>=a?o.resolve():(s=i,t=new EPUBJS.Chapter(this.spine[s],this.store),r.displayChapter(t,this.globalLayoutProperties).then(function(e){r.pageMap.forEach(function(e){u+=1,n.push({cfi:e.start,page:u})}),r.pageMap.length%2>0&&r.spreads&&(u+=1,n.push({cfi:r.pageMap[r.pageMap.length-1].end,page:u})),setTimeout(function(){h(o)},1)})),o.promise}.bind(this);h().then(function(){r.remove(),this.element.removeChild(i),o.resolve(n)}.bind(this));return o.promise},EPUBJS.Book.prototype.generatePagination=function(e,t){var n=this,r=new RSVP.defer;return this.ready.spine.promise.then(function(){n.generatePageList(e,t).then(function(e){n.pageList=n.contents.pageList=e,n.pagination.process(e),n.ready.pageList.resolve(n.pageList),r.resolve(n.pageList)})}),r.promise},EPUBJS.Book.prototype.loadPagination=function(e){var t=JSON.parse(e);return t&&t.length&&(this.pageList=t,this.pagination.process(this.pageList),this.ready.pageList.resolve(this.pageList)),this.pageList},EPUBJS.Book.prototype.getPageList=function(){return this.ready.pageList.promise},EPUBJS.Book.prototype.getMetadata=function(){return this.ready.metadata.promise},EPUBJS.Book.prototype.getToc=function(){return this.ready.toc.promise},EPUBJS.Book.prototype.networkListeners=function(){var e=this;window.addEventListener("offline",function(t){e.online=!1,e.settings.storage&&e.fromStorage(!0),e.trigger("book:offline")},!1),window.addEventListener("online",function(t){e.online=!0,e.settings.storage&&e.fromStorage(!1),e.trigger("book:online")},!1)},EPUBJS.Book.prototype.listenToRenderer=function(e){var t=this;e.Events.forEach(function(n){e.on(n,function(e){t.trigger(n,e)})}),e.on("renderer:visibleRangeChanged",function(e){var t,n,r,i=[];this.pageList.length>0&&(t=this.pagination.pageFromCfi(e.start),r=this.pagination.percentageFromPage(t),i.push(t),e.end&&(n=this.pagination.pageFromCfi(e.end),i.push(n)),this.trigger("book:pageChanged",{anchorPage:t,percentage:r,pageRange:i}))}.bind(this)),e.on("render:loaded",this.loadChange.bind(this))},EPUBJS.Book.prototype.loadChange=function(e){var t,n,r=EPUBJS.core.uri(e),i=EPUBJS.core.uri(this.currentChapter.absolute);r.path!=i.path?(console.warn("Miss Match",r.path,this.currentChapter.absolute),t=this.spineIndexByURL[r.filename],n=new EPUBJS.Chapter(this.spine[t],this.store),this.currentChapter=n,this.renderer.currentChapter=n,this.renderer.afterLoad(this.renderer.render.docEl),this.renderer.beforeDisplay(function(){this.renderer.afterDisplay()}.bind(this))):this._rendering||this.renderer.reformat()},EPUBJS.Book.prototype.unlistenToRenderer=function(e){e.Events.forEach(function(t){e.off(t)})},EPUBJS.Book.prototype.loadXml=function(e){return this.settings.fromStorage?this.store.getXml(e,this.settings.encoding):this.settings.contained?this.zip.getXml(e,this.settings.encoding):EPUBJS.core.request(e,"xml",this.settings.withCredentials)},EPUBJS.Book.prototype.urlFrom=function(e){var t,n=EPUBJS.core.uri(e),r=n.protocol,i="/"==n.path[0],o=window.location,s=o.origin||o.protocol+"//"+o.host,a=document.getElementsByTagName("base");return a.length&&(t=a[0].href),n.protocol?n.origin+n.path:!r&&i?(t||s)+n.path:r||i?void 0:EPUBJS.core.resolveUrl(t||o.pathname,n.path)},EPUBJS.Book.prototype.unarchive=function(e){return this.zip=new EPUBJS.Unarchiver,this.store=this.zip,this.zip.open(e)},EPUBJS.Book.prototype.isContained=function(e){if(e instanceof ArrayBuffer)return!0;var t=EPUBJS.core.uri(e);return!t.extension||"epub"!=t.extension&&"zip"!=t.extension?!1:!0},EPUBJS.Book.prototype.isSaved=function(e){var t;return localStorage?(t=localStorage.getItem(e),localStorage&&null!==t?!0:!1):!1},EPUBJS.Book.prototype.generateBookKey=function(e){return"epubjs:"+EPUBJS.VERSION+":"+window.location.host+":"+e},EPUBJS.Book.prototype.saveContents=function(){return localStorage?void localStorage.setItem(this.settings.bookKey,JSON.stringify(this.contents)):!1},EPUBJS.Book.prototype.removeSavedContents=function(){return localStorage?void localStorage.removeItem(this.settings.bookKey):!1},EPUBJS.Book.prototype.renderTo=function(e){var t,n=this;if(EPUBJS.core.isElement(e))this.element=e;else{if("string"!=typeof e)return void console.error("Not an Element");this.element=EPUBJS.core.getEl(e)}return t=this.opened.then(function(){return n.renderer.initialize(n.element,n.settings.width,n.settings.height),n.metadata.direction&&n.renderer.setDirection(n.metadata.direction),n._rendered(),n.startDisplay()})},EPUBJS.Book.prototype.startDisplay=function(){var e;return e=this.settings["goto"]?this["goto"](this.settings["goto"]):this.settings.previousLocationCfi?this.gotoCfi(this.settings.previousLocationCfi):this.displayChapter(this.spinePos)},EPUBJS.Book.prototype.restore=function(e){var t,n=this,r=["manifest","spine","metadata","cover","toc","spineNodeIndex","spineIndexByURL","globalLayoutProperties"],i=!1,o=this.generateBookKey(e),s=localStorage.getItem(o),a=r.length;if(this.settings.clearSaved&&(i=!0),!i&&"undefined"!=s&&null!==s)for(n.contents=JSON.parse(s),t=0;a>t;t++){var u=r[t];if(!n.contents[u]){i=!0;break}n[u]=n.contents[u]}return!i&&s&&this.contents&&this.settings.contentsPath?(this.settings.bookKey=o,this.ready.manifest.resolve(this.manifest),this.ready.spine.resolve(this.spine),this.ready.metadata.resolve(this.metadata),this.ready.cover.resolve(this.cover),this.ready.toc.resolve(this.toc),!0):!1},EPUBJS.Book.prototype.displayChapter=function(e,t,n){var r,i,o,s,a=this,u=n||new RSVP.defer;return this.isRendered?this._rendering||this._rendering?(this._displayQ.enqueue("displayChapter",[e,t,u]),u.promise):(EPUBJS.core.isNumber(e)?o=e:(i=new EPUBJS.EpubCFI(e),
o=i.spinePos),(0>o||o>=this.spine.length)&&(console.warn("Not A Valid Location"),o=0,t=!1,i=!1),s=new EPUBJS.Chapter(this.spine[o],this.store),this._rendering=!0,this._needsAssetReplacement()&&s.registerHook("beforeChapterRender",[EPUBJS.replace.head,EPUBJS.replace.resources,EPUBJS.replace.svg],!0),a.currentChapter=s,r=a.renderer.displayChapter(s,this.globalLayoutProperties),i?a.renderer.gotoCfi(i):t&&a.renderer.lastPage(),r.then(function(e){a.spinePos=o,u.resolve(a.renderer),a.settings.fromStorage===!1&&a.settings.contained===!1&&a.preloadNextChapter(),a._rendering=!1,a._displayQ.dequeue(),0===a._displayQ.length()&&a._gotoQ.dequeue()},function(e){console.error("Could not load Chapter: "+s.absolute,e),a.trigger("book:chapterLoadFailed",s.absolute),a._rendering=!1,u.reject(e)}),u.promise):(this._q.enqueue("displayChapter",arguments),u.reject({message:"Rendering",stack:(new Error).stack}),u.promise)},EPUBJS.Book.prototype.nextPage=function(){var e;return this.isRendered?(e=this.renderer.nextPage(),e?void 0:this.nextChapter()):this._q.enqueue("nextPage",arguments)},EPUBJS.Book.prototype.prevPage=function(){var e;return this.isRendered?(e=this.renderer.prevPage(),e?void 0:this.prevChapter()):this._q.enqueue("prevPage",arguments)},EPUBJS.Book.prototype.nextChapter=function(){var e;if(this.spinePos<this.spine.length-1){for(e=this.spinePos+1;this.spine[e]&&this.spine[e].linear&&"no"==this.spine[e].linear;)e++;if(e<this.spine.length)return this.displayChapter(e);this.trigger("book:atEnd")}else this.trigger("book:atEnd")},EPUBJS.Book.prototype.prevChapter=function(){var e;if(this.spinePos>0){for(e=this.spinePos-1;this.spine[e]&&this.spine[e].linear&&"no"==this.spine[e].linear;)e--;if(e>=0)return this.displayChapter(e,!0);this.trigger("book:atStart")}else this.trigger("book:atStart")},EPUBJS.Book.prototype.getCurrentLocationCfi=function(){return this.isRendered?this.renderer.currentLocationCfi:!1},EPUBJS.Book.prototype["goto"]=function(e){return 0===e.indexOf("epubcfi(")?this.gotoCfi(e):e.indexOf("%")===e.length-1?this.gotoPercentage(parseInt(e.substring(0,e.length-1))/100):"number"==typeof e||isNaN(e)===!1?this.gotoPage(e):this.gotoHref(e)},EPUBJS.Book.prototype.gotoCfi=function(e,t){var n,r,i,o=t||new RSVP.defer;return this.isRendered?this._moving||this._rendering?(console.warn("Renderer is moving"),this._gotoQ.enqueue("gotoCfi",[e,o]),!1):(n=new EPUBJS.EpubCFI(e),r=n.spinePos,-1==r?!1:(i=this.spine[r],promise=o.promise,this._moving=!0,this.currentChapter&&this.spinePos===r?(this.renderer.gotoCfi(n),this._moving=!1,o.resolve(this.renderer.currentLocationCfi)):(i&&-1!=r||(r=0,i=this.spine[r]),this.currentChapter=new EPUBJS.Chapter(i,this.store),this.currentChapter&&(this.spinePos=r,render=this.renderer.displayChapter(this.currentChapter,this.globalLayoutProperties),this.renderer.gotoCfi(n),render.then(function(e){this._moving=!1,o.resolve(e.currentLocationCfi)}.bind(this)))),promise.then(function(){this._gotoQ.dequeue()}.bind(this)),promise)):(console.warn("Not yet Rendered"),this.settings.previousLocationCfi=e,!1)},EPUBJS.Book.prototype.gotoHref=function(e,t){var n,r,i,o,s,a=t||new RSVP.defer;return this.isRendered?this._moving||this._rendering?(this._gotoQ.enqueue("gotoHref",[e,a]),!1):(n=e.split("#"),r=n[0],i=n[1]||!1,o=r.replace(this.settings.contentsPath,""),s=this.spineIndexByURL[o],r||(s=this.currentChapter?this.currentChapter.spinePos:0),"number"!=typeof s?!1:this.currentChapter&&s==this.currentChapter.spinePos?(i?this.renderer.section(i):this.renderer.firstPage(),a.resolve(this.renderer.currentLocationCfi),a.promise.then(function(){this._gotoQ.dequeue()}.bind(this)),a.promise):this.displayChapter(s).then(function(){i&&this.renderer.section(i),a.resolve(this.renderer.currentLocationCfi)}.bind(this))):(this.settings["goto"]=e,!1)},EPUBJS.Book.prototype.gotoPage=function(e){var t=this.pagination.cfiFromPage(e);return this.gotoCfi(t)},EPUBJS.Book.prototype.gotoPercentage=function(e){var t=this.pagination.pageFromPercentage(e);return this.gotoPage(t)},EPUBJS.Book.prototype.preloadNextChapter=function(){var e,t=this.spinePos+1;return t>=this.spine.length?!1:(e=new EPUBJS.Chapter(this.spine[t]),void(e&&EPUBJS.core.request(e.absolute)))},EPUBJS.Book.prototype.storeOffline=function(){var e=this,t=EPUBJS.core.values(this.manifest);return this.store.put(t).then(function(){e.settings.stored=!0,e.trigger("book:stored")})},EPUBJS.Book.prototype.availableOffline=function(){return this.settings.stored>0?!0:!1},EPUBJS.Book.prototype.toStorage=function(){var e=this.settings.bookKey;this.store.isStored(e).then(function(t){return t===!0?(this.settings.stored=!0,!0):this.storeOffline().then(function(){this.store.token(e,!0)}.bind(this))}.bind(this))},EPUBJS.Book.prototype.fromStorage=function(e){[EPUBJS.replace.head,EPUBJS.replace.resources,EPUBJS.replace.svg];this.contained||this.settings.contained||(this.online&&this.opened.then(this.toStorage.bind(this)),this.store&&this.settings.fromStorage&&e===!1?(this.settings.fromStorage=!1,this.store.off("offline"),this.store=!1):this.settings.fromStorage||(this.store=new EPUBJS.Storage(this.settings.credentials),this.store.on("offline",function(e){e?(this.offline=!0,this.settings.fromStorage=!0,this.trigger("book:offline")):(this.offline=!1,this.settings.fromStorage=!1,this.trigger("book:online"))}.bind(this))))},EPUBJS.Book.prototype.setStyle=function(e,t,n){var r=["color","background","background-color"];return this.isRendered?(this.settings.styles[e]=t,this.renderer.setStyle(e,t,n),void(-1===r.indexOf(e)&&this.renderer.reformat())):this._q.enqueue("setStyle",arguments)},EPUBJS.Book.prototype.removeStyle=function(e){return this.isRendered?(this.renderer.removeStyle(e),this.renderer.reformat(),void delete this.settings.styles[e]):this._q.enqueue("removeStyle",arguments)},EPUBJS.Book.prototype.addHeadTag=function(e,t){return this.isRendered?void(this.settings.headTags[e]=t):this._q.enqueue("addHeadTag",arguments)},EPUBJS.Book.prototype.useSpreads=function(e){console.warn("useSpreads is deprecated, use forceSingle or set a layoutOveride instead"),e===!1?this.forceSingle(!0):this.forceSingle(!1)},EPUBJS.Book.prototype.forceSingle=function(e){var t="undefined"==typeof e?!0:e;this.renderer.forceSingle(t),this.settings.forceSingle=t,this.isRendered&&this.renderer.reformat()},EPUBJS.Book.prototype.setMinSpreadWidth=function(e){this.settings.minSpreadWidth=e,this.isRendered&&(this.renderer.setMinSpreadWidth(this.settings.minSpreadWidth),this.renderer.reformat())},EPUBJS.Book.prototype.setGap=function(e){this.settings.gap=e,this.isRendered&&(this.renderer.setGap(this.settings.gap),this.renderer.reformat())},EPUBJS.Book.prototype.chapter=function(e){var t,n,r=this.spineIndexByURL[e];return r&&(t=this.spine[r],n=new EPUBJS.Chapter(t,this.store,this.settings.withCredentials),n.load()),n},EPUBJS.Book.prototype.unload=function(){this.settings.restore&&localStorage&&this.saveContents(),this.unlistenToRenderer(this.renderer),this.trigger("book:unload")},EPUBJS.Book.prototype.destroy=function(){window.removeEventListener("beforeunload",this.unload),this.currentChapter&&this.currentChapter.unload(),this.unload(),this.renderer&&this.renderer.remove()},EPUBJS.Book.prototype._ready=function(){this.trigger("book:ready")},EPUBJS.Book.prototype._rendered=function(e){this.isRendered=!0,this.trigger("book:rendered"),this._q.flush()},EPUBJS.Book.prototype.applyStyles=function(e,t){e.applyStyles(this.settings.styles),t()},EPUBJS.Book.prototype.applyHeadTags=function(e,t){e.applyHeadTags(this.settings.headTags),t()},EPUBJS.Book.prototype._registerReplacements=function(e){e.registerHook("beforeChapterDisplay",this.applyStyles.bind(this,e),!0),e.registerHook("beforeChapterDisplay",this.applyHeadTags.bind(this,e),!0),e.registerHook("beforeChapterDisplay",EPUBJS.replace.hrefs.bind(this),!0)},EPUBJS.Book.prototype._needsAssetReplacement=function(){return this.settings.fromStorage?!0:this.settings.contained?!0:!1},EPUBJS.Book.prototype.parseLayoutProperties=function(e){var t=this.settings.layoutOveride&&this.settings.layoutOveride.layout||e.layout||"reflowable",n=this.settings.layoutOveride&&this.settings.layoutOveride.spread||e.spread||"auto",r=this.settings.layoutOveride&&this.settings.layoutOveride.orientation||e.orientation||"auto";return{layout:t,spread:n,orientation:r}},RSVP.EventTarget.mixin(EPUBJS.Book.prototype),RSVP.on("error",function(e){}),RSVP.configure("instrument",!1),EPUBJS.Chapter=function(e,t,n){this.href=e.href,this.absolute=e.url,this.id=e.id,this.spinePos=e.index,this.cfiBase=e.cfiBase,this.properties=e.properties,this.manifestProperties=e.manifestProperties,this.linear=e.linear,this.pages=1,this.store=t,this.credentials=n,this.epubcfi=new EPUBJS.EpubCFI,this.deferred=new RSVP.defer,this.loaded=this.deferred.promise,EPUBJS.Hooks.mixin(this),this.getHooks("beforeChapterRender"),this.caches={}},EPUBJS.Chapter.prototype.load=function(e,t){var n,r=e||this.store,i=t||this.credentials;return n=r?r.getXml(this.absolute):EPUBJS.core.request(this.absolute,!1,i),n.then(function(e){this.setDocument(e),this.deferred.resolve(this)}.bind(this)),n},EPUBJS.Chapter.prototype.render=function(e){return this.load().then(function(e){var t=e.querySelector("head"),n=e.createElement("base");return n.setAttribute("href",this.absolute),t.insertBefore(n,t.firstChild),this.contents=e,new RSVP.Promise(function(t,n){this.triggerHooks("beforeChapterRender",function(){t(e)}.bind(this),this)}.bind(this))}.bind(this)).then(function(e){var t=new XMLSerializer,n=t.serializeToString(e);return n=n.replace(/<(?!br)([^ >]+)( )?([^<]*) ?\/>/g,"<$1$2$3> </$1>")}.bind(this))},EPUBJS.Chapter.prototype.url=function(e){var t,n=new RSVP.defer,r=e||this.store,i=this;return r?this.tempUrl?(t=this.tempUrl,n.resolve(t)):r.getUrl(this.absolute).then(function(e){i.tempUrl=e,n.resolve(e)}):(t=this.absolute,n.resolve(t)),n.promise},EPUBJS.Chapter.prototype.setPages=function(e){this.pages=e},EPUBJS.Chapter.prototype.getPages=function(e){return this.pages},EPUBJS.Chapter.prototype.getID=function(){return this.ID},EPUBJS.Chapter.prototype.unload=function(e){this.document=null,this.tempUrl&&e&&(e.revokeUrl(this.tempUrl),this.tempUrl=!1)},EPUBJS.Chapter.prototype.setDocument=function(e){var t=e.namespaceURI;e.doctype;this.document=e.implementation.createDocument(t,null,null),this.contents=this.document.importNode(e.documentElement,!0),this.document.appendChild(this.contents),!this.document.evaluate&&document.evaluate&&(this.document.evaluate=document.evaluate)},EPUBJS.Chapter.prototype.cfiFromRange=function(e){var t,n,r,i,o,s;if(this.document){if("undefined"!=typeof document.evaluate){if(n=EPUBJS.core.getElementXPath(e.startContainer),r=EPUBJS.core.getElementXPath(e.endContainer),i=this.document.evaluate(n,this.document,EPUBJS.core.nsResolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue,e.collapsed||(o=this.document.evaluate(r,this.document,EPUBJS.core.nsResolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue),t=this.document.createRange(),i)try{t.setStart(i,e.startOffset),!e.collapsed&&o&&t.setEnd(o,e.endOffset)}catch(a){console.log("missed"),i=!1}i||(console.log("not found, try fuzzy match"),cleanStartTextContent=EPUBJS.core.cleanStringForXpath(e.startContainer.textContent),n="//text()[contains(.,"+cleanStartTextContent+")]",i=this.document.evaluate(n,this.document,EPUBJS.core.nsResolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue,i&&(t.setStart(i,e.startOffset),e.collapsed||(s=EPUBJS.core.cleanStringForXpath(e.endContainer.textContent),r="//text()[contains(.,"+s+")]",o=this.document.evaluate(r,this.document,EPUBJS.core.nsResolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue,o&&t.setEnd(o,e.endOffset))))}else t=e;return this.epubcfi.generateCfiFromRange(t,this.cfiBase)}},EPUBJS.Chapter.prototype.find=function(e){var t=this,n=[],r=e.toLowerCase(),i=function(e){for(var i,o,s,a=e.textContent.toLowerCase(),u=t.document.createRange(),h=-1,c=150;-1!=o;)o=a.indexOf(r,h+1),-1!=o&&(u=t.document.createRange(),u.setStart(e,o),u.setEnd(e,o+r.length),i=t.cfiFromRange(u),e.textContent.length<c?s=e.textContent:(s=e.textContent.substring(o-c/2,o+c/2),s="..."+s+"..."),n.push({cfi:i,excerpt:s})),h=o};return this.textSprint(this.document,function(e){i(e)}),n},EPUBJS.Chapter.prototype.textSprint=function(e,t){for(var n,r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:function(e){return e.data&&!/^\s*$/.test(e.data)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},!1);n=r.nextNode();)t(n)},EPUBJS.Chapter.prototype.replace=function(e,t,n,r){var i=this.contents.querySelectorAll(e),o=Array.prototype.slice.call(i),s=o.length;return 0===s?void n(!1):void o.forEach(function(e){var i=!1,o=function(e,t){i===!1&&(s--,r&&r(e,t,s),0>=s&&n&&n(!0),i=!0)};t(e,o)}.bind(this))},EPUBJS.Chapter.prototype.replaceWithStored=function(e,t,n,r){var i,o={},s=this.store,a=this.caches[e],u=EPUBJS.core.uri(this.absolute),h=u.base,c=t,l=5,d=function(e,t,n){o[t]=e},f=function(e){r&&r(),EPUBJS.core.values(i).forEach(function(e){s.revokeUrl(e)}),a=o};s&&(a||(a={}),i=EPUBJS.core.clone(a),this.replace(e,function(t,r){var a=t.getAttribute(c),u=EPUBJS.core.resolveUrl(h,a),d=function(n){var i;t.onload=function(){clearTimeout(i),r(n,u)},t.onerror=function(e){clearTimeout(i),r(n,u),console.error(e)},"svg image"==e&&t.setAttribute("externalResourcesRequired","true"),"link[href]"==e&&"stylesheet"!==t.getAttribute("rel")?r(n,u):i=setTimeout(function(){r(n,u)},l),n&&t.setAttribute(c,n)};u in i?(d(i[u]),o[u]=i[u],delete i[u]):n(s,u,d,t)},f,d))};var EPUBJS=EPUBJS||{};EPUBJS.core={},EPUBJS.core.getEl=function(e){return document.getElementById(e)},EPUBJS.core.getEls=function(e){return document.getElementsByClassName(e)},EPUBJS.core.request=function(e,t,n){var r,i=window.URL,o=i?"blob":"arraybuffer",s=new RSVP.defer,a=new XMLHttpRequest,u=XMLHttpRequest.prototype,h=function(){var e;this.readyState==this.DONE&&(200===this.status||0===this.status&&this.response?(e="xml"==t?this.responseXML?this.responseXML:(new DOMParser).parseFromString(this.response,"application/xml"):"xhtml"==t?this.responseXML?this.responseXML:(new DOMParser).parseFromString(this.response,"application/xhtml+xml"):"html"==t?this.responseXML?this.responseXML:(new DOMParser).parseFromString(this.response,"text/html"):"json"==t?JSON.parse(this.response):"blob"==t?i?this.response:new Blob([this.response]):this.response,s.resolve(e)):s.reject({message:this.response,stack:(new Error).stack}))};return"overrideMimeType"in u||Object.defineProperty(u,"overrideMimeType",{value:function(e){}}),a.open("GET",e,!0),a.onreadystatechange=h,n&&(a.withCredentials=!0),t||(r=EPUBJS.core.uri(e),t=r.extension),"blob"==t&&(a.responseType=o),"json"==t&&a.setRequestHeader("Accept","application/json"),"xml"==t&&(a.responseType="document",a.overrideMimeType("text/xml")),"xhtml"==t&&(a.responseType="document"),"html"==t&&(a.responseType="document"),"binary"==t&&(a.responseType="arraybuffer"),a.send(),s.promise},EPUBJS.core.toArray=function(e){var t=[];for(var n in e){var r;e.hasOwnProperty(n)&&(r=e[n],r.ident=n,t.push(r))}return t},EPUBJS.core.uri=function(e){var t,n,r,i={protocol:"",host:"",path:"",origin:"",directory:"",base:"",filename:"",extension:"",fragment:"",href:e},o=e.indexOf("blob:"),s=e.indexOf("://"),a=e.indexOf("?"),u=e.indexOf("#");return 0===o?(i.protocol="blob",i.base=e.indexOf(0,u),i):(-1!=u&&(i.fragment=e.slice(u+1),e=e.slice(0,u)),-1!=a&&(i.search=e.slice(a+1),e=e.slice(0,a),href=e),-1!=s?(i.protocol=e.slice(0,s),t=e.slice(s+3),r=t.indexOf("/"),-1===r?(i.host=i.path,i.path=""):(i.host=t.slice(0,r),i.path=t.slice(r)),i.origin=i.protocol+"://"+i.host,i.directory=EPUBJS.core.folder(i.path),i.base=i.origin+i.directory):(i.path=e,i.directory=EPUBJS.core.folder(e),i.base=i.directory),i.filename=e.replace(i.base,""),n=i.filename.lastIndexOf("."),-1!=n&&(i.extension=i.filename.slice(n+1)),i)},EPUBJS.core.folder=function(e){var t=e.lastIndexOf("/");if(-1==t)var n="";return n=e.slice(0,t+1)},EPUBJS.core.dataURLToBlob=function(e){var t,n,r,i,o,s=";base64,";if(-1==e.indexOf(s))return t=e.split(","),n=t[0].split(":")[1],r=t[1],new Blob([r],{type:n});t=e.split(s),n=t[0].split(":")[1],r=window.atob(t[1]),i=r.length,o=new Uint8Array(i);for(var a=0;i>a;++a)o[a]=r.charCodeAt(a);return new Blob([o],{type:n})},EPUBJS.core.addScript=function(e,t,n){var r,i;i=!1,r=document.createElement("script"),r.type="text/javascript",r.async=!1,r.src=e,r.onload=r.onreadystatechange=function(){i||this.readyState&&"complete"!=this.readyState||(i=!0,t&&t())},n=n||document.body,n.appendChild(r)},EPUBJS.core.addScripts=function(e,t,n){var r=e.length,i=0,o=function(){i++,r==i?t&&t():EPUBJS.core.addScript(e[i],o,n)};EPUBJS.core.addScript(e[i],o,n)},EPUBJS.core.addCss=function(e,t,n){var r,i;i=!1,r=document.createElement("link"),r.type="text/css",r.rel="stylesheet",r.href=e,r.onload=r.onreadystatechange=function(){i||this.readyState&&"complete"!=this.readyState||(i=!0,t&&t())},n=n||document.body,n.appendChild(r)},EPUBJS.core.prefixed=function(e){var t=["Webkit","Moz","O","ms"],n=e[0].toUpperCase()+e.slice(1),r=t.length;if("undefined"!=typeof document.documentElement.style[e])return e;for(var i=0;r>i;i++)if("undefined"!=typeof document.documentElement.style[t[i]+n])return t[i]+n;return e},EPUBJS.core.resolveUrl=function(e,t){var n,r,i=[],o=EPUBJS.core.uri(t),s=e.split("/");return o.host?t:(s.pop(),r=t.split("/"),r.forEach(function(e){".."===e?s.pop():i.push(e)}),n=s.concat(i),n.join("/"))},EPUBJS.core.uuid=function(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:7&n|8).toString(16)});return t},EPUBJS.core.insert=function(e,t,n){var r=EPUBJS.core.locationOf(e,t,n);return t.splice(r,0,e),r},EPUBJS.core.locationOf=function(e,t,n,r,i){var o,s=r||0,a=i||t.length,u=parseInt(s+(a-s)/2);return n||(n=function(e,t){return e>t?1:t>e?-1:(e=t)?0:void 0}),0>=a-s?u:(o=n(t[u],e),a-s===1?o>0?u:u+1:0===o?u:-1===o?EPUBJS.core.locationOf(e,t,n,u,a):EPUBJS.core.locationOf(e,t,n,s,u))},EPUBJS.core.indexOfSorted=function(e,t,n,r,i){var o,s=r||0,a=i||t.length,u=parseInt(s+(a-s)/2);return n||(n=function(e,t){return e>t?1:t>e?-1:(e=t)?0:void 0}),0>=a-s?-1:(o=n(t[u],e),a-s===1?0===o?u:-1:0===o?u:-1===o?EPUBJS.core.indexOfSorted(e,t,n,u,a):EPUBJS.core.indexOfSorted(e,t,n,s,u))},EPUBJS.core.queue=function(e){var t=[],n=e,r=function(e,n,r){return t.push({funcName:e,args:n,context:r}),t},i=function(){var e;t.length&&(e=t.shift(),n[e.funcName].apply(e.context||n,e.args))},o=function(){for(;t.length;)i()},s=function(){t=[]},a=function(){return t.length};return{enqueue:r,dequeue:i,flush:o,clear:s,length:a}},EPUBJS.core.getElementXPath=function(e){return e&&e.id?'//*[@id="'+e.id+'"]':EPUBJS.core.getElementTreeXPath(e)},EPUBJS.core.getElementTreeXPath=function(e){var t,n,r,i,o=[],s="http://www.w3.org/1999/xhtml"===e.ownerDocument.documentElement.getAttribute("xmlns");for(e.nodeType===Node.TEXT_NODE&&(t=EPUBJS.core.indexOfTextNode(e)+1,o.push("text()["+t+"]"),e=e.parentNode);e&&1==e.nodeType;e=e.parentNode){t=0;for(var a=e.previousSibling;a;a=a.previousSibling)a.nodeType!=Node.DOCUMENT_TYPE_NODE&&a.nodeName==e.nodeName&&++t;n=e.nodeName.toLowerCase(),r=s?"xhtml:"+n:n,i=t?"["+(t+1)+"]":"",o.splice(0,0,r+i)}return o.length?"./"+o.join("/"):null},EPUBJS.core.nsResolver=function(e){var t={xhtml:"http://www.w3.org/1999/xhtml",epub:"http://www.idpf.org/2007/ops"};return t[e]||null},EPUBJS.core.cleanStringForXpath=function(e){var t=e.match(/[^'"]+|['"]/g);return t=t.map(function(e){return"'"===e?'"\'"':'"'===e?"'\"'":"'"+e+"'"}),"concat('',"+t.join(",")+")"},EPUBJS.core.indexOfTextNode=function(e){for(var t,n=e.parentNode,r=n.childNodes,i=-1,o=0;o<r.length&&(t=r[o],t.nodeType===Node.TEXT_NODE&&i++,t!=e);o++);return i},EPUBJS.core.defaults=function(e){for(var t=1,n=arguments.length;n>t;t++){var r=arguments[t];for(var i in r)void 0===e[i]&&(e[i]=r[i])}return e},EPUBJS.core.extend=function(e){var t=[].slice.call(arguments,1);return t.forEach(function(t){t&&Object.getOwnPropertyNames(t).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}),e},EPUBJS.core.clone=function(e){return EPUBJS.core.isArray(e)?e.slice():EPUBJS.core.extend({},e)},EPUBJS.core.isElement=function(e){return!(!e||1!=e.nodeType)},EPUBJS.core.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},EPUBJS.core.isString=function(e){return"string"==typeof e||e instanceof String},EPUBJS.core.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},EPUBJS.core.values=function(e){var t,n,r,i=-1;if(!e)return[];for(t=Object.keys(e),n=t.length,r=Array(n);++i<n;)r[i]=e[t[i]];return r},EPUBJS.EpubCFI=function(e){return e?this.parse(e):void 0},EPUBJS.EpubCFI.prototype.generateChapterComponent=function(e,t,n){var r=parseInt(t),i=e+1,o="/"+i+"/";return o+=2*(r+1),n&&(o+="["+n+"]"),o},EPUBJS.EpubCFI.prototype.generatePathComponent=function(e){var t=[];return e.forEach(function(e){var n="";n+=2*(e.index+1),e.id&&(n+="["+e.id+"]"),t.push(n)}),t.join("/")},EPUBJS.EpubCFI.prototype.generateCfiFromElement=function(e,t){var n=this.pathTo(e),r=this.generatePathComponent(n);return r.length?"epubcfi("+t+"!"+r+"/1:0)":"epubcfi("+t+"!/4/)"},EPUBJS.EpubCFI.prototype.pathTo=function(e){for(var t,n=[];e&&null!==e.parentNode&&9!=e.parentNode.nodeType;)t=e.parentNode.children,n.unshift({id:e.id,tagName:e.tagName,index:t?Array.prototype.indexOf.call(t,e):0}),e=e.parentNode;return n},EPUBJS.EpubCFI.prototype.getChapterComponent=function(e){var t=e.split("!");return t[0]},EPUBJS.EpubCFI.prototype.getPathComponent=function(e){var t=e.split("!"),n=t[1]?t[1].split(":"):"";return n[0]},EPUBJS.EpubCFI.prototype.getCharecterOffsetComponent=function(e){var t=e.split(":");return t[1]||""},EPUBJS.EpubCFI.prototype.parse=function(e){var t,n,r,i,o,s,a,u,h,c={},l=function(e){var t,n,r,i;return t="element",n=parseInt(e)/2-1,r=e.match(/\[(.*)\]/),r&&r[1]&&(i=r[1]),{type:t,index:n,id:i||!1}};return"string"!=typeof e?{spinePos:-1}:(c.str=e,0===e.indexOf("epubcfi(")&&")"===e[e.length-1]&&(e=e.slice(8,e.length-1)),n=this.getChapterComponent(e),r=this.getPathComponent(e)||"",i=this.getCharecterOffsetComponent(e),n&&(t=n.split("/")[2]||"")?(c.spinePos=parseInt(t)/2-1||0,s=t.match(/\[(.*)\]/),c.spineId=s?s[1]:!1,-1!=r.indexOf(",")&&console.warn("CFI Ranges are not supported"),a=r.split("/"),u=a.pop(),c.steps=[],a.forEach(function(e){var t;e&&(t=l(e),c.steps.push(t))}),h=parseInt(u),isNaN(h)||(h%2===0?c.steps.push(l(u)):c.steps.push({type:"text",index:(h-1)/2})),o=i.match(/\[(.*)\]/),o&&o[1]?(c.characterOffset=parseInt(i.split("[")[0]),c.textLocationAssertion=o[1]):c.characterOffset=parseInt(i),c):{spinePos:-1})},EPUBJS.EpubCFI.prototype.addMarker=function(e,t,n){var r,i,o,s,a=t||document,u=n||this.createMarker(a);return"string"==typeof e&&(e=this.parse(e)),i=e.steps[e.steps.length-1],-1===e.spinePos?!1:(r=this.findParent(e,a))?(i&&"text"===i.type?(o=r.childNodes[i.index],e.characterOffset?(s=o.splitText(e.characterOffset),u.classList.add("EPUBJS-CFI-SPLIT"),r.insertBefore(u,s)):r.insertBefore(u,o)):r.insertBefore(u,r.firstChild),u):!1},EPUBJS.EpubCFI.prototype.createMarker=function(e){var t=e||document,n=t.createElement("span");return n.id="EPUBJS-CFI-MARKER:"+EPUBJS.core.uuid(),n.classList.add("EPUBJS-CFI-MARKER"),n},EPUBJS.EpubCFI.prototype.removeMarker=function(e,t){t||document;e.classList.contains("EPUBJS-CFI-SPLIT")?(nextSib=e.nextSibling,prevSib=e.previousSibling,nextSib&&prevSib&&3===nextSib.nodeType&&3===prevSib.nodeType&&(prevSib.textContent+=nextSib.textContent,e.parentNode.removeChild(nextSib)),e.parentNode.removeChild(e)):e.classList.contains("EPUBJS-CFI-MARKER")&&e.parentNode.removeChild(e)},EPUBJS.EpubCFI.prototype.findParent=function(e,t){var n,r,i,o=t||document,s=o.getElementsByTagName("html")[0],a=Array.prototype.slice.call(s.children);if("string"==typeof e&&(e=this.parse(e)),r=e.steps.slice(0),!r.length)return o.getElementsByTagName("body")[0];for(;r&&r.length>0;){if(n=r.shift(),"text"===n.type?(i=s.childNodes[n.index],s=i.parentNode||s):s=n.id?o.getElementById(n.id):a[n.index],"undefined"==typeof s)return console.error("No Element For",n,e.str),!1;a=Array.prototype.slice.call(s.children)}return s},EPUBJS.EpubCFI.prototype.compare=function(e,t){if("string"==typeof e&&(e=new EPUBJS.EpubCFI(e)),"string"==typeof t&&(t=new EPUBJS.EpubCFI(t)),e.spinePos>t.spinePos)return 1;if(e.spinePos<t.spinePos)return-1;for(var n=0;n<e.steps.length;n++){if(!t.steps[n])return 1;if(e.steps[n].index>t.steps[n].index)return 1;if(e.steps[n].index<t.steps[n].index)return-1}return e.steps.length<t.steps.length?-1:e.characterOffset>t.characterOffset?1:e.characterOffset<t.characterOffset?-1:0},EPUBJS.EpubCFI.prototype.generateCfiFromHref=function(e,t){var n,r,i=EPUBJS.core.uri(e),o=i.path,s=i.fragment,a=t.spineIndexByURL[o],u=new RSVP.defer,h=new EPUBJS.EpubCFI;return"undefined"!=typeof a&&(r=t.spine[a],n=t.loadXml(r.url),n.then(function(e){var t,n=e.getElementById(s);t=h.generateCfiFromElement(n,r.cfiBase),u.resolve(t)})),u.promise},EPUBJS.EpubCFI.prototype.generateCfiFromTextNode=function(e,t,n){var r=e.parentNode,i=this.pathTo(r),o=this.generatePathComponent(i),s=1+2*Array.prototype.indexOf.call(r.childNodes,e);return"epubcfi("+n+"!"+o+"/"+s+":"+(t||0)+")"},EPUBJS.EpubCFI.prototype.generateCfiFromRangeAnchor=function(e,t){var n=e.anchorNode,r=e.anchorOffset;return this.generateCfiFromTextNode(n,r,t)},EPUBJS.EpubCFI.prototype.generateCfiFromRange=function(e,t){var n,r,i,o,s,a,u,h,c,l,d,f;if(n=e.startContainer,3===n.nodeType)r=n.parentNode,a=1+2*EPUBJS.core.indexOfTextNode(n),i=this.pathTo(r);else{if(e.collapsed)return this.generateCfiFromElement(n,t);i=this.pathTo(n)}return o=this.generatePathComponent(i),s=e.startOffset,e.collapsed?"epubcfi("+t+"!"+o+"/"+a+":"+s+")":(u=e.endContainer,3===u.nodeType?(h=u.parentNode,f=1+2*EPUBJS.core.indexOfTextNode(u),c=this.pathTo(h)):c=this.pathTo(u),l=this.generatePathComponent(c),d=e.endOffset,l=l.replace(o,""),l.length&&(l+="/"),"epubcfi("+t+"!"+o+"/"+a+":"+s+","+l+f+":"+d+")")},EPUBJS.EpubCFI.prototype.generateXpathFromSteps=function(e){var t=[".","*"];return e.forEach(function(e){var n=e.index+1;e.id?t.push("*[position()="+n+" and @id='"+e.id+"']"):"text"===e.type?t.push("text()["+n+"]"):t.push("*["+n+"]")}),t.join("/")},EPUBJS.EpubCFI.prototype.generateQueryFromSteps=function(e){var t=["html"];return e.forEach(function(e){var n=e.index+1;e.id?t.push("#"+e.id):"text"===e.type||t.push("*:nth-child("+n+")")}),t.join(">")},EPUBJS.EpubCFI.prototype.generateRangeFromCfi=function(e,t){var n,r,i,o,s,a,u=t||document,h=u.createRange();return"string"==typeof e&&(e=this.parse(e)),-1===e.spinePos?!1:(n=e.steps[e.steps.length-1],"undefined"!=typeof document.evaluate?(r=this.generateXpathFromSteps(e.steps),i=u.evaluate(r,u,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue):(s=this.generateQueryFromSteps(e.steps),a=u.querySelector(s),a&&"text"==n.type&&(i=a.childNodes[n.index])),i?(i&&e.characterOffset>=0?(o=i.length,e.characterOffset<o?(h.setStart(i,e.characterOffset),h.setEnd(i,o)):(console.debug("offset greater than length:",e.characterOffset,o),h.setStart(i,o-1),h.setEnd(i,o))):i&&h.selectNode(i),h):null)},EPUBJS.EpubCFI.prototype.isCfiString=function(e){return"string"==typeof e&&0===e.indexOf("epubcfi(")?!0:!1},EPUBJS.Events=function(e,t){return this.events={},t?this.el=t:this.el=document.createElement("div"),e.createEvent=this.createEvent,e.tell=this.tell,e.listen=this.listen,e.deafen=this.deafen,e.listenUntil=this.listenUntil,this},EPUBJS.Events.prototype.createEvent=function(e){var t=new CustomEvent(e);return this.events[e]=t,t},EPUBJS.Events.prototype.tell=function(e,t){var n;this.events[e]?n=this.events[e]:(console.warn("No event:",e,"defined yet, creating."),n=this.createEvent(e)),t&&(n.msg=t),this.el.dispatchEvent(n)},EPUBJS.Events.prototype.listen=function(e,t,n){return this.events[e]?void(n?this.el.addEventListener(e,t.bind(n),!1):this.el.addEventListener(e,t,!1)):(console.warn("No event:",e,"defined yet, creating."),void this.createEvent(e))},EPUBJS.Events.prototype.deafen=function(e,t){this.el.removeEventListener(e,t,!1)},EPUBJS.Events.prototype.listenUntil=function(e,t,n,r){function i(){this.deafen(e,n),this.deafen(t,i)}this.listen(e,n,r),this.listen(t,i,this)},EPUBJS.hooks={},EPUBJS.Hooks=function(){function e(){}return e.prototype.getHooks=function(){var e;this.hooks={},Array.prototype.slice.call(arguments).forEach(function(e){this.hooks[e]=[]},this);for(var t in this.hooks)e=EPUBJS.core.values(EPUBJS.hooks[t]),e.forEach(function(e){this.registerHook(t,e)},this)},e.prototype.registerHook=function(e,t,n){"undefined"!=typeof this.hooks[e]?"function"==typeof t?n?this.hooks[e].unshift(t):this.hooks[e].push(t):Array.isArray(t)&&t.forEach(function(t){n?this.hooks[e].unshift(t):this.hooks[e].push(t)},this):(this.hooks[e]=[t],"function"==typeof t?this.hooks[e]=[t]:Array.isArray(t)&&(this.hooks[e]=[],t.forEach(function(t){this.hooks[e].push(t)},this)))},e.prototype.removeHook=function(e,t){var n;"undefined"!=typeof this.hooks[e]&&("function"==typeof t?(n=this.hooks[e].indexOf(t),n>-1&&this.hooks[e].splice(n,1)):Array.isArray(t)&&t.forEach(function(t){n=this.hooks[e].indexOf(t),n>-1&&this.hooks[e].splice(n,1)},this))},e.prototype.triggerHooks=function(e,t,n){function r(){o--,0>=o&&t&&t()}var i,o;return"undefined"==typeof this.hooks[e]?!1:(i=this.hooks[e],o=i.length,0===o&&t&&t(),void i.forEach(function(e){e(r,n)}))},{register:function(e){if(void 0===EPUBJS.hooks[e]&&(EPUBJS.hooks[e]={}),"object"!=typeof EPUBJS.hooks[e])throw"Already registered: "+e;return EPUBJS.hooks[e]},mixin:function(t){for(var n in e.prototype)t[n]=e.prototype[n]}}}(),EPUBJS.Layout=EPUBJS.Layout||{},EPUBJS.Layout.Reflowable=function(){this.documentElement=null,this.spreadWidth=null},EPUBJS.Layout.Reflowable.prototype.format=function(e,t,n,r){var i=EPUBJS.core.prefixed("columnAxis"),o=EPUBJS.core.prefixed("columnGap"),s=EPUBJS.core.prefixed("columnWidth"),a=EPUBJS.core.prefixed("columnFill"),u=Math.floor(t),h=Math.floor(u/8),c=r>=0?r:h%2===0?h:h-1;return this.documentElement=e,this.spreadWidth=u+c,e.style.overflow="hidden",e.style.width=u+"px",e.style.height=n+"px",e.style[i]="horizontal",e.style[a]="auto",e.style[s]=u+"px",e.style[o]=c+"px",this.colWidth=u,this.gap=c,{pageWidth:this.spreadWidth,pageHeight:n}},EPUBJS.Layout.Reflowable.prototype.calculatePages=function(){var e,t;return this.documentElement.style.width="auto",e=this.documentElement.scrollWidth,t=Math.ceil(e/this.spreadWidth),{displayedPages:t,pageCount:t}},EPUBJS.Layout.ReflowableSpreads=function(){this.documentElement=null,this.spreadWidth=null},EPUBJS.Layout.ReflowableSpreads.prototype.format=function(e,t,n,r){var i=EPUBJS.core.prefixed("columnAxis"),o=EPUBJS.core.prefixed("columnGap"),s=EPUBJS.core.prefixed("columnWidth"),a=EPUBJS.core.prefixed("columnFill"),u=2,h=Math.floor(t),c=h%2===0?h:h-1,l=Math.floor(c/8),d=r>=0?r:l%2===0?l:l-1,f=Math.floor((c-d)/u);return this.documentElement=e,this.spreadWidth=(f+d)*u,e.style.overflow="hidden",e.style.width=c+"px",e.style.height=n+"px",e.style[i]="horizontal",e.style[a]="auto",e.style[o]=d+"px",e.style[s]=f+"px",this.colWidth=f,this.gap=d,{pageWidth:this.spreadWidth,pageHeight:n}},EPUBJS.Layout.ReflowableSpreads.prototype.calculatePages=function(){var e=this.documentElement.scrollWidth,t=Math.ceil(e/this.spreadWidth);return this.documentElement.style.width=t*this.spreadWidth-this.gap+"px",{displayedPages:t,pageCount:2*t}},EPUBJS.Layout.Fixed=function(){this.documentElement=null},EPUBJS.Layout.Fixed.prototype.format=function(e,t,n,r){var i,o,s,a,u=EPUBJS.core.prefixed("columnWidth"),h=e.querySelector("[name=viewport]");return this.documentElement=e,h&&h.hasAttribute("content")&&(i=h.getAttribute("content"),o=i.split(","),o[0]&&(s=o[0].replace("width=","")),o[1]&&(a=o[1].replace("height=",""))),e.style.width=s+"px"||"auto",e.style.height=a+"px"||"auto",
e.style[u]="auto",e.style.overflow="auto",this.colWidth=s,this.gap=0,{pageWidth:s,pageHeight:a}},EPUBJS.Layout.Fixed.prototype.calculatePages=function(){return{displayedPages:1,pageCount:1}},EPUBJS.Locations=function(e,t,n){this.spine=e,this.store=t,this.credentials=n,this.epubcfi=new EPUBJS.EpubCFI,this._locations=[],this.total=0,this["break"]=150,this._current=0},EPUBJS.Locations.prototype.generate=function(e){var t,n=new RSVP.defer,r=-1,i=this.spine.length,o=function(e){var t,n=r+1,s=e||new RSVP.defer;return n>=i?s.resolve():(r=n,t=new EPUBJS.Chapter(this.spine[r],this.store,this.credentials),this.process(t).then(function(){setTimeout(function(){o(s)},1)})),s.promise}.bind(this);return"number"==typeof e&&(this["break"]=e),t=o().then(function(){this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),n.resolve(this._locations)}.bind(this)),n.promise},EPUBJS.Locations.prototype.process=function(e){return e.load().then(function(t){var n,r,i=t,o=i.documentElement.querySelector("body"),s=0;this.sprint(o,function(t){var o,a=t.length,u=0;for(0===s&&(n=i.createRange(),n.setStart(t,0)),o=this["break"]-s,o>a&&(s+=a,u=a);a>u;)s=this["break"],u+=this["break"],u>=a?s=a-(u-this["break"]):(n.setEnd(t,u),cfi=e.cfiFromRange(n),this._locations.push(cfi),s=0,u+=1,n=i.createRange(),n.setStart(t,u));r=t}.bind(this)),n&&(n.setEnd(r,r.length),cfi=e.cfiFromRange(n),this._locations.push(cfi),s=0)}.bind(this))},EPUBJS.Locations.prototype.sprint=function(e,t){for(var n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);node=n.nextNode();)t(node)},EPUBJS.Locations.prototype.locationFromCfi=function(e){return 0===this._locations.length?-1:EPUBJS.core.locationOf(e,this._locations,this.epubcfi.compare)},EPUBJS.Locations.prototype.percentageFromCfi=function(e){var t=this.locationFromCfi(e);return this.percentageFromLocation(t)},EPUBJS.Locations.prototype.percentageFromLocation=function(e){return e&&this.total?e/this.total:0},EPUBJS.Locations.prototype.cfiFromLocation=function(e){var t=-1;return"number"!=typeof e&&(e=parseInt(e)),e>=0&&e<this._locations.length&&(t=this._locations[e]),t},EPUBJS.Locations.prototype.cfiFromPercentage=function(e){var t=e>1?e/100:e,n=Math.ceil(this.total*t);return this.cfiFromLocation(n)},EPUBJS.Locations.prototype.load=function(e){return this._locations=JSON.parse(e),this.total=this._locations.length-1,this._locations},EPUBJS.Locations.prototype.save=function(e){return JSON.stringify(this._locations)},EPUBJS.Locations.prototype.getCurrent=function(e){return this._current},EPUBJS.Locations.prototype.setCurrent=function(e){var t;if("string"==typeof e)this._currentCfi=e;else{if("number"!=typeof e)return;this._current=e}0!==this._locations.length&&("string"==typeof e?(t=this.locationFromCfi(e),this._current=t):t=e,this.trigger("changed",{percentage:this.percentageFromLocation(t)}))},Object.defineProperty(EPUBJS.Locations.prototype,"currentLocation",{get:function(){return this._current},set:function(e){this.setCurrent(e)}}),RSVP.EventTarget.mixin(EPUBJS.Locations.prototype),EPUBJS.Pagination=function(e){this.pages=[],this.locations=[],this.epubcfi=new EPUBJS.EpubCFI,e&&e.length&&this.process(e)},EPUBJS.Pagination.prototype.process=function(e){e.forEach(function(e){this.pages.push(e.page),this.locations.push(e.cfi)},this),this.pageList=e,this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage},EPUBJS.Pagination.prototype.pageFromCfi=function(e){var t=-1;if(0===this.locations.length)return-1;var n=EPUBJS.core.indexOfSorted(e,this.locations,this.epubcfi.compare);return-1!=n&&n<this.pages.length-1?t=this.pages[n]:(n=EPUBJS.core.locationOf(e,this.locations,this.epubcfi.compare),t=n-1>=0?this.pages[n-1]:this.pages[0],void 0!==t||(t=-1)),t},EPUBJS.Pagination.prototype.cfiFromPage=function(e){var t=-1;"number"!=typeof e&&(e=parseInt(e));var n=this.pages.indexOf(e);return-1!=n&&(t=this.locations[n]),t},EPUBJS.Pagination.prototype.pageFromPercentage=function(e){var t=Math.round(this.totalPages*e);return t},EPUBJS.Pagination.prototype.percentageFromPage=function(e){var t=(e-this.firstPage)/this.totalPages;return Math.round(1e3*t)/1e3},EPUBJS.Pagination.prototype.percentageFromCfi=function(e){var t=this.pageFromCfi(e),n=this.percentageFromPage(t);return n},EPUBJS.Parser=function(e){this.baseUrl=e||""},EPUBJS.Parser.prototype.container=function(e){var t,n,r,i;return e?(t=e.querySelector("rootfile"))?(n=t.getAttribute("full-path"),r=EPUBJS.core.uri(n).directory,i=e.xmlEncoding,{packagePath:n,basePath:r,encoding:i}):void console.error("No RootFile Found"):void console.error("Container File Not Found")},EPUBJS.Parser.prototype.identifier=function(e){var t;return e?(t=e.querySelector("metadata"),t?this.getElementText(t,"identifier"):void console.error("No Metadata Found")):void console.error("Package File Not Found")},EPUBJS.Parser.prototype.packageContents=function(e,t){var n,r,i,o,s,a,u,h,c,l,d,f=this;return t&&(this.baseUrl=t),e?(n=e.querySelector("metadata"))?(r=e.querySelector("manifest"))?(i=e.querySelector("spine"))?(o=f.manifest(r),s=f.findNavPath(r),a=f.findTocPath(r,i),u=f.findCoverPath(e),h=Array.prototype.indexOf.call(i.parentNode.childNodes,i),c=f.spine(i,o),l={},c.forEach(function(e){l[e.href]=e.index}),d=f.metadata(n),d.direction=i.getAttribute("page-progression-direction"),{metadata:d,spine:c,manifest:o,navPath:s,tocPath:a,coverPath:u,spineNodeIndex:h,spineIndexByURL:l}):void console.error("No Spine Found"):void console.error("No Manifest Found"):void console.error("No Metadata Found"):void console.error("Package File Not Found")},EPUBJS.Parser.prototype.findNavPath=function(e){var t=e.querySelector("item[properties$='nav'], item[properties^='nav '], item[properties*=' nav ']");return t?t.getAttribute("href"):!1},EPUBJS.Parser.prototype.findTocPath=function(e,t){var n,r=e.querySelector("item[media-type='application/x-dtbncx+xml']");return r||(n=t.getAttribute("toc"),n&&(r=e.querySelector("item[id='"+n+"']"))),r?r.getAttribute("href"):!1},EPUBJS.Parser.prototype.metadata=function(e){var t={},n=this;return t.bookTitle=n.getElementText(e,"title"),t.creator=n.getElementText(e,"creator"),t.description=n.getElementText(e,"description"),t.pubdate=n.getElementText(e,"date"),t.publisher=n.getElementText(e,"publisher"),t.identifier=n.getElementText(e,"identifier"),t.language=n.getElementText(e,"language"),t.rights=n.getElementText(e,"rights"),t.modified_date=n.querySelectorText(e,"meta[property='dcterms:modified']"),t.layout=n.querySelectorText(e,"meta[property='rendition:layout']"),t.orientation=n.querySelectorText(e,"meta[property='rendition:orientation']"),t.spread=n.querySelectorText(e,"meta[property='rendition:spread']"),t},EPUBJS.Parser.prototype.findCoverPath=function(e){var t=e.querySelector("package").getAttribute("version");if("2.0"===t){var n=e.querySelector('meta[name="cover"]');if(n){var r=n.getAttribute("content"),i=e.querySelector("item[id='"+r+"']");return i?i.getAttribute("href"):!1}return!1}var o=e.querySelector("item[properties='cover-image']");return o?o.getAttribute("href"):!1},EPUBJS.Parser.prototype.getElementText=function(e,t){var n,r=e.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",t);return r&&0!==r.length?(n=r[0],n.childNodes.length?n.childNodes[0].nodeValue:""):""},EPUBJS.Parser.prototype.querySelectorText=function(e,t){var n=e.querySelector(t);return n&&n.childNodes.length?n.childNodes[0].nodeValue:""},EPUBJS.Parser.prototype.manifest=function(e){var t=this.baseUrl,n={},r=e.querySelectorAll("item"),i=Array.prototype.slice.call(r);return i.forEach(function(e){var r=e.getAttribute("id"),i=e.getAttribute("href")||"",o=e.getAttribute("media-type")||"",s=e.getAttribute("properties")||"";n[r]={href:i,url:t+i,type:o,properties:s}}),n},EPUBJS.Parser.prototype.spine=function(e,t){var n=[],r=e.getElementsByTagName("itemref"),i=Array.prototype.slice.call(r),o=Array.prototype.indexOf.call(e.parentNode.childNodes,e),s=new EPUBJS.EpubCFI;return i.forEach(function(e,r){var i=e.getAttribute("idref"),a=s.generateChapterComponent(o,r,i),u=e.getAttribute("properties")||"",h=u.length?u.split(" "):[],c=t[i].properties,l=c.length?c.split(" "):[],d={id:i,linear:e.getAttribute("linear")||"",properties:h,manifestProperties:l,href:t[i].href,url:t[i].url,index:r,cfiBase:a,cfi:"epubcfi("+a+")"};n.push(d)}),n},EPUBJS.Parser.prototype.querySelectorByType=function(e,t,n){var r=e.querySelector(t+'[*|type="'+n+'"]');if(null!==r&&0!==r.length)return r;r=e.querySelectorAll(t);for(var i=0;i<r.length;i++)if(r[i].getAttributeNS("http://www.idpf.org/2007/ops","type")===n)return r[i]},EPUBJS.Parser.prototype.nav=function(e,t,n){var r,i,o,s=this.querySelectorByType(e,"nav","toc"),a=s?s.querySelectorAll("ol li"):[],u=a.length,h={},c=[];if(!a||0===u)return c;for(r=0;u>r;++r)i=this.navItem(a[r],t,n),h[i.id]=i,i.parent?(o=h[i.parent],o.subitems.push(i)):c.push(i);return c},EPUBJS.Parser.prototype.navItem=function(e,t,n){var r,i=e.getAttribute("id")||!1,o=e.querySelector("a, span"),s=o.getAttribute("href")||"",a=o.textContent||"",u=s.split("#"),h=u[0],c=t[h],l=n[c],d=[],f=e.parentNode,p=l?l.cfi:"";return f&&"navPoint"===f.nodeName&&(r=f.getAttribute("id")),i||(c?(l=n[c],i=l.id,p=l.cfi):(i="epubjs-autogen-toc-id-"+EPUBJS.core.uuid(),e.setAttribute("id",i))),{id:i,href:s,label:a,spinePos:c,subitems:d,parent:r,cfi:p}},EPUBJS.Parser.prototype.toc=function(e,t,n){var r,i,o,s=e.querySelectorAll("navMap navPoint"),a=s.length,u={},h=[];if(!s||0===a)return h;for(r=0;a>r;++r)i=this.tocItem(s[r],t,n),u[i.id]=i,i.parent?(o=u[i.parent],o.subitems.push(i)):h.push(i);return h},EPUBJS.Parser.prototype.tocItem=function(e,t,n){var r,i=e.getAttribute("id")||!1,o=e.querySelector("content"),s=o.getAttribute("src"),a=e.querySelector("navLabel"),u=a.textContent?a.textContent:"",h=s.split("#"),c=h[0],l=t[c],d=n[l],f=[],p=e.parentNode,g=d?d.cfi:"";return p&&"navPoint"===p.nodeName&&(r=p.getAttribute("id")),i||(l?(d=n[l],i=d.id,g=d.cfi):(i="epubjs-autogen-toc-id-"+EPUBJS.core.uuid(),e.setAttribute("id",i))),{id:i,href:s,label:u,spinePos:l,subitems:f,parent:r,cfi:g}},EPUBJS.Parser.prototype.pageList=function(e,t,n){var r,i,o=this.querySelectorByType(e,"nav","page-list"),s=o?o.querySelectorAll("ol li"):[],a=s.length,u=[];if(!s||0===a)return u;for(r=0;a>r;++r)i=this.pageListItem(s[r],t,n),u.push(i);return u},EPUBJS.Parser.prototype.pageListItem=function(e,t,n){var r,i,o,s=(e.getAttribute("id")||!1,e.querySelector("a")),a=s.getAttribute("href")||"",u=s.textContent||"",h=parseInt(u),c=a.indexOf("epubcfi");return-1!=c?(r=a.split("#"),i=r[0],o=r.length>1?r[1]:!1,{cfi:o,href:a,packageUrl:i,page:h}):{href:a,page:h}},EPUBJS.Render.Iframe=function(){this.iframe=null,this.document=null,this.window=null,this.docEl=null,this.bodyEl=null,this.leftPos=0,this.pageWidth=0},EPUBJS.Render.Iframe.prototype.create=function(){return this.iframe=document.createElement("iframe"),this.iframe.id="epubjs-iframe:"+EPUBJS.core.uuid(),this.iframe.scrolling="no",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.addEventListener("load",this.loaded.bind(this),!1),this.isMobile=navigator.userAgent.match(/(iPad|iPhone|iPod|Mobile|Android)/g),this.transform=EPUBJS.core.prefixed("transform"),this.iframe},EPUBJS.Render.Iframe.prototype.load=function(e,t){var n=this,r=new RSVP.defer;return this.window&&this.unload(),this.iframe.onload=function(e){n.document=n.iframe.contentDocument,n.docEl=n.document.documentElement,n.headEl=n.document.head,n.bodyEl=n.document.body||n.document.querySelector("body"),n.window=n.iframe.contentWindow,n.window.addEventListener("resize",n.resized.bind(n),!1),n.leftPos=0,n.setLeft(0),n.bodyEl&&(n.bodyEl.style.margin="0"),"rtl"==n.direction&&"rtl"!=n.docEl.dir&&(n.docEl.dir="rtl",n.docEl.style.position="absolute",n.docEl.style.right="0"),r.resolve(n.docEl)},this.iframe.onerror=function(e){r.reject({message:"Error Loading Contents: "+e,stack:(new Error).stack})},this.document=this.iframe.contentDocument,this.document?(this.document.open(),this.document.write(e),this.document.close(),r.promise):(r.reject(new Error("No Document Available")),r)},EPUBJS.Render.Iframe.prototype.loaded=function(e){var t,n,r=this.iframe.contentWindow.location.href;this.document=this.iframe.contentDocument,this.docEl=this.document.documentElement,this.headEl=this.document.head,this.bodyEl=this.document.body||this.document.querySelector("body"),this.window=this.iframe.contentWindow,"about:blank"!=r&&(t=this.iframe.contentDocument.querySelector("base"),n=t.getAttribute("href"),this.trigger("render:loaded",n))},EPUBJS.Render.Iframe.prototype.resize=function(e,t){this.iframe&&(this.iframe.height=t,isNaN(e)||e%2===0||(e+=1),this.iframe.width=e,this.width=this.iframe.getBoundingClientRect().width||e,this.height=this.iframe.getBoundingClientRect().height||t)},EPUBJS.Render.Iframe.prototype.resized=function(e){this.width=this.iframe.getBoundingClientRect().width,this.height=this.iframe.getBoundingClientRect().height},EPUBJS.Render.Iframe.prototype.totalWidth=function(){return this.docEl.scrollWidth},EPUBJS.Render.Iframe.prototype.totalHeight=function(){return this.docEl.scrollHeight},EPUBJS.Render.Iframe.prototype.setPageDimensions=function(e,t){this.pageWidth=e,this.pageHeight=t},EPUBJS.Render.Iframe.prototype.setDirection=function(e){this.direction=e,this.docEl&&"rtl"==this.docEl.dir&&(this.docEl.dir="rtl",this.docEl.style.position="static",this.docEl.style.right="auto")},EPUBJS.Render.Iframe.prototype.setLeft=function(e){this.isMobile?this.docEl.style[this.transform]="translate("+-e+"px, 0)":this.document.defaultView.scrollTo(e,0)},EPUBJS.Render.Iframe.prototype.setStyle=function(e,t,n){n&&(e=EPUBJS.core.prefixed(e)),this.bodyEl&&(this.bodyEl.style[e]=t)},EPUBJS.Render.Iframe.prototype.removeStyle=function(e){this.bodyEl&&(this.bodyEl.style[e]="")},EPUBJS.Render.Iframe.prototype.addHeadTag=function(e,t,n){var r=n||this.document,i=r.createElement(e),o=r.head;for(var s in t)i.setAttribute(s,t[s]);o&&o.insertBefore(i,o.firstChild)},EPUBJS.Render.Iframe.prototype.page=function(e){this.leftPos=this.pageWidth*(e-1),"rtl"===this.direction&&(this.leftPos=-1*this.leftPos),this.setLeft(this.leftPos)},EPUBJS.Render.Iframe.prototype.getPageNumberByElement=function(e){var t,n;if(e)return t=this.leftPos+e.getBoundingClientRect().left,n=Math.floor(t/this.pageWidth)+1},EPUBJS.Render.Iframe.prototype.getPageNumberByRect=function(e){var t,n;return t=this.leftPos+e.left,n=Math.floor(t/this.pageWidth)+1},EPUBJS.Render.Iframe.prototype.getBaseElement=function(){return this.bodyEl},EPUBJS.Render.Iframe.prototype.getDocumentElement=function(){return this.docEl},EPUBJS.Render.Iframe.prototype.isElementVisible=function(e){var t,n;return e&&"function"==typeof e.getBoundingClientRect&&(t=e.getBoundingClientRect(),n=t.left,0!==t.width&&0!==t.height&&n>=0&&n<this.pageWidth)?!0:!1},EPUBJS.Render.Iframe.prototype.scroll=function(e){e?this.iframe.scrolling="yes":this.iframe.scrolling="no"},EPUBJS.Render.Iframe.prototype.unload=function(){this.window.removeEventListener("resize",this.resized),this.window.location.reload()},RSVP.EventTarget.mixin(EPUBJS.Render.Iframe.prototype),EPUBJS.Renderer=function(e,t){this.listenedEvents=["keydown","keyup","keypressed","mouseup","mousedown","click"],this.upEvent="mouseup",this.downEvent="mousedown","ontouchstart"in document.documentElement&&(this.listenedEvents.push("touchstart","touchend"),this.upEvent="touchend",this.downEvent="touchstart"),e&&"undefined"!=typeof EPUBJS.Render[e]?this.render=new EPUBJS.Render[e]:console.error("Not a Valid Rendering Method"),this.render.on("render:loaded",this.loaded.bind(this)),this.caches={},this.epubcfi=new EPUBJS.EpubCFI,this.spreads=!0,this.isForcedSingle=!1,this.resized=this.onResized.bind(this),this.layoutSettings={},this.hidden=t||!1,EPUBJS.Hooks.mixin(this),this.getHooks("beforeChapterDisplay"),this._q=EPUBJS.core.queue(this),this._moving=!1},EPUBJS.Renderer.prototype.Events=["renderer:keydown","renderer:keyup","renderer:keypressed","renderer:mouseup","renderer:mousedown","renderer:click","renderer:touchstart","renderer:touchend","renderer:selected","renderer:chapterUnloaded","renderer:chapterDisplayed","renderer:locationChanged","renderer:visibleLocationChanged","renderer:resized","renderer:spreads"],EPUBJS.Renderer.prototype.initialize=function(e,t,n){this.container=e,this.element=this.render.create(),this.initWidth=t,this.initHeight=n,this.width=t||this.container.clientWidth,this.height=n||this.container.clientHeight,this.container.appendChild(this.element),t&&n?this.render.resize(this.width,this.height):this.render.resize("100%","100%"),document.addEventListener("orientationchange",this.onResized)},EPUBJS.Renderer.prototype.displayChapter=function(e,t){return this._moving?void console.error("Rendering In Progress"):(this._moving=!0,e.render().then(function(n){return this.currentChapter&&(this.currentChapter.unload(),this.render.window&&this.render.window.removeEventListener("resize",this.resized),this.removeEventListeners(),this.removeSelectionListeners(),this.trigger("renderer:chapterUnloaded"),this.contents=null,this.doc=null,this.pageMap=null),this.currentChapter=e,this.chapterPos=1,this.currentChapterCfiBase=e.cfiBase,this.layoutSettings=this.reconcileLayoutSettings(t,e.properties),this.load(n,e.href)}.bind(this)))},EPUBJS.Renderer.prototype.load=function(e,t){var n=new RSVP.defer;return this.layoutMethod=this.determineLayout(this.layoutSettings),this.layout=new EPUBJS.Layout[this.layoutMethod],this.visible(!1),render=this.render.load(e,t),render.then(function(e){this.afterLoad(e),this.beforeDisplay(function(){this.afterDisplay(),this.visible(!0),n.resolve(this)}.bind(this))}.bind(this)),n.promise},EPUBJS.Renderer.prototype.afterLoad=function(e){this.currentChapter.setDocument(this.render.document),this.contents=e,this.doc=this.render.document,this.formated=this.layout.format(e,this.render.width,this.render.height,this.gap),this.render.setPageDimensions(this.formated.pageWidth,this.formated.pageHeight),this.initWidth||this.initHeight||this.render.window.addEventListener("resize",this.resized,!1),this.addEventListeners(),this.addSelectionListeners()},EPUBJS.Renderer.prototype.afterDisplay=function(e){var t=this.layout.calculatePages(),n=this.currentChapter,r=this._q.length();this._moving=!1,this.updatePages(t),this.visibleRangeCfi=this.getVisibleRangeCfi(),this.currentLocationCfi=this.visibleRangeCfi.start,0===r&&(this.trigger("renderer:locationChanged",this.currentLocationCfi),this.trigger("renderer:visibleRangeChanged",this.visibleRangeCfi)),n.cfi=this.currentLocationCfi,this.trigger("renderer:chapterDisplayed",n)},EPUBJS.Renderer.prototype.loaded=function(e){this.trigger("render:loaded",e)},EPUBJS.Renderer.prototype.reconcileLayoutSettings=function(e,t){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return t.forEach(function(e){var t,r,i=e.replace("rendition:",""),o=i.indexOf("-");-1!=o&&(t=i.slice(0,o),r=i.slice(o+1),n[t]=r)}),n},EPUBJS.Renderer.prototype.determineLayout=function(e){var t=this.determineSpreads(this.minSpreadWidth),n=t?"ReflowableSpreads":"Reflowable",r=!1;return"pre-paginated"===e.layout&&(n="Fixed",r=!0,t=!1),"reflowable"===e.layout&&"none"===e.spread&&(n="Reflowable",r=!1,t=!1),"reflowable"===e.layout&&"both"===e.spread&&(n="ReflowableSpreads",r=!1,t=!0),this.spreads=t,this.render.scroll(r),this.trigger("renderer:spreads",t),n},EPUBJS.Renderer.prototype.beforeDisplay=function(e,t){this.triggerHooks("beforeChapterDisplay",e,this)},EPUBJS.Renderer.prototype.updatePages=function(e){this.pageMap=this.mapPage(),this.spreads?this.displayedPages=Math.ceil(this.pageMap.length/2):this.displayedPages=this.pageMap.length,this.currentChapter.pages=this.pageMap.length,this._q.flush()},EPUBJS.Renderer.prototype.reformat=function(){var e,t=this;this.contents&&(spreads=this.determineSpreads(this.minSpreadWidth),spreads!=this.spreads&&(this.spreads=spreads,this.layoutMethod=this.determineLayout(this.layoutSettings),this.layout=new EPUBJS.Layout[this.layoutMethod]),this.chapterPos=1,this.render.page(this.chapterPos),t.formated=t.layout.format(t.render.docEl,t.render.width,t.render.height,t.gap),t.render.setPageDimensions(t.formated.pageWidth,t.formated.pageHeight),e=t.layout.calculatePages(),t.updatePages(e),t.currentLocationCfi&&t.gotoCfi(t.currentLocationCfi))},EPUBJS.Renderer.prototype.visible=function(e){return"undefined"==typeof e?this.element.style.visibility:void(e!==!0||this.hidden?e===!1&&(this.element.style.visibility="hidden"):this.element.style.visibility="visible")},EPUBJS.Renderer.prototype.remove=function(){this.render.window&&(this.render.unload(),this.render.window.removeEventListener("resize",this.resized),this.removeEventListeners(),this.removeSelectionListeners()),this.container.removeChild(this.element)},EPUBJS.Renderer.prototype.applyStyles=function(e){for(var t in e)this.render.setStyle(t,e[t])},EPUBJS.Renderer.prototype.setStyle=function(e,t,n){this.render.setStyle(e,t,n)},EPUBJS.Renderer.prototype.removeStyle=function(e){this.render.removeStyle(e)},EPUBJS.Renderer.prototype.applyHeadTags=function(e){for(var t in e)this.render.addHeadTag(t,e[t])},EPUBJS.Renderer.prototype.page=function(e){return this.pageMap?e>=1&&e<=this.displayedPages?(this.chapterPos=e,this.render.page(e),this.visibleRangeCfi=this.getVisibleRangeCfi(),this.currentLocationCfi=this.visibleRangeCfi.start,this.trigger("renderer:locationChanged",this.currentLocationCfi),this.trigger("renderer:visibleRangeChanged",this.visibleRangeCfi),!0):!1:(console.warn("pageMap not set, queuing"),this._q.enqueue("page",arguments),!0)},EPUBJS.Renderer.prototype.nextPage=function(){return this.page(this.chapterPos+1)},EPUBJS.Renderer.prototype.prevPage=function(){return this.page(this.chapterPos-1)},EPUBJS.Renderer.prototype.pageByElement=function(e){var t;e&&(t=this.render.getPageNumberByElement(e),this.page(t))},EPUBJS.Renderer.prototype.lastPage=function(){return this._moving?this._q.enqueue("lastPage",arguments):void this.page(this.displayedPages)},EPUBJS.Renderer.prototype.firstPage=function(){return this._moving?this._q.enqueue("firstPage",arguments):void this.page(1)},EPUBJS.Renderer.prototype.section=function(e){var t=this.doc.getElementById(e);t&&this.pageByElement(t)},EPUBJS.Renderer.prototype.firstElementisTextNode=function(e){var t=e.childNodes,n=t.length;return n&&t[0]&&3===t[0].nodeType&&t[0].textContent.trim().length?!0:!1},EPUBJS.Renderer.prototype.isGoodNode=function(e){var t=["audio","canvas","embed","iframe","img","math","object","svg","video"];return-1!==t.indexOf(e.tagName.toLowerCase())?!0:this.firstElementisTextNode(e)},EPUBJS.Renderer.prototype.walk=function(e,t,n){for(var r,i,o,s,a=e,u=[a],h=1e4,c=0;!r&&u.length;){if(e=u.shift(),this.containsPoint(e,t,n)&&this.isGoodNode(e)&&(r=e),!r&&e&&e.childElementCount>0){if(i=e.children,!i||!i.length)return r;o=i.length?i.length:0;for(var l=o-1;l>=0;l--)i[l]!=s&&u.unshift(i[l])}if(!r&&0===u.length&&a&&null!==a.parentNode&&(u.push(a.parentNode),s=a,a=a.parentNode),c++,c>h){console.error("ENDLESS LOOP");break}}return r},EPUBJS.Renderer.prototype.containsPoint=function(e,t,n){var r;return e&&"function"==typeof e.getBoundingClientRect&&(r=e.getBoundingClientRect(),0!==r.width&&0!==r.height&&r.left>=t&&t<=r.left+r.width)?!0:!1},EPUBJS.Renderer.prototype.textSprint=function(e,t){for(var n,r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:function(e){return/^\s*$/.test(e.data)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}},!1);n=r.nextNode();)t(n)},EPUBJS.Renderer.prototype.sprint=function(e,t){for(var n,r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,null,!1);n=r.nextNode();)t(n)},EPUBJS.Renderer.prototype.mapPage=function(){var e,t,n=this,r=[],i=this.render.getBaseElement(),o=1,s=this.layout.colWidth+this.layout.gap,a=this.formated.pageWidth*(this.chapterPos-1),u=s*o-a,h=0,c=null,l=function(e){var t,n,r=Array.prototype.slice.call(e.childNodes);if(e.nodeType==Node.ELEMENT_NODE){if(n=document.createRange(),n.selectNodeContents(e),t=n.getBoundingClientRect(),!t||0===t.width&&0===t.height)return;c=r,t.left>h&&(r.forEach(function(e){e.nodeType==Node.TEXT_NODE&&e.textContent.trim().length&&d(e)}),c=null),t.right>h&&(r.forEach(function(e){e.nodeType==Node.TEXT_NODE&&e.textContent.trim().length&&d(e)}),c=null)}},d=function(i){var c=n.splitTextNodeIntoWordsRanges(i);c.forEach(function(i){var c=i.getBoundingClientRect();!c||0===c.width&&0===c.height||(c.left+c.width<u?r[o-1]||(i.collapse(!0),t=n.currentChapter.cfiFromRange(i),r.push({start:t,end:null})):(e&&(e.collapse(!0),t=n.currentChapter.cfiFromRange(e),r[r.length-1].end=t),i.collapse(!0),t=n.currentChapter.cfiFromRange(i),r.push({start:t,end:null}),o+=1,u=s*o-a,h=u),e=i)})},f=this.render.getDocumentElement(),p=f.dir;return"rtl"==p&&(f.dir="ltr",f.style.position="static"),this.sprint(i,l),null!==c&&c.forEach(function(e){e.nodeType==Node.TEXT_NODE&&e.textContent.trim().length&&d(e)}),"rtl"==p&&(f.dir=p,f.style.left="auto",f.style.right="0"),e&&(e.collapse(!0),t=n.currentChapter.cfiFromRange(e),r[r.length-1].end=t),r.length||(range=this.doc.createRange(),range.selectNodeContents(i),range.collapse(!0),t=n.currentChapter.cfiFromRange(range),r.push({start:t,end:t})),e=null,ranges=null,range=null,i=null,r},EPUBJS.Renderer.prototype.indexOfBreakableChar=function(e,t){var n="- 	\r\n\b\f";t||(t=0);for(var r=t;r<e.length;r++)if(-1!=n.indexOf(e.charAt(r)))return r;return-1},EPUBJS.Renderer.prototype.splitTextNodeIntoWordsRanges=function(e){var t,n=[],r=e.textContent.trim();if(pos=this.indexOfBreakableChar(r),-1===pos)return t=this.doc.createRange(),t.selectNodeContents(e),[t];for(t=this.doc.createRange(),t.setStart(e,0),t.setEnd(e,pos),n.push(t),t=this.doc.createRange(),t.setStart(e,pos+1);-1!=pos;)pos=this.indexOfBreakableChar(r,pos+1),pos>0&&(t&&(t.setEnd(e,pos),n.push(t)),t=this.doc.createRange(),t.setStart(e,pos+1));return t&&(t.setEnd(e,r.length),n.push(t)),n},EPUBJS.Renderer.prototype.rangePosition=function(e){var t,n;return n=e.getClientRects(),n.length?t=n[0]:null},EPUBJS.Renderer.prototype.getPageCfi=function(){var e=2*this.chapterPos-1;return this.pageMap[e].start},EPUBJS.Renderer.prototype.getRange=function(e,t,n){var r,i=this.doc.createRange();return n=!0,"undefined"==typeof document.caretPositionFromPoint||n?"undefined"==typeof document.caretRangeFromPoint||n?(this.visibileEl=this.findElementAfter(e,t),i.setStart(this.visibileEl,1)):i=this.doc.caretRangeFromPoint(e,t):(r=this.doc.caretPositionFromPoint(e,t),i.setStart(r.offsetNode,r.offset)),i},EPUBJS.Renderer.prototype.pagesInCurrentChapter=function(){var e,t;return this.pageMap?(t=this.pageMap.length,e=this.spreads?Math.ceil(t/2):t):(console.warn("page map not loaded"),!1)},EPUBJS.Renderer.prototype.currentRenderedPage=function(){var e;return this.pageMap?e=this.spreads&&this.pageMap.length>1?2*this.chapterPos:this.chapterPos:(console.warn("page map not loaded"),!1)},EPUBJS.Renderer.prototype.getRenderedPagesLeft=function(){var e,t,n;return this.pageMap?(t=this.pageMap.length,e=this.spreads?2*this.chapterPos:this.chapterPos,n=t-e):(console.warn("page map not loaded"),!1)},EPUBJS.Renderer.prototype.getVisibleRangeCfi=function(){var e,t,n;return this.pageMap?(this.spreads?(e=2*this.chapterPos,t=this.pageMap[e-2],n=t,this.pageMap.length>1&&(n=this.pageMap[e-1])):(e=this.chapterPos,t=this.pageMap[e-1],n=t),t||(console.warn("page range miss:",e,this.pageMap),t=this.pageMap[this.pageMap.length-1],n=t),{start:t.start,end:n.end}):(console.warn("page map not loaded"),!1)},EPUBJS.Renderer.prototype.gotoCfi=function(e){var t,n,r;if(this._moving)return this._q.enqueue("gotoCfi",arguments);if(EPUBJS.core.isString(e)&&(e=this.epubcfi.parse(e)),"undefined"==typeof document.evaluate)n=this.epubcfi.addMarker(e,this.doc),n&&(t=this.render.getPageNumberByElement(n),this.epubcfi.removeMarker(n,this.doc),this.page(t));else if(r=this.epubcfi.generateRangeFromCfi(e,this.doc)){var i=r.getBoundingClientRect();t=i?this.render.getPageNumberByRect(i):1,this.page(t),this.currentLocationCfi=e.str}else this.page(1)},EPUBJS.Renderer.prototype.findFirstVisible=function(e){var t,n=e||this.render.getBaseElement();return t=this.walk(n,0,0),t?t:e},EPUBJS.Renderer.prototype.findElementAfter=function(e,t,n){var r,i=n||this.render.getBaseElement();return r=this.walk(i,e,t),r?r:i},EPUBJS.Renderer.prototype.resize=function(e,t,n){this.width=e,this.height=t,n!==!1&&this.render.resize(this.width,this.height),this.contents&&this.reformat(),this.trigger("renderer:resized",{width:this.width,height:this.height})},EPUBJS.Renderer.prototype.onResized=function(e){var t=this.container.clientWidth,n=this.container.clientHeight;this.resize(t,n,!1)},EPUBJS.Renderer.prototype.addEventListeners=function(){this.render.document&&this.listenedEvents.forEach(function(e){this.render.document.addEventListener(e,this.triggerEvent.bind(this),!1)},this)},EPUBJS.Renderer.prototype.removeEventListeners=function(){this.render.document&&this.listenedEvents.forEach(function(e){this.render.document.removeEventListener(e,this.triggerEvent,!1)},this)},EPUBJS.Renderer.prototype.triggerEvent=function(e){this.trigger("renderer:"+e.type,e)},EPUBJS.Renderer.prototype.addSelectionListeners=function(){this.render.document.addEventListener("selectionchange",this.onSelectionChange.bind(this),!1)},EPUBJS.Renderer.prototype.removeSelectionListeners=function(){this.render.document&&this.doc.removeEventListener("selectionchange",this.onSelectionChange,!1)},EPUBJS.Renderer.prototype.onSelectionChange=function(e){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout(function(){this.selectedRange=this.render.window.getSelection(),this.trigger("renderer:selected",this.selectedRange)}.bind(this),500)},EPUBJS.Renderer.prototype.setMinSpreadWidth=function(e){this.minSpreadWidth=e,this.spreads=this.determineSpreads(e)},EPUBJS.Renderer.prototype.determineSpreads=function(e){return this.isForcedSingle||!e||this.width<e?!1:!0},EPUBJS.Renderer.prototype.forceSingle=function(e){e?this.isForcedSingle=!0:this.isForcedSingle=!1},EPUBJS.Renderer.prototype.setGap=function(e){this.gap=e},EPUBJS.Renderer.prototype.setDirection=function(e){this.direction=e,this.render.setDirection(this.direction)},EPUBJS.Renderer.prototype.replace=function(e,t,n,r){var i=this.contents.querySelectorAll(e),o=Array.prototype.slice.call(i),s=o.length;return 0===s?void n(!1):void o.forEach(function(e){var i=!1,o=function(e,t){i===!1&&(s--,r&&r(e,t,s),0>=s&&n&&n(!0),i=!0)};t(e,o)}.bind(this))},RSVP.EventTarget.mixin(EPUBJS.Renderer.prototype);var EPUBJS=EPUBJS||{};EPUBJS.replace={},EPUBJS.replace.hrefs=function(e,t){var n=this,r=function(e,r){var i,o,s,a,u,h=e.getAttribute("href"),c=h.search("://");-1!=c?e.setAttribute("target","_blank"):(s=t.render.docEl.querySelector("base"),u=s.getAttribute("href"),a=EPUBJS.core.uri(u),i=a.directory,o=i?"file"===a.protocol?EPUBJS.core.resolveUrl(a.base,h):EPUBJS.core.resolveUrl(i,h):h,e.onclick=function(){return n["goto"](o),!1}),r()};t.replace("a[href]",r,e)},EPUBJS.replace.head=function(e,t){t.replaceWithStored("link[href]","href",EPUBJS.replace.links,e)},EPUBJS.replace.resources=function(e,t){t.replaceWithStored("[src]","src",EPUBJS.replace.srcs,e)},EPUBJS.replace.svg=function(e,t){t.replaceWithStored("svg image","xlink:href",function(e,t,n){e.getUrl(t).then(n,function(){n(null)})},e)},EPUBJS.replace.srcs=function(e,t,n){e.getUrl(t).then(n,function(){n(null)})},EPUBJS.replace.links=function(e,t,n,r){"stylesheet"===r.getAttribute("rel")?EPUBJS.replace.stylesheets(e,t).then(function(e,t){n(e,t)},function(e){n(null)}):e.getUrl(t).then(n,function(e){n(null)})},EPUBJS.replace.stylesheets=function(e,t){var n=new RSVP.defer;if(e)return e.getText(t).then(function(r){EPUBJS.replace.cssUrls(e,t,r).then(function(e){var t=window.URL||window.webkitURL||window.mozURL,r=new Blob([e],{type:"text/css"}),i=t.createObjectURL(r);n.resolve(i)},function(e){n.reject(e);
})},function(e){n.reject(e)}),n.promise},EPUBJS.replace.cssUrls=function(e,t,n){var r=new RSVP.defer,i=[],o=n.match(/url\(\'?\"?((?!data:)[^\'|^\"^\)]*)\'?\"?\)/g);if(e)return o?(o.forEach(function(o){var s=EPUBJS.core.resolveUrl(t,o.replace(/url\(|[|\)|\'|\"]|\?.*$/g,"")),a=e.getUrl(s).then(function(e){n=n.replace(o,'url("'+e+'")')},function(e){r.reject(e)});i.push(a)}),RSVP.all(i).then(function(){r.resolve(n)}),r.promise):(r.resolve(n),r.promise)},EPUBJS.Storage=function(e){this.checkRequirements(),this.urlCache={},this.withCredentials=e,this.URL=window.URL||window.webkitURL||window.mozURL,this.offline=!1},EPUBJS.Storage.prototype.checkRequirements=function(e){"undefined"==typeof localforage&&console.error("localForage library not loaded")},EPUBJS.Storage.prototype.put=function(e,t){var n=new RSVP.defer,r=e.length,i=0,o=function(t){var n,s,a=t||new RSVP.defer;return i>=r?a.resolve():(n=e[i].url,s=window.encodeURIComponent(n),EPUBJS.core.request(n,"binary").then(function(e){return localforage.setItem(s,e)}).then(function(e){i++,setTimeout(function(){o(a)},1)})),a.promise}.bind(this);return Array.isArray(e)||(e=[e]),o().then(function(){n.resolve()}.bind(this)),n.promise},EPUBJS.Storage.prototype.token=function(e,t){var n=window.encodeURIComponent(e);return localforage.setItem(n,t).then(function(e){return null===e?!1:!0})},EPUBJS.Storage.prototype.isStored=function(e){var t=window.encodeURIComponent(e);return localforage.getItem(t).then(function(e){return null===e?!1:!0})},EPUBJS.Storage.prototype.getText=function(e){var t=window.encodeURIComponent(e);return EPUBJS.core.request(e,"arraybuffer",this.withCredentials).then(function(e){return this.offline&&(this.offline=!1,this.trigger("offline",!1)),localforage.setItem(t,e),e}.bind(this)).then(function(t){var n=new RSVP.defer,r=EPUBJS.core.getMimeType(e),i=new Blob([t],{type:r}),o=new FileReader;return o.addEventListener("loadend",function(){n.resolve(o.result)}),o.readAsText(i,r),n.promise})["catch"](function(){var n=new RSVP.defer,r=localforage.getItem(t);return this.offline||(this.offline=!0,this.trigger("offline",!0)),r?(r.then(function(t){var r=EPUBJS.core.getMimeType(e),i=new Blob([t],{type:r}),o=new FileReader;o.addEventListener("loadend",function(){n.resolve(o.result)}),o.readAsText(i,r)}),n.promise):(n.reject({message:"File not found in the storage: "+e,stack:(new Error).stack}),n.promise)}.bind(this))},EPUBJS.Storage.prototype.getUrl=function(e){var t=window.encodeURIComponent(e);return EPUBJS.core.request(e,"arraybuffer",this.withCredentials).then(function(n){return this.offline&&(this.offline=!1,this.trigger("offline",!1)),localforage.setItem(t,n),e}.bind(this))["catch"](function(){var n,r,i=new RSVP.defer,o=window.URL||window.webkitURL||window.mozURL;return this.offline||(this.offline=!0,this.trigger("offline",!0)),t in this.urlCache?(i.resolve(this.urlCache[t]),i.promise):(n=localforage.getItem(t))?(n.then(function(n){var s=new Blob([n],{type:EPUBJS.core.getMimeType(e)});r=o.createObjectURL(s),i.resolve(r),this.urlCache[t]=r}.bind(this)),i.promise):(i.reject({message:"File not found in the storage: "+e,stack:(new Error).stack}),i.promise)}.bind(this))},EPUBJS.Storage.prototype.getXml=function(e){var t=window.encodeURIComponent(e);return EPUBJS.core.request(e,"arraybuffer",this.withCredentials).then(function(e){return this.offline&&(this.offline=!1,this.trigger("offline",!1)),localforage.setItem(t,e),e}.bind(this)).then(function(t){var n=new RSVP.defer,r=EPUBJS.core.getMimeType(e),i=new Blob([t],{type:r}),o=new FileReader;return o.addEventListener("loadend",function(){var e=new DOMParser,t=e.parseFromString(o.result,"text/xml");n.resolve(t)}),o.readAsText(i,r),n.promise})["catch"](function(){var n=new RSVP.defer,r=localforage.getItem(t);return this.offline||(this.offline=!0,this.trigger("offline",!0)),r?(r.then(function(t){var r=EPUBJS.core.getMimeType(e),i=new Blob([t],{type:r}),o=new FileReader;o.addEventListener("loadend",function(){var e=new DOMParser,t=e.parseFromString(o.result,"text/xml");n.resolve(t)}),o.readAsText(i,r)}),n.promise):(n.reject({message:"File not found in the storage: "+e,stack:(new Error).stack}),n.promise)}.bind(this))},EPUBJS.Storage.prototype.revokeUrl=function(e){var t=window.URL||window.webkitURL||window.mozURL,n=this.urlCache[e];n&&t.revokeObjectURL(n)},EPUBJS.Storage.prototype.failed=function(e){console.error(e)},RSVP.EventTarget.mixin(EPUBJS.Storage.prototype),EPUBJS.Unarchiver=function(e){this.checkRequirements(),this.urlCache={}},EPUBJS.Unarchiver.prototype.checkRequirements=function(e){"undefined"==typeof JSZip&&console.error("JSZip lib not loaded")},EPUBJS.Unarchiver.prototype.open=function(e,t){if(e instanceof ArrayBuffer){this.zip=new JSZip(e);var n=new RSVP.defer;return n.resolve(),n.promise}return EPUBJS.core.request(e,"binary").then(function(e){this.zip=new JSZip(e)}.bind(this))},EPUBJS.Unarchiver.prototype.getXml=function(e,t){var n=window.decodeURIComponent(e);return this.getText(n,t).then(function(t){var n=new DOMParser,r=EPUBJS.core.getMimeType(e);return n.parseFromString(t,r)})},EPUBJS.Unarchiver.prototype.getUrl=function(e,t){var n,r,i=this,o=new RSVP.defer,s=window.decodeURIComponent(e),a=this.zip.file(s),u=window.URL||window.webkitURL||window.mozURL;return a?e in this.urlCache?(o.resolve(this.urlCache[e]),o.promise):(r=new Blob([a.asUint8Array()],{type:EPUBJS.core.getMimeType(a.name)}),n=u.createObjectURL(r),o.resolve(n),i.urlCache[e]=n,o.promise):(o.reject({message:"File not found in the epub: "+e,stack:(new Error).stack}),o.promise)},EPUBJS.Unarchiver.prototype.getText=function(e,t){var n,r=new RSVP.defer,i=window.decodeURIComponent(e),o=this.zip.file(i);return o?(n=o.asText(),r.resolve(n),r.promise):(r.reject({message:"File not found in the epub: "+e,stack:(new Error).stack}),r.promise)},EPUBJS.Unarchiver.prototype.revokeUrl=function(e){var t=window.URL||window.webkitURL||window.mozURL,n=this.urlCache[e];n&&t.revokeObjectURL(n)},EPUBJS.Unarchiver.prototype.failed=function(e){console.error(e)},EPUBJS.Unarchiver.prototype.afterSaved=function(e){this.callback()},EPUBJS.Unarchiver.prototype.toStorage=function(e){function t(){o--,0===o&&i.afterSaved()}var n=0,r=20,i=this,o=e.length;e.forEach(function(e){setTimeout(function(e){i.saveEntryFileToStorage(e,t)},n,e),n+=r}),console.log("time",n)},function(){"use strict";var e={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbncx+xml":"ncx","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},message:{rfc822:["eml","mime","mht","mhtml","nws"]},text:{"cache-manifest":["manifest","appcache"],calendar:["ics","icz","ifb"],css:"css",csv:"csv",h323:"323",html:["html","htm","shtml","stm"],iuls:"uls",mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib","x-dsrc":"d","x-diff":["diff","patch"],"x-haskell":"hs","x-java":"java","x-literate-haskell":"lhs","x-moc":"moc","x-pascal":["p","pas"],"x-pcs-gcd":"gcd","x-perl":["pl","pm"],"x-python":"py","x-scala":"scala","x-setext":"etx","x-tcl":["tcl","tk"],"x-tex":["tex","ltx","sty","cls"],"x-vcard":"vcf",sgml:["sgml","sgm"],"x-c":["c","cc","cxx","cpp","h","hh","dic"],"x-fortran":["f","for","f77","f90"],"x-opml":"opml","x-nfo":"nfo","x-sfv":"sfv","x-uuencode":"uu",webviewhtml:"htt"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},t=function(){var t,n,r,i,o={};for(t in e)if(e.hasOwnProperty(t))for(n in e[t])if(e[t].hasOwnProperty(n))if(r=e[t][n],"string"==typeof r)o[r]=t+"/"+n;else for(i=0;i<r.length;i++)o[r[i]]=t+"/"+n;return o}();EPUBJS.core.getMimeType=function(e){var n="text/plain";return e&&t[e.split(".").pop().toLowerCase()]||n}}(),function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var r=n(1);window.EFLPlayer=new r.EFLPlayer(window)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),s=function(){function e(t){var n=this;r(this,e),this.context=t,this.context.location.origin||(this.context.location.origin=this.context.location.protocol+"//"+this.context.location.hostname+(this.context.location.port?":"+this.context.location.port:"")),t.handleMessageProxy=function(e){n.handleMessage(e)},this.context.addEventListener("message",this.context.handleMessageProxy,!1),this.moduleLoadedHandler=void 0,this.moduleFinishedHandler=void 0,this.screenLoadedHandler=void 0,this.screenFinishedHandler=void 0,this.moduleExceptionHandler=void 0,this.moduleHeightChangedHandler=void 0,this.initTimerHandler=void 0,this.startTimerHandler=void 0,this.pauseTimerHandler=void 0,this.requestTimerTimeHandler=void 0,EPUBJS.Hooks.register("beforeChapterDisplay").wgxpath=function(e,t){wgxpath.install(t.render.window),e&&e()},wgxpath.install(t)}return i(e,[{key:"removeListener",value:function(){this.context.removeEventListener("message",this.context.handleMessageProxy)}},{key:"handleMessage",value:function(e){if(e.origin===document.location.origin){var t,n,r,i,s,a,u,h,c,l,d,f,p,g=JSON.parse(e.data);switch(g.type){case o.MODULE_EVENTS.LOADED_MODULE:g.data&&(r=g.data.stepName),this.loadedModule(r);break;case o.MODULE_EVENTS.LOADED_SCREEN:g.data&&(t=g.data.navigation),this.loadedScreen(t);break;case o.MODULE_EVENTS.FINISHED_SCREEN:g.data&&(n=g.data.progress),this.finishedScreen(n);break;case o.MODULE_EVENTS.FINISHED_MODULE:g.data&&(r=g.data.stepName,i=g.data.observations,s=g.data.metas,a=g.data.applicant,u=g.data.state),this.finishedModule(r,i,s,a,u);break;case o.MODULE_EVENTS.CAUGHT_EXCEPTION:g.data&&(h=g.data.category,c=g.data.message),this.moduleException(h,c);break;case o.MODULE_EVENTS.CHANGED_HEIGHT:g.data&&(l=g.data.height),this.moduleHeightChanged(l);break;case o.MODULE_EVENTS.INIT_TIMER:g.data&&(d=g.data.time,f=g.data.enableTimeExtension,p=g.data.enableControl),this.initTimer(d,f,p);break;case o.MODULE_EVENTS.START_TIMER:this.startTimer();break;case o.MODULE_EVENTS.PAUSE_TIMER:this.pauseTimer();break;case o.MODULE_EVENTS.REQUEST_TIMER_TIME:this.requestTimerTime();break;case o.MODULE_EVENTS.CHANGED_VIEW:this.changedView()}}}},{key:"sendPostMessage",value:function(e,t){if(void 0!==this.moduleWindow&&void 0!==e){var n={type:e};void 0!==t&&(n.data=t),this.moduleWindow.postMessage(JSON.stringify(n),document.location.origin)}}},{key:"init",value:function(e){var t={layoutOveride:{layout:"pre-paginated"}};e.width&&(t.width=e.width),e.height&&(t.height=e.height),e.target&&(this.target=e.target),this.rendererOptions=t}},{key:"loadModule",value:function(e,t,n){var r=this;this.moduleName=name,this.moduleInitilized=!1,this.renderer&&this.renderer.destroy(),this.renderer=ePub(t,this.rendererOptions);var i=function a(){var e=document.getElementById(r.target).getElementsByTagName("iframe");e.length>0&&(r.moduleWindow=e[0].contentWindow),r.renderer.off("book:ready",a)},s=function u(){r.moduleInitilized||(r.sendPostMessage(o.MODULE_EVENTS.INITIALIZE_MODULE,{stepName:e,config:n}),r.moduleInitilized=!0),r.renderer.off("renderer:chapterDisplayed",u)};this.renderer.on("book:ready",i),this.renderer.on("renderer:chapterDisplayed",s),this.renderer.renderTo(this.target)}},{key:"loadedModule",value:function(e){this.moduleLoadedHandler&&this.moduleLoadedHandler(e)}},{key:"loadedScreen",value:function(e){this.screenLoadedHandler&&this.screenLoadedHandler(e)}},{key:"finishedScreen",value:function(e){this.screenFinishedHandler&&this.screenFinishedHandler(e)}},{key:"finishedModule",value:function(e,t,n,r,i){this.moduleFinishedHandler&&this.moduleFinishedHandler(e,t,n,r,i)}},{key:"moduleException",value:function(e,t){this.moduleExceptionHandler&&this.moduleExceptionHandler(e,t)}},{key:"nextButtonTapped",value:function(){this.sendPostMessage(o.MODULE_EVENTS.PRESSED_NAVIGATION_BUTTON,{button:"next"})}},{key:"backButtonTapped",value:function(){this.sendPostMessage(o.MODULE_EVENTS.PRESSED_NAVIGATION_BUTTON,{button:"back"})}},{key:"languageChanged",value:function(e){this.sendPostMessage(o.MODULE_EVENTS.CHANGED_LANGUAGE,{language:e})}},{key:"closeModule",value:function(){this.renderer&&(this.renderer.destroy(),this.renderer=void 0)}},{key:"moduleHeightChanged",value:function(e){this.moduleHeightChangedHandler&&this.moduleHeightChangedHandler(e)}},{key:"initTimer",value:function(e,t,n){this.initTimerHandler&&this.initTimerHandler(e,t!==!1,n!==!1)}},{key:"startTimer",value:function(){this.startTimerHandler&&this.startTimerHandler()}},{key:"pauseTimer",value:function(){this.pauseTimerHandler&&this.pauseTimerHandler()}},{key:"requestTimerTime",value:function(){this.requestTimerTimeHandler&&this.requestTimerTimeHandler()}},{key:"initializedTimer",value:function(){this.sendPostMessage(o.MODULE_EVENTS.INITIALIZED_TIMER)}},{key:"changedTimerState",value:function(e){this.sendPostMessage(o.MODULE_EVENTS.CHANGED_TIMER_STATE,{state:e})}},{key:"timerTimeResponse",value:function(e){this.sendPostMessage(o.MODULE_EVENTS.TIMER_TIME_RESPONSE,{time:e})}},{key:"changedView",value:function(){var e=this.renderer.renderer.currentChapter;e.contents=document.querySelector("div#efl-player > iframe").contentWindow.document,e.replaceWithStored("[src]","src",EPUBJS.replace.srcs)}}]),e}();t.EFLPlayer=s},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={INITIALIZE_MODULE:"initializeModule",PRESSED_NAVIGATION_BUTTON:"pressedNavigationButton",LOADED_MODULE:"loadedModule",LOADED_SCREEN:"loadedScreen",FINISHED_SCREEN:"finishedScreen",FINISHED_MODULE:"finishedModule",CAUGHT_EXCEPTION:"caughtException",CHANGED_LANGUAGE:"changedLanguage",CHANGED_HEIGHT:"changedHeight",INITIALIZED_TIMER:"initializedTimer",CHANGED_TIMER_STATE:"changedTimerState",TIMER_TIME_RESPONSE:"timerTimeResponse",INIT_TIMER:"initTimer",START_TIMER:"startTimer",PAUSE_TIMER:"pauseTimer",REQUEST_TIMER_TIME:"requestTimerTime",CHANGED_VIEW:"changedView"};t.MODULE_EVENTS=n;var r={STARTED:"STARTED",PAUSED:"PAUSED",FINISHED:"FINISHED"};t.TIMER_STATES=r}]);
//# sourceMappingURL=efl-player.min.js.map
